#include <iostream>
#include "../../src/e3extensions/secureint.h"

#define LEN 6

using namespace std;

string libgDir = "./libg.so";
string gFunctionName = "libg";

void bubbleSort(SecureInt[], int);
void printArray(SecureInt[], int);
void swap(SecureInt*, SecureInt*);
 
// Driver program to test above functions
int main()
{
	Cryptosystem cs("22368293495193704311864495216470919178654433939595676634106655056064692192520447893611202966863286674730653082045776892299847776004511230839508355926318472542795080285515562789108894264553551660566391212666958377003502465611329607613001271196632099397839747081963611079888689033086918035088462484159015909943649327309730067522551945829294034321409200071478120561439055099916325438256808332093895822917878737461337927120860098513031268548977531615011591500766678182272977600394542160525675871888977318672072424886914229524714828756368083414950511638393895139882374619411951641668372589633054980695456934999727709981481",8,{"153488630442686535630839737773755244547514171796127801781865923799216972567502043291063367757353026064694796463150088638905430073780062902783983841106771298711878491219287584629303444446640383472057002897636840028315598183369423629830678793191490335563902306347211095186654517890437057008241183324219241325979271203660946122333389863543257864742790417837699295286069901336652158990618895648899376453643959883731559930959841978081517492339024625447006540461191163814982756912337503411557264642287773993992119382132795575975161848867344315365187483654259760976716422355553200396473022446496465606133325184597408295537334612516969252443262136090979582070671622168609644202525449992065352921913062519161728179514508563992915773902091027164562832510662938948437564221823334377968948028283239767807183784778944857418655223507922091073242526579006672887196948081817441004028197777720943085258839041807350641142650245780019025013208555926168985377020376847851316207862265783281149126386779705048636255179399722011170938871803253177454421634827224862983894130278035258831137777488517628742660037261435868504848958351262460261499889335597474575773197795367755829950202188476266464564681232194031167949709314496256169320572373425391366631656175","297318077237903831210205669705761878822512197531767731178037692260883705915725794682703944918466038625369110174027480521936303117074204186285338047149971663547303071890390823133522934930499588230031743553686420808310941492181795459239099651973442115876273160396895208005447247292685931074172557466822660450075206886252228369938724934509759848713540735362155907693099652195771194976454126012518037047450333890151525909456443628538353053335061031315000371503244626247030039185871605137711253292452661345985211292411922447863203290368773876944223216897121250542484969659281675163955699723158998383742645256606122978567045556486567340710277007234746501363892616548383933652507552329176687380461846214385384671179348819533086477706371146681072042382983555408784398385049740013019255363351650268254610040209828801566762425186966095557692506779784700491525940400138363164483959237462223574993896885831473111774214526516198885973706868196345830130344836335838368086410461653906944964348315298710650396826462656802531606926355352977643097648328598998757112406068398149741764630859880176865184065757092961229660685477878545327806472034478648370585016777566643242746681942247495297099596991846857563459189004958240044084526114364189815889670871","17891830583510581067533932400021268782265577715752887717407042548717949404937104119639301819490699885555062064470005968067423002532181395197441921677591236635211955132689979881775850564426445203482612511268904203957198668212391877742379355878996446443119252458217643492082508749385243826119806364111576294409000635845944171050376272984852484870494142028351777222628404997271379495811095644910051555630552688554689495355160933575515922183512578929519234964509933837807377396906993245351561400326486225088223184889039908400347626270689404181327254697207252292923280541281652638695845351410959419668420385739957020153670311806946845967659449509249883831412213030187136283629311855298076881746011683571474253497901140900722572200126688474387851068455241535061301357706895692232354878002542338377048110041513946094755847456532522020528621603408691268098935285455347721306405628919562275109703413434995197966016595814673750012733695815507444983564735027891710503265332721655318223039192115739377145827915807607534024136814982623308257906567122772616560201349878646854947441326681447958741057679382008491992812120186402657635878082806232601065651856058806781606634440126427537830864263483682322421911845865119754213018562989693493064935142","230804151841251669975644160133049450815033354621968916400524314405667273908815724479595049479003047806278874443428514516886754918288951930782727130327787466869203141073966378544981492070031447092652947092753948944556952712686979297247910919356708134148596143316696659324285204041220978259282910758094365239802494767990238988977651215884142528160043634288942938555977073306358203705011208672682115068677622333219124343178730306296514112142828068669962169709350462817413597838397586207249207795086640876705394419780442966422881980478422189195128984512359594820273635790490003450705886264359311804030075099462767033163674254178182129559241580424009759539324990760924513556584712604250776919539913498390376992098821070091860453909119183050750177997411899853165109416000174443387375785891632462179597565272806563861192659197576820333915973417568190898049868056305118202727918891272413708186037699392567567340056885685634117884589100872785801493506836758094272546441384307846213140067616628240978535440571957170836287733890542025145564807345272988786048830073962324290009433858661119725923894086094203338503110397720276725372087869206722840911210650604200688021471268504589907693817211469151836592145748724933436635277737374973252380774795","452157345823694406294820826875374324063822485289413562679405076576235187147042236064892498585129538877825816602124013194890752831240789185985921236034664695098189287218271781876298519717717676733757787500832638433005428229268711004987380141680627511141065558737186642689673621763943838750205592733765807709859319210259960096470937061192631819518929572277189321032602444488039043584642444223112666324769368832086010071219786957792440003784310080471323103299338448576629654646429651112756342290854786236848704235252789264085889502680581922704493267342937646964021154997924440848820753382478707582772231457577939942644645484472582605641150401989156636849579276888713900361870264230716917767186635033649320377918911691653325899114038405608734459798795977599856651494103671962799658924330099167705222912161558621518817902664573189970748347930447485170789412858070473810618642735431086510165966836327730529048067937165900611538571366139860980729799317308595913365958913499500399392347797384679336242604219107744758331418805471155798729405629527197682423608763793019906369572482124825774343471555323546057872520088357403381190715573513851213625912897352965293595355626986178885795752590304804561569739893190970564759493115118938145437542050","412224537259360074666322324487224479739720590920938922155661519345562418321388269152817021967625314466676533456684444012848373951932959255610447806959266650358138840209550275887873866698769936506019964309567320663592644235647632963760326385369681073312110153131473135786481348114882257039988648805616125836958139616749862708687993964000248248837171778611233258861933571291789329020715086758807722675947318695626163167481408715516828543310256945870044071150577801269036458346207321275110922510634608976730091752533720366822227122748611288926145971144729022703359368717221570892977551845350342527510165789212308027895258126393916535599560454563136127603157074103611666498332794714087287445287468563420872124010178490720374063994109862755056253533568948946598163735520063100325302186304202140955481893194162797266991409494458246634432821065780161899292797332974254513339913574791470741829222252337915898133588568659220302977915793247692630217600386426623891021245214062761735707466785814007902022124086692541959350002065503792505927101428156001291267565231431468949765697083576142733130137110676721527344462922952146156869739209233167421160759659992333630054976010237060339460181813310741136760508173356492652655957862941086449115908509","365302447481143308124236057982158375614420826863138651472988243665932069337037421462111503287380193656946840735664866572404231378267724504685539155301361888968555234415146022380729717494569662257598044245407848200676412724019213381117292771636388361366611833797275720536672042715249409260148136510116107396313445015782442669755336940275085321731842706998622877872707197236936678318949980689085587484152491006849461458345989390941922045885676721840174147809944222559854110376871098690025316130976020840013094105949173084043273340498686884052859457456597609851451703091900360571574818864005468742761373582452997225694565554334184224645623110070080209527928714260681907529673068842039308005122259065626380341670315481903123061717473847021584790043060490862477715275978554897775542088783592532612050817919354727056202563429392721302689267073675178246030591580562140096362334337397330691384427878153473049098094660606106086211986389855490943938244866530326010791361499625141228018223991959370737590979221305213493346075746229750463002865859493720962762380667922377219909495859269518216455204084052503694840007106293012700195819671977630946275145544550640072347881316992295609734442100444340045711227635147064415541442936841400920513803039","476898407190800410736981718477846639417569956648129285247098682777950765854823438971464823784321615043746914920194395494932962167290793615228618004900238240010900009655195506509604291493031889389645718134326077057391777624302059914324543918357071891502410823895805107836835465936559021493279727099335365072634872267922235626988921600580326080651951401306204398725667550967738461834754634424741146527872581746166239408268803890044441339778502728465244186135192925700469188074073318818790951232821790772302024288527773090406438703166980116106337574347415478204991361736083814086561879763979293734217182219060040593060054471707506292979602151625890712127715880108592409305425447188935214157356978367362426563917747309601266154940043761766322306013167344158719568773446882159885217511990015696390796208223029422133898098054768221644751100443689123681390755918413812305172360556956293312316288105721993699353202257343359723856141228663145808455475450389368325137064238479436394867718491134264725444022568430714376262733740250106680344392527999443734195248447731063239359748141640451249726114924392059822833768955852476480694487790697468298724607297842725525113373013651714984437453046606629289290619201842279206877589224428501954280925083","98599505955743205648992278213218108810744482118937769684405101868089178454580961212323149662228505890435925698633506093873660376032419921983716681627248100549366496358786828644323374753242372371892984620473621355078939348260464016989487812426638805675174998195433821509065737082803066497652450713094241618218674587998755210410699755728782833587796902900924094043848582611373900306607035906994698507435673727762775803805574536801346204662578283717954295003913161674024140637774385532040353179778224638702228283466222380470476071075332422245110751325078185063589994082419470229118503505084170665424913416261935311902071713974944327779446177042480466407877503139889693055073776233655812187039037737666981749004825598007370677698577891969049835084154761849883510253225642088759205300174081788070616210463756492473468708999090209234222695207071147250207170452810509213830353432644541819281420517822268751966103001507897072556198538273028290666107240504856443775282524467990985011865630034522424352783038524342090511978421231054641004909738691091309487694199233668520863103492139707059026884104783247283879923016394061539364474195801165781990125366825375970535296705401409452081764357988102173700495770617996896551833473861422158698870720"}, libgDir, gFunctionName);
	SecureInt a[LEN];

	a[0] = SecureInt("497662787585934696222421382571991083727863915394284909343720357387443226491792763416936019201632109848257449228138644370671329649784164325430025393548666502724980132600817916965748802821186908831297091557591836227929360991007674972276836785680288038290638375560742710094373987616643547974106163000952264350980560134452576991053001126101262610885763660787903175123172407087233051479670490037117490511146078436662864632166550576711278988697586216699210289189363884886423751086806196902455969582082292215762331622462330516683012139596232785553311253236090667925793777387601381124875391762549578511266800376778222701363046037264927347971527518225279215572992106874002928114516641299945868189966718811559121753734921005657624982675972124019184494835997492493463333751820805372176584285655687269226513503555235118827032970318817969015379442002034817020429623948446497020036767911247917641961828627120251080205212265230254821203589459726113044909625456166298863318818329310900415928105043756601141680028491107554617947701405231769743681410421672087922631654980203061510326708056252709831755848337142116166990645299843022986511207845167543829685526998250756093900535845040995680052199822118303595310698400101424915801191665208692705350672952",cs);
	a[1] = SecureInt("315030692577017477928366397471065174083364817718708341028908829095730834391521455506269170864618053522712783943882159166364192755041083209820550859070214522242849272072059531390025118509561447097534413470906231300945421691732638709921638978373429340895855235687411986882169197828531357522416152533653198805794311047771953608766608917006461574803676008236713857648208167087409515407324839441087497313902530202145435512377363826539804780281267133185513561279026533760545911012412461344781069849417500445302947613804197299822246460764126388529406904222694017007095407114652591248638977670415601055957040224642427931107708608339611598612695996184698342082957769930481107104220683593707626770217391228087434680850258808025006901426536576395540590516984522137057237099035425736009698737870707946363330851751800116856793988028127755816165577198198467674890060827380470604784778229506974486060785494953515163532933049135563383210099708342863909533713706466606201919061557708363634371169870102409213650488561219970121632088756734446205986449577671529839721118773875402606981118243759930901109881334818094683703184665250030249748619102063722487404264278561288303499710817263240898231583825469715662071971925042853710710214273624365327374547253",cs);
	a[2] = SecureInt("67297126954412443806236491215953182618650313735669499532394069404416173948955614167645217262194768795619013975747549268655388003001268868106690002172268837782725507107792924358076758050202027091150184923188086565555542236170279201182218906273544308312571905277723488353719104777769163777360647710633312641308392587272508470540600703966868820025356574627308994181498879971893830661384932980225344877517297386247758873647030614034178785505140417365358952948468309202496865862705853057538948551531030482125749807499700231556603242406981910918035901435098178942393301026656037141099340824191064724605751883515043557686935390848974359349798925484047672546902371923881813375200959855095594741182845403599580402638143145258375773857564793286967192602705858629955096124510898246118937537875124096444358376018925318144882858887689259767928081633459873010163817172169329036916953908304060976887257407654246352837236905413046803413715589155491127996285887754714076194813025151855247662326440737305743987339799669112703208020905018858776662693690176041659899510822250361533073213612013298329349976090954144867791899239909198310489259812982402852613376220572194192979087520163704939369038648288121371086012449485477099946074159301325866793852209",cs);
	a[3] = SecureInt("165705180927861482794927755564081776919423054795965949714338168102702363624860436424411950907924239474442447057197421177804615737489400962459251309788590717993901648032617648032648357321990362490437859723291123226708655150510760410857951500524765388039817070134698181121563397663996602825281273554888745909747176246606291372342639836839989038031913690450021613893016554795774039264119308192839848257666465789775332398816955993919964520460090181352778001939999447405052397383891165113987577843170183520147552487084197107246536134308654132469925238683642864616883012768274585725610082972351504480394566851436070487545324696980810258968611617918037060170810064366867041836076134212617801227465386356027869044229122040489047555408171326027488525413003506361239871543047785825836787287200610608456411312788237952138942948969103202795285217399778694593624585468723290744311562812635463925445497010737614966773153831858433859218082788402511834588664732942849049832368510277994101639883546147801013588358680848200904639320407608336332515524519749678320602742729868319886886000384535379896863065110205009031684991980718643407478920111420025757181716047894414230624929782444597002792743180527769931880384124704755021612768227254475155095545606",cs);
	a[4] = SecureInt("371253532661880568637178708865669024912609401337189072204047644760990876782045022316827392503976025053439253836972340176940161078682652709838291144280913878990688924890499286081831519228139351842314312830983630685432703115076983879446619526210569422698757748400974207733942171575966142451416210894221713216715614028574132454810826209832360977845178825827715902482496135034458590652047005420374657379970196156610681863507379452753739187743439537658083514196432333002547583497816532152323893825173079516872485048784088698931930993454247865082392229442355321418669683197646102710980782868435791985939198341272048464434173288035360533123082846262120935237099922212651957561358647252794794129872091717793506210609616772704797784441010944108394054266123314206421966042480530924151981889310651018402855362780419712755915957207952117258945660036661106498166583534166549143377560741388511077678731251106462391076516699131269280181424104343846302044267507211429977524343032070713721955839384230976835669272249424091766656790992251819199459833839500212986817063102468758650941423690666274304958805628760454293211220500560126230732729874541870766563838379502210629192790990204513904864046797283248463393158973821282973000055078473444393284020856",cs);
	a[5] = SecureInt("206612450303087260298211115333495239566833292641609554051616836803055709575379208771843400689301350203673107658894933106586195156160484200708236560858715279514762133602821626907013372115487696060155045149249859612299605185656187137670910893281046361717683778086285169342440079927665422829297089697152099938791410210065388048741631789434446466106427683745343662611907830540041296909580623088546056099509394398700621713064135401780163513827581917124889798378262765407477147401315680720711871020815866901932781489369817402113954262597997666598265605487700677414423663084906263618507809010108486391864725218004606234598844718124806971126697347137625853999557528794626571403262583479671465885751324777641899613006695447073655879420321242847052547444634574616824453618731120387721945868022475368184777008095877775815887294576286352684776337638110924025514495294480668713102351888793623837123387350259407475250519401214597536809376295165817559128614872628531313814299181855544129014833574012912756459567010684917201481816557431283727158355854438853611269533520385191140545691298865955317295327988432062608197700161371892125869776533962663599363818146202331839637111680451893741460013888019236446457355087553846601993745344820320126529607352",cs);

	bubbleSort(a, LEN);

	cout << "Sorted array is:  ";
	printArray(a, LEN);

	return 0;
}

// A function to implement bubble sort
void bubbleSort(SecureInt arr[], int n)
{
	int i, j;
	SecureInt cond1, cond2, smaller, greater;

	for (i = 0; i < n-1; i++)
	{
		// Last i elements are already in place   
		for (j = 0; j < n-i-1; j++)
		{
			cond1 = arr[j] <= arr[j+1];
			cond2 = arr[j+1] < arr[j];
			smaller = cond1 * arr[j] + cond2 * arr[j+1];
			greater = arr[j+1] + arr[j] - smaller;
			arr[j] = smaller;
			arr[j+1] = greater;
		}
	}
}


/* Function to print an array */
void printArray(SecureInt arr[], int size)
{
	for (int i=0; i < size; i++) cout << arr[i].str() << " ";
	cout << "\n";
}


void swap(SecureInt *xp, SecureInt *yp)
{
	SecureInt temp = *xp;
	*xp = *yp;
	*yp = temp;
}

