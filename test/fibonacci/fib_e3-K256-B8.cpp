#include <iostream>
#include "../../src/e3extensions/secureint.h"

using namespace std;

string libgDir = "./libg.so";
string gFunctionName = "libg";

#define MAX_NUM 50
//#define NUM 12

int main()
{
	Cryptosystem cs("66829184314901521643049864842403501495914987783820255205533175886111062489313",8,"3121470974733993432303291189504906887501709591305460165076586954375498141828132208334500797213255638386999964155616485426240380784237704235424555913091577",{"4431986463076961125319587223141470235951293848063148337063289149299161837617230301850718724167772478737575829077690288216451109307900772032858070912303156","382077008269883274257383024818322703688632361527211109725912967779830383974758211625180832049543295075772488519685753490368129620022006574247465470967061","3437983953836792443449895940385548983332214972506408744972123948201993876121244799046524937147608984081050768162620004131942894274102828323268492443517740","1735340547692187289099330242696854569004400584490857410697252494791267710510170918916416442096754643350674908775409825675800356753457055188895891514839068","1014852478872377809435334950310797222755163297305272216843702030728940234577265034040836067329386544517131807690729093679347953079386546828015024376486960","94017634288735159722556396170523595820573495985612139992693644101526723016717628827843528007161291877926119737829153448042411618830201061161199803782153","1259365948435167597128182426738657792235937615720622930177337045396611124247384388299012720282446552022097625807600441611091220552284346168679882683308365","1718862633823016843199331735470700795628966802888953297155264162749792339348227265988985693979212490320194185868950986402725160009274668342694725647553983","935474068304323206672335442990943167145666248857732640382442109338115423599742001383582617133986664240876119277394192515527310274360771102577286603943621"},"3417963586005740277326878473694294132922402248431962790621829445699831787401091108239779807036839804579332838717259778677519884801842907285395355849185217","848074867086379129710782354696536790527011101822993811836374231564875305955105024898836575528076449070160846967291461020191813911740672807066236018468716", libgDir, gFunctionName);

	SecureInt num("1427909810376280019531224628186336629579613513580349284257496961744598983075287795397051329955688689757758413742639730128463171423297888718574885514812360",cs);
	SecureInt f1("2564523993326209013526928908565268627746333513756794425470218968097474440777584185144626138783493146452928919703670412010359994744953420323682883028662402",cs);
	SecureInt f2("495166810882224641851948840553041365560925129942455250145780139255554582830103976544269964491893333838598069778163948205756086520444991881223081262854239",cs);
	SecureInt fi("3362328370905183529720429242295765299709241617586451022876992535732306438476995801337529027789100921892401839762246516003265499669080335187465582589897960",cs);
	SecureInt i("2083090591427326738402066018028089129153283961039883021500098276448353289758839060799873350949736605700175460892060511398316732433048890821840216739676990",cs);
	SecureInt result("4350894541459784149795754084810886624568925939408308400562050568495638431357453313552112519552240849196679673000758600794106572307087015270599805538213087",cs);

	int counter = 1;
	do {
		result += (i == num) * fi;
		fi = f1 + f2;
		f1 = f2;
		f2 = fi;
		++i;
	} while (++counter != MAX_NUM);	
	cout << "fib( " << num.str() << " ) = " << result.str() << "\n";

	return 0;
}

