#include <iostream>
#include "../../src/e3extensions/secureint.h"

using namespace std;

string libgDir = "./libg.so";
string gFunctionName = "libg";

#define MAX_NUM 10
//#define NUM 7

int main()
{
	Cryptosystem cs("24157234432891367495059170491379034357483789825998822593558212325728920037675804404328222624829193764728988422820804847643849955056968048814261243702322853823247252461460539282059580235000519263337968242498251018511562604924053339950869870547307413454501384832099109898929271632322573442960714652257204689108611101536650101502842004040423139459053977700594477178912283483828656066441083256937850283894948454332094941784725226866227033723201192193618810711135914220577184807197704124102348772574864499249011718550617124043434027787610840585984049420068809675593115710159877924952570220079216676511200867791348245697533",8,"122307124140273378580681394151601408185125827426517674698291521572185127970056242605217132801740284555716858141776157261679562503081937862668234681263096597610545565813606323549779338146791531194091179249609469933125205606770122661662373396519596507616125455335299079195958641360364851944159252847284547763237997035084288516606669179082369086354607486659956340795184476952490335581554325918688316967365195970784644681244467203688727823714516035652853547672308968174757295405480547050044497024416094900107272771746352131276212619802210004434832114517104136504905849298305323882541774467548352708149561215380519546967219860554760423431416114115700061665823656881615642054810298711234732498433861419711318592736101203283131659145071392513607907157639228172097677089416989516037290985913576267810431677214445128053225363673204750981622180237627057207850621124267226350726285626133771231694834363524409219811576523157522728631420048681925624017829781168010493712620379559777889334435602198891155235337386880188517160546250050992315645539568641429387104255526749464506932050180652838250822806038193886212201683010192187270746237673415859653683547337253963838854017933990198450271677184539929522667159877492338216851076804599196771198877904",{"159801764212280223746246648585922649371392193754382108933376216733454552498780079382741268333792612685350889036360311339122628401893033632240402364661650871146677116871171825413925177912529271752227553643762838440106678823156708083316261548125679678816529920475754127870851572420446328241816303075736898194442679301843295601185785258752676302674178813845497954697411934950007852531834527920941531073851980290996522789514428153555606421826571432510395325766536298420067275612765727380930373192231011700934252920494618514919847746276800980649415762578645324789390100504364529900967592422758278506808469793170780779323351558141796364542655545893353011469250663322131324648016626842671568968995192722946033644273578356203462328676598316951397419644709254730917395388640456970888412558123801888501414659551700119911010173327613313933983806109459724122776474980947360861722920481429765806666199041778384510531305030394282725275016249167100323590037073878552540824725780254820501239479063445771403838682773390591613349585172938936901159334870975478951779041850307912047273829145106537455303917841427110122447816600296939803949386412741668442170228651721029223450893437884682155262046527086316349016879325782370721883649025342208655661211179","557085797363726537546036750211888242650928739157559787641338855393358554269260478141207386921720539117675467616322567701291963331307766249463891929221564778105806446943604583071869252515903972861876716848182374674669577084088290192150942077860454105438997802619392939000848134524271861430232656138393981912866536697811692758159160465014127244457314300966034033887830290990733949494460625827714392670771567781974527593566083792974906906850723756751682742820236612413615224421919650865914460234725810692871985106902061230688182317347379046563618961179546490035837578129126089979171082716808297517232504722392730076443190218747975746196195334480365184499188340004982900203003941664870877773575759864167642492302215013668984086314044507679505905047360399567995478415539207352952352158059472998286445423732156072585813821061407448084879410514769026133280318377101121209675119972210026778048014533059154489839596201422748334254154157013630088404822308004938735088988760156700832166421794867494030963324670028203134807266193194605072141021485624194697132657349013380632723101245369151992774872522823443803717705853585894701599642602326872784373388921766525832919096663432624062339600891426964360434444774808625376916010925954340752940920444","203109430276050785965181157631455132407437758159531873144982171169921978975120193607376275816592024493646037334559929739770868527505058601834412466107768644163194596153444757931470262294356775260246211541951528228966655716467586110699488042269398037981906862230812153063961128863634915933763901079014076828776717942600435251038522803808577098556754445985222583639306181970362079086649514465677674518087957407564592258343688989698522188383106544294779421718172561311057960326632191769249683827236411962652852130848486371241610104141794531340198313067317320558096643197647059711955830796113883426939071102546754797857454351718148165716758548469736700403483010714430331587978553943477154290429709377688483242023986837204514394487097671626431622292733026775707394991086689018936501736846744431191051503050843566997934717899419426978366179235423840276615887166440378899443000027135418909694285819166221460591107129052427741654227373240317196486257646953178603101628823133169362663206391230344406053854349162466986954653476799163649601791849058057873803547392634135195706780333759637164474279489173349046401022461617050257714259814020230087330307606573662953894111329193240811695277569858286210112763654349615321627242339008844236552680917","24950875487589960918561399187045620202041411979555464939396675025940821135374399244083369531869088238445633945428690034269714740418956043600896630908152564281658645089882821479187793045864644017790507480169007361615977267895307456640747559078856165642584177970323795899979367394426096477621482607186846964552882643554669028404882885108438689204212621479022994860175815935604601899245989373505977057673375553910752848385986948365990600781652492815082654860983662510975210133995374076696782181297366723422270727568624282326607486092565876458480260633548531112609558579250840131934884309890936473022704662024076907711847872101725714755327638716158734719140408539122734846297634334070677066655482431215100551111312229551843561308838104563641298181148678572836623525170163152383558049159240978912400970649095012508909480768015935190426975421909228991785244722617144221875430562770416579627015263971400783941833438922214494560093369941722310832003409698948911823811307158501818110456709399795236793700169068840590915837570002093356680463528571698249392920571295183701946404506455157227349976986106782818903473603899342911924631049829634674798046004356693839892022622811452364078619998794372068218232618046785254531432995723470768745049042","12882489314006142037203375168750097703942978093714853373485353853513533481102335683951595513519292133498463663445200122435594729161061258557596622095989185017361978789079128805994721412881638159189989652502137427669549710738711382431625003980345975405176104718300724226432977733485756487066190669830866272148988619702267562647566706988833997206213047782588997047861678167862534692573940450846258584399054046046354153083746380299854884374227218711578932702541173986556819619425245522772232565195383681424465360035680711217833892408021913932452028480378727806738839275113482325844826017814444489321908276259157846940168574951428511665693829221758201007683371574077970622374778940151333522472907413040263496215584648464596581371214728209997214057465820392794727759935622197612414954829345937561507764817078526660008109542431776023868081594747973279125080974345943390847320988509190038588716990105426566018947723164835249995685232876167374547791123133159602720175136139678634022306014844175868663187932793013821939798556426205633032461691210403454594770639428751065938328399017571521213810276402482673897251845519026268116620988440499765674118138644228836868899545299011882498138677527563604952357156063049173033197316446330171211325781","78475080124794311904262185503799042656798948765606291689511355530081265268685911513269221365481270157533873156235024890702682815009045740972901808856545132121649580940896854849604038744603056543607998223688970857830015537282405911162644676475698220832300081476649741181541715547069728156511762178653598433823707404464057596931989535151585592121014111253263274318649989012759102073814365066461355077642653003220381018554831176836877573081587029961038620831874505947619707761318504045106151302233638586881947006406744684462036580648435270690536853255940750206780411406145459673200464593436826822073279400130170814916173102824057909010406937081373081090213515946474160383423466107886917193015313552899394608723634498937914638234277101097802618970776438559726515322001291469011387108407884119262301441947562870870665258634588817600609201394861429316779315326830774416551649715703911873862136293751779938629672496704401737530195607322228752566844264335881492085263742272804103753601825033767799362365589603865858461564542839019539354718749525701452070955095539626225559944006140333060198044499789964050040714624117820354295821038895584177012556048665512251689535317238036129969451992812020054705496062192341945551723814867616035266852372","231914295965515993147707226941789094884976337032624354580765645668517855043778578826726031904222274160237719029619861505876585004407997838526542394227742753237407907609523661405981283913491282240799311610690172314713816451357029498852228301043366669986986900469683236059732077441472028554299698811424140621099932595919982503020566063270391560891056227068351405799915211632837609265838061369726914479224486424695609604637710253946328982893374982393853916093645244326687037311250145096370398859705387612550983708509147755410789470267588901667038094226659568917598160332057735644068650701515384368239094433797436614366123551290748520807515232085097041382489112369698194936961927201761349930584242143795676929602494902334946694186681023777817534759254384204300787844371033507329358259204955658071125085881382394578045840060164619139017352487786005924106544565958460254820996111190091916564238237463633407551749345327415983442804155252973295529572262054349352450008814245294706763249018993049549994392825739506871677164005903205008165424751218168711322206412466600570962093688697571872220586471579726077008355308639718259791049099102237843715700726437879792929666594755332616309011223780540327735473037471275736900434026911723330570928494","299365122376961752461426852342633744869211347191098997624191550876598026437039382460170175760854825880157526011171979467013540299280058931405485125653288743153281146253616762748058686768011201849834105865476713347080936401611848969126356152957099307130508914897203696673071754994426873041238916063519648100767360397614809397288070919246876752402826202087327158209755208016519013889680622181452170058224174410306379755536480750044873097979543103510907825502261018128008176397851959559323280250961494057375166358092941168866385317000685056571219727634067118700170863118907774216254203357672569730967488552949855860879428353218283381043378703323229254122000871149131285618763527866112924311492223781559335444179408502366409089655988752259253353023493504218629936642545967777283678020070272290205217451523590647750504019435398034104188137577446655833717644349045213847492617419598974646153016563083777474790439761143502878967802034543245173811013944289061752935445742769602393191421864692971453806321222241026697454557614509716722214711542846322810083060733519248151015447442408130480433820680532644110727904960076256524150369760563651518362964797483334577870497572776209142597586283000438880879038923048372347966047425548856483243183599","464448152298997819753646944521403756233136919951622586935305994905112900642951925144689606494302617478855166292663192930083540463924725020074911872149549591718962821066458891691458410504158169175140935206580350365330007665325994443738354047036022497263825162369292945239782991421585822218889195521968760122296048459001676031690762679808501361469209013138639300217539719167877165756073715234167196067210834069236142872943654094706125103039592342386538335533714879258778034247983828350538115382299929704555714755820945630698184925012997998109766046487726760382005298461898969568720067694680626881301054273009613005606786901553221792293926882461361671747624968369300355875654789946422479516440851695406668326762682548944573164195043126726166505422492632901382121946290445387903665715101551169360902134546485319119878718309390926567673188317935159935386144129125702713644626711699583497448046481040622880170215143905138891475936063434393373029146327047883426880538214098997388808756823736302791622262708534599017274228309778763314831932293130216134739214514890473596878830968354881239402589594904590301539925484063547745741795892509646179202169034476965941631515853679504146108448379950541533326495263309344542591057423744914621461945860"},"206135806475045063379361117570613011973439163117974420151070316660133491045160688647094689605328973438253612792127555932288367397563571394755550860272917395788373021751918820957935698973922754966601136413722493732567091261890711184328655275316495629764440874099774614764210294220715334390842414145950910342471970761933569169341622908297058618284938811806941312012113576292520746668326962935432030285650719322516214362763600849121505456106054479453343104356354833637529700715496337429454313954859170262117805494884154387699278632153887806359385272465781539399212642027269096134610116173213175854716843335881119048352967687270221344022163663092909346696557727773358056762118358509808121330355926858430650132426964525703162455596044214013001910093380604109705019536292027985121205994596880691716827517921198353666402392015615135841833120228693356888234736229026843924117937679863555219838546758776987770513923457292031283239093286617846460735494195364518896249946092613248426359272857563533205234885340829919710961558203166222724475203062260465411001788482589613958210674945660210983548021722265873321791906364824997748803082177847444626303732306252240614227401711486041579791283320371930147782607266670304309828442170920061685185441479","496194230914072278213447755287010736257708193045719983292073307013956489677792304071417043738276520413352425248088326587935516550973720725692611271498925864932183629582984111884004621832325189631279452301345528530812078219671908109537953877213528247473544591698974234403188858529574995528648568364263482087328194843390112281542684763496903624148728099336763159099374230300500980715978173904145719832835152331358387685310652106939293253909055516948955722078284956682877724498213132951905694995393699654898183632029358290979590147962196135963653886584435333892226930103576317081853117253277298875706254279918814552818168583710771371626265959746688052698088789641310105232841763904224984012666290047144914488125304721407725710386600808128048549678721248932159006542992620121048826927289979919937091768133469444044660082966909990336364843364664698374958792223037614571716598451865172198626844938774108933768706229727432134200277113136418641964721236685589359644347383051879246018905647524566803865881994185665202324384086087346452479261244622297913563407393689255327886513833749461061216910726862497786423783545135541617782664747191865521028718576192540184080703745426576546796277927150626174985056887388887479575704040179308134268285429", libgDir, gFunctionName);

	SecureInt num("493959574342352475584498962583810228297368044173567114496115685596978723983508438527913932070596043339012942007194558413204323350807399723253216812340017298746717894331855602793694354713824488261906949783752766189794542182398238853254103477085722723373428616202759500433016389581454366441635227805564902516563315361024935976395880008313132203826553062034592902171906602686516937661656988894241597239308217635876849339269394168669155076640263130458679886960878966397457988328234891921489124509053661814430551590978054969302002502032365413299262185727897453722272363912842834716222700018589484295452377358941271083414872627035109612799017145970189361239468532339620484853309836942359454995452562924986654123319771730993479807957747401470465418132472109071137186305634186142614887652988601166151702548122512559353359819087985386562030101727644949197739441767754878740720239753750097865326139465053515342818358453809504726960944759102501510946807408362027886002553916281725926823898909712349692232466675574631570306410319431947348035909824477469806639252069038748191212331350748579446157217184133418688118458032834805543280802859632283986071401786642958427889613155552431854037393948056432034051865365859550598974457903218138746401836157",cs);
	SecureInt f1("331566892532892290787780958999682167298421734832690144729286440687960479898699135701060355285886418247006752592478371772601722562870931888654026491709028860594000780435520462458053795430888495699141706471819948917804966207455597070322329352634890552880975717901886468974976374594499564566809472940060975810338900447764552298199072932629681107234912049095164632323152817737101055542958969173397045770382347101367064975031435680286190146314250215379749828369627901788886018991493276509685596058659726483853010863917103995676495258900666987628468806395481491463880237496026032293037732030001889662131094505910598397492713081966663133686870157275565621647971851146937894331645462654932158624424655659074041158562599918758134543817349959276014112700825493466652364425086909406880668751816828866338592929369214451190002382152079741286936242066848820648285163689977970308309336531347002269558786971368926915923924784822129520654036213908605830446157216597632987000583179382418873677033950537473027355504424140556850395527259376532703470264187989229160426505159765634505379575389311499720542845349696658773249698631991247060611133327636717659962746114089654476207076740088687404139192912061086518008342402875231961605533309307341903642655852",cs);
	SecureInt f2("511571318190658759204159752291529268733603919915190204370948136286842598301943910512650575524905956165254666485499357551407231401660548606582645215440545965375366359579669771062738575611477661875519910754130358441646626508783692488302774130691844743726583936308376876366748886462264890237085397382272139526801326441711283687131452410034021744682120120171088309648253634960824610976314172725939339810027232994194717153470135877989663093149776243935508895274952449142666308506616646081854549282661174816541412544850879876142799875556820392982712445158464835562419743808946977356605307663383287826556272820973754495279171848185341539880326524783436180183662258659848140736615747473168022210562667017199119183903361136720334922087464033979136387384292534672523776592174841698020876478685091995059582713428670094978577953624933900103968596845193032289285388152387944800709313977457827299149414467423134292167778556459575007464981289009153615987536691550812962780562217853769718704356161024997707131634179621250215505116100739390979288282214358470774197119960711558308474233671087050338471922115103687628288544761030273317913948568344236991168373741823280737963323675780401941300225682236321021704742016283966972512565245345463013239027738",cs);
	SecureInt fi("307328368147969081272756672329114304223461177431043838598988329240590173024782442538378607391519597946223368503861483256345005875955327883536961736215254458126404620913748037730327354530964089158589396931604896482199115188654922686874127196610035972165969131592155779720358884181705124208607742799766244734201786400343784331872145307686156586251335241307679101194444700025955251342581227270011856628497552819906072145322961875432791602640151548063961307961445218490446929953361620173647965680952203730477232304947221765964958503531016050223653040957146073394993102435171057623295103277152330606829507382076952717390470434440522484988633841586410582255729382673438775303976217721471812664525707817965958070440504141241811720373210008873316117865581329668729444413070052524484021053328999139398800700771269460582935300969953398738347094933067600858750955574159412085175468806552924827626251595999772177907181872198221126619402609539465027760623486556446649145146300634124603428427062169398497945909424347565395945670822101356666884229227068081345031586906904110639732452900041416389027554202260126951335905347419700944492999238942269315150808690680559835067505818426811881441687283808632149351028880939480993461794924241206724630852168",cs);
	SecureInt i("396479646363611302785217851421597567252828292057370146530523636691848411182265672871505445717654060656634036080831586886887612421690469220559687280386086185874339291102185352854272237421774990931168898186637396520682702766729868138488063641791756064890440646479020526830160131881379489548090617651137510475636292390851347668399969203273474999573961057736669627132088069832176912927751304794255467113333556805889591759844895605388973192411307987496020011538368955556364268257113028144367848107852660166041990217818493395875576508850329282152701573712621543503671528664168034198794006416237171151260462871537616161415824635633422429126092185486884261048673525314744920070295444861480302194562348722259354211505640345827915937115686568206445258555728068872763938364280868969475579338772403919354452032379716333810133691150780139593228280839376441424299495100734689045955888271719704710363436521773409663445484486934430715700338872125142021185560619648626146162921599897363398411782241989560344731024941351928776783990090516585095333719236982762565513060628782461866671136047040091097666634085909219209777181647927002034507908444789479478166532457082955328249129130769630813527212146533050474068673364881286849946702574300617538128524495",cs);
	SecureInt result("407223736482689827226525286641477315039625310417273634792444751068576272522173838444675321393707092770055053027725134625216936439840180524725221686564638481670481745378100603334596287547626115180584470567907381343371121047823073863691007847983690928104780632142784312038569918021898780243641701031815690279421441537369102082957763978465320738207077000854302944440299542121053081809332194814837765712162601909754111806350632073269179811598706167368879670265627426397612830859831042491224450434140488637497342421321190629428721670191713453644073735063938222424544909577450944958233107357658651484629999773860385278751142407404772729571430990935566435897212606574661554735460151168975009683153842309675243144136168178869909896705437329213183843411710989793446948937040330073881106092368415215534681753291431991872574165601600711995136139160382573529778986974371996622804342359097126962527031844228079555691593840650131580505673893484863303367599769810070886997693451971053702150583448872468914081916558170751384210277220596436890497182254928383858115958812703352583869955555607658266188425145233369299116260042294877594371138697629060033995228763267014944578421668847617860339129731205305287997538948890490428191091199463841224619816839",cs);

	int counter = 1;
	do {
		result += (i == num) * fi;
		fi = f1 + f2;
		f1 = f2;
		f2 = fi;
		++i;
	} while (++counter != MAX_NUM);	
	cout << "fib( " << num.str() << " ) = " << result.str() << "\n";

	return 0;
}

