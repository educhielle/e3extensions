#include <iostream>
#include "../../src/e3extensions/secureint.h"

using namespace std;

string libgDir = "./libg.so";
string gFunctionName = "libg";

#define MAX_NUM 10
//#define NUM 7

int main()
{
	Cryptosystem cs("84229469840621403454702509814547482691101399076186327082930639356679168425421374008777487265060685488675264900949776752071576237443844916641561598627392474282689202533230387966252420966847414250013062387570535896006139522775926129533495976361916079583128668699718038122048320149656069837930772360800249270809",16,"4583245006256853679740760501613395826163938144465885746985379631609984952715640975083347659183612915887341344338917727566188908589909504116858557770657167726332811085276963637136382274926461583865538219996779905813487388448362675154071631739815051657141032934346043017305792547084869335674035729516453703378654169796587857324977029411606171007452933073485291697333594231348943237208335224328263324844608229800540503767229857777942719682569535517606087058883715072484317920031899617739096410011717210868994320415715976063744238735708845449644111297607174773717616265339588193100074726598993704730431541035283842451908",{"1665642541737800013362870019024458119547756217773316903198045304353468210495132400418818253735250281600615374175252409892370737587321717963927080602431089357491395537276311833604809724134481479476194463959802293770277732171090562338121629984165850765694484131908859544318134083332313757617767989619163525591131497423321202284999656170260753489313026254199488723760565510766981740391323788457812803590999475968899451804312184244489924313609848788724379584273358406846160659666113480770550945458233102808535997481625321428182031696484796326343785388080185549653861978074302136592004319862340815555868318554760589322272","2345232360145516562517677689355321655609542235705034155246349321238884185691449402561005412013192858999423364962011784911739317249423741258220983560820733499359520561418154663667435918681842200500856796049294431551320575448176935632489161249038259488985089524550827108437639491204275309155567616439053895648702886675101832737503927128683610889532977746094189547731781309911644381549308050970111043767868276301177546559335543315915610968622640340797614737425307540549116137414619143367344740249203642325620669883434542487748744700818077518588990083642747524453654855718007245842446222712148322841071330237538472364897","4324374227001337596289125326481025951491748591248157834628894505929862107598249575364387631517826154942144408265180286715554392979692112453770222882455359833602627953043348309019774243838224230951547972946480943518586925111078492181387936536297641161732021273808453830427135234812539258017742876147316573041992864909902179755638917750620049986904626473560622561646693436244729526774082424083194012155864138339762099800512300064569662266367618544849307165383130354798959132074343070355149616634372093560816833667467321212511379686351875912372340850003732884698691712721843125598186261792385873276936882169377625079488","896882161223356963643206911863100078307995612731149392809056746301175801804502885312916233788001628594883447158842251819124851259741506411030361690907187892569687797717674287048043256077621222132897090865857950416157201745355303450331394062062594207871532563591694733771743953793955393919072110472833647390354984474588238529984243242092737714450980584267221563890841705586851493813377099183288380386014269926758720544467130041662615929759158810761589454432660515943104785436839378232540313431709842900227409759917314696231030082142319847510552475755790711650537863432708424231919382759511966717618421168732630081008","4079817305785414421908391925460240390805232730122039375857322651474091699577737098652044926476500654645915464143381025289303409110433777591286353264265241346954115872719673735102985337067340855865565694767186793881215828690673424464338161903447603690797440513638651374341928871678940336185571765096340913915143956595023825511716176710870903658968856573366977743444224370650579048687478495938673742587708433633880302815797123305320674976093066290219648086608408448721266904652807705615847483174915454119613880627736560063677302603880134381569982187216230320490426666851993442270774689781164262887288655946228269228446","3305959959038255051791420070467134986623144699806215343012618993958756773057823726234818560378698864848457790775550110985403088621970321092146212760361037815522562106835584040990226159214103745839559701080458475589686560774492271582150310919356559076092174218575850838133743591637807547045453195489801611200519623244647617279389389404920685308079960195194097374259060787968763246103060607992619979756962695168582787828644666438069865895593089434481323717318357246639896229371611766237260203217960546565089989222082060548816503567942130707488569937596182884331834142797951605788621341983834797093885403962754978023552","5263723014545981847059371339437632307138666413346587812824731875294872185725499793674028900771286752612280271427467916340568783851451209264921736740898146751494816796132182098369642865139626763541198743632931477477192056690948013165697453885223081449970079038905856119699842442385081121255634856530347885744329268636920514175979735185991809679615366026354121580648727981917895409759783663507642025246332605339219835725546185490537606076655494311535298754320429043819252786611489765973969173957896487949242555116348508795186373350576077063821663073154220970731029682906501221249373900891700594504269124584037069239911","733146292688396917118783020283158024319623086952750629369412082614055746872787155546796455362884186775199655965458479003788304709428176788926811364667943494762087584206651444621250128426196907196395016042102475563964160857612551594576412983728578423773259900330762862245264146856578148064452958683841661939257320401226522096010742335043557151405499220157498462579858786250666203382767534059096359661013338755044262696370607729859774094900518869046539332941713375091812440820724776845404170024598094398767441085323924343071663537089017099701762711373029821559904045200846807023070399091347001827542831026067983679074","237078564701142929319241113094160244536557713815218251111016546917114485478844198474394891181592740878175021097883127617226632385194676860297893699449204125014135350337773219269058588132351079910700252933966430840541634022017999290768343438369142181366540525728375995284864470562914943304531244351587048364479156991264621583529425858577837578703192500141982176473628509729189891521837104182751956514130021345375727803420352806949629675913974408741846284586793472990975489898389803130949102562410142824584609145911982372510323291479372159435437353158952013095698644115897315404703346228772573716461172628127777733015","6865254785968341993721532491671029288664795657793508571223906369384202746364090936340140353904966566187612925054881978378175741025929545035439953644708901775467425056420373798869023687748035300627463437880166959263985218342053113302788104749769791080729180631702693615540626297224220612800265777718258901333164043013612329227470137274359313089809292516739932805923313324103405645344265005231365888071497972837948382045356509665413931355589690273055291521048366845003538938513314342257387756117924186234600412044256998632769064595502461841302909492252140852249941730326140173594308053603784057692019486176145053115989","2627560974024559342434142586304956878420637515766980736630717809109643731767183622499487628770123845286748033194344237535890558224239241941078576420404912619984793501301501384966029881843704454761653767505433405195001825712292663534028623789017204700685603430156182892621696598205536397203767131255673263644064880163153171099104713485973015775230816153192358010456300252824803489094435623193865472966858993140294647486394205073172592981880406168570191337682144057140719917543408450763550830960080510163984411752888278198126177175055313276631182349240428008547683883909439396357451584271654994975520947977547111404912","4651772627148724529426598717327624176504803537185812336563517106879932953505247089641788663216527330538859949499682218504733878742541890252096078418768897222923470565174701951947081412312931115311697167913982031006664406928214675496694783267690739754603873343201827853058207949173994563943795403474777528322413153984671310474812962411373215880990277766913414455624025353173425050571248778669409600264635156297319042909122395120852742354063829458360514369997072729756377883415466048431089268598838694942937210817033541918591932292758507056612168246369799221193742566745658193064005221330346697198071691401134117850025","1052955600743995442483329484016927262262410843749881728008287461988225223377818807096252783738744101097694625790613399753613826246161890390939837736984974370846731050140129936719245226307092605725003047770828805621608383073248167558799332302418205138258601604086994182987560315201944211420186624946781353747659353425860842504914470618051865782688240202346980974213239888323048093886011502525858573589553815877231041029769873096119261522005360984875561435775410941351407227273656360360672935131194651140937247775511567135192168527713439501199496757268325710330782482881446397228241153981752796585081190557796098396516","2532633122003132786487998184588791084295500715906357215769946096745776246134474236351802963442451501898979301961890515889551330940930813897076511612529996672540302431022734207303983754390554822412242981675537641756444757196998171019446859415682185190431811030996085487598683105470267845090594409792758547994970627857076031190032100135093278500714744065779919382688104637319089657473035617671423112828068200083420596583198284472072059961123868569356436801955523442943767868415520722078698117394946246685250218448200852505598533389530524423067840616276963361088938811962027388665119869678306759658461612903310840519888","3488077157743705672434198979992519991259941383357772415843916238877610269543896827235550692719055254363613476332169018700316130746130793494153961890475384762461826219545324952906167193248327722378489245557917480406852778412856797343138623700339212792799704161697356612795195148745298896839010342942064014229329807209928045188622864246262868642215737471879446220692269486222131220080733633967809691997785823216080794036383556163956599466001637277557380979258704166732002211896390413482894015318799360452717298653721086529486292958218532924387846846820757244848188267124619814386544467391203845136286574304757592678210","752897366903177050002107194919124554863017007616701000344930952244155316466834189039306587264368821936211012511495750540387327281833644895665363836887691972843177814557931566107291221315430370388578132081656697219078733760574087366220392694361238454593719470230968632953874583743126614502527817689581591767664830995617551033060661218413453182946428309952985409863151724838185296246979141070220720044217557520703003409234515720098033624375699438403527852816486620671262853814023372400874060191898160070069519265857583304325680466287441570038211265959911190720001719157547886976783533110168763968975820412951982546901","5905966062501304174054623149696579965201033183876744777219708188180737013909844254015072698993767632061997256709178169225447670120974129054570073077386109363718242100517230633111114272117439320780424095962382076458599448915961243914967119660586083380147118380175686864134349722439318537691847008900762038645974006659563838628833615840738428256034315159585634467441964044963984995948202846644970944690595040728255781996984618236511669354282510131529139738243651932040144924177814413834192709164102984992761828904350618460681493624936789025413691659488316490617517878240534869247302096583276759559267626935638206441598"},"632372134265690738129210656559698204790738412902044159247254652664918656724913438181233855540390960921296001268593014451131146932196482403050225618215717695124271257210402807558304267325461246083391392717103161557077848897779583375778663434025898042815941857728595249667486625062615703032447764006192238980409048536446414181015242889851249827291081235628552187608957238641534288240634630981840714454862667875406094954493443893781449155384344732383444259716549717903906558199167075593434182194451947298972868133391975139677364684640901865338050190975131353110656015766638715726121558573474357704685891453724658999304","6303974157102233614363449076222372239174653409915926855412808614660432751435927470767074895023208100922366179919271872245791107303968390317973146773640894674766143605544186139137322012563352759271453869249863684537261493396730793340237444811253708525700028735865352159505176912168336316818574363222795149741902344057379734030242706707742531715508983023614505476696250640085383599834622940286349478043254381816311177788640956844174019900363602248771331924922198687578203904787421149097484152813633526740546838225251825084871622452815417593218888227608550738772278007946455047691939286365935598482383419848622769563681", libgDir, gFunctionName);

	SecureInt num("3061539773345086200240281471295293733639283224121758256920653367336349959362357962553493992064498731419218486543756211433121486260117996076180087841974241626906280650578706977839070466727464182867519025327931794440078925238536678590649535603618745708597676324519866555307188742630251965049843106588875306787223669335464936613477218607308706261276014995162431107365061045699020177464695802688865238933756864825420349071875478884272351020998139632162138390761721276304721775946789592597696081970260865376595833332135634140857550956787009150982455265899442943902634753501929406439679178741673876712991560035210585924091",cs);
	SecureInt f1("3322073927679705151546487037267864137027019386423004933671214003839511802852046256353193382889547652449267482638249993106968878970445504264297120699269214761979472947910466122571771355952460844122790878625221442199365777694231271251964768242986747010004126241236530582025327856623975026297680378726811380731063592591723884831704949117962627183449246104730125027971563546042511317672813717761302560400769583251144763426740834709580043079541219899380181736431664001391130118261834297315243010385770877759692161101551409051035042313181189768798751994879728258265382199394404857795868069760586220941977760283490237948058",cs);
	SecureInt f2("1688684948434055563426194620767129256513407613555064897703890177102085178633465446181334168213511996021332364618855663841409738816166308219314560454650531604671413002386728768205095397909101384989920930034656020837775380956215195123605425062368605082660298107202931200378755361956667822677890455646124559599946456599152615384616004557219336717859296207796873935113234732256060770882319627662317187129623011850122126902059278724841027517618580222192348343704888131645238756702918783037904797636551374625933431397094521958005948887561429787119090033272616315425889591731945734752425424277130263082788164537169663329965",cs);
	SecureInt fi("8426091273322918525531641478090698072552566575074974180025382116467605258491514480377057733395550431691701067135361551876804729299909726119675394444525024984927445147656890342218554275946677233702047432067710595874461352140751862936307354076753264028368143431974155609222179853614383049928447825749089598668398631271504272778633016733369310922325415427859888447315124101265830488832353332933263901599332544993401963150433949290733605601614516438730974700207456830291871952389785884224299182602126838538130686214524899391770593586814446457546309816308208068581617019626571298967347593053352661554444316233077817474",cs);
	SecureInt i("319703309209134871127778830994863546234892006520585316206196507993709166768247349440632326543225913701598835661470597153620929185417703089338991972703063885814552129712802796020685136113845191919533375295132360661349838031901015886981963736310851219372643553428105686438531748026718680763349688269052101123570211433694915497662428481584248482080181418214223439106538763849540985054110344610404378521979484179057355112181936571930702108010070986425624136532862775397565603855605623962905575782390137322814238348503586177182078674585528586327284028128709206525939321147809410698927327839305147903075034191237327022326",cs);
	SecureInt result("6682287610664188239120588680579347769025246688492949979690791353216920894120846702149297995935083444484429642929443285246164774164384411225565310740771702901949558109808357311045454773920781734380779984477453685521450472646405350548044681296893492928455720561565488916797500031386402951259527936638276100228868181797963361238785231505314339881677486649670523255665183778887288808709119361953428456057173956790799668027320804541808319724830224741109756835806033490403817487655782445721339924930561128297584445197267926737590200489735156470125615297912515675894741321680073399672052364026857478330835568405036337623115",cs);

	int counter = 1;
	do {
		result += (i == num) * fi;
		fi = f1 + f2;
		f1 = f2;
		f2 = fi;
		++i;
	} while (++counter != MAX_NUM);	
	cout << "fib( " << num.str() << " ) = " << result.str() << "\n";

	return 0;
}

