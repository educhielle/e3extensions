#include <iostream>
#include "../../src/e3extensions/secureint.h"

using namespace std;

string libgDir = "./libg.so";
string gFunctionName = "libg";

#define MAX_NUM 10
//#define NUM 7

int main()
{
	Cryptosystem cs("301134606662386157303422349585025305809",32,"72262524527989408200826842183370097581068772016024659677246705727489337914642",{"11574745913885401077444493924991974829965191578255422749022575896597391352156","73356771177219706945383449463146103271806435356431705705875322748831824039466","72138695655310021123622853755667116496313547387413269693547068903980099414665","62261266846212247048512049618459855059591237911646617784346696725117093837910","37088008732924982093916768099732415475433196640107592266817959590592017523059","56714982121115113773630339523423167708984227934280907493762725754901688467514","84850484641605944559031995568954790488440293350078665276188727127702853867217","83619468609434987652553052865158288435910791762931460656360119220969781968940","65826064094181958962794763675817128105128918606424107585418004569169011562893","45854359823088330239091752645173184703758143433433414865387500114987415320675","60384500372330562179496822027722608107826535612032652580892879546515953022491","684179982457920266384087528851499224134840215815035236620546192771710316129","27731373197365850396853515952613765683681486239319326521713527398985009187199","84921894679936199424204871023326242862513352522833710243960447718692170303513","90303787888509134744365663587764790269961482180497235614971028204789723876744","60859586887608446818755933921561219779902721732338582920844104518204169747584","21464174443512158853253526370161475861150218636177542628183320851724944222182","21695148981457198705449138012563744425000615175411913929564123888884596890935","26650263319207640427417589466186072444112619546844076160109784230626679163647","44664584031339748680279750497779168761099652624074381993930251051824561287577","25550034434164414578145541254803660385634651258630571342982443069813722136406","21237185397953129003524171549402530858489591777635387524262427913981896275024","78618439639294775900431400942300292940320646464852029268218502519710369675007","55061245078317433644138248842548381764135190937562876399232353084833801701846","25407019201324249222037578257513840857853832413662593411408738295202254366266","73651181892090169144930549511096286560240094037070388797313787099339385329302","48554680458095872910278987581708022197091197126278593590133561379618187790959","21237421760717852770310611094559374276358812701019853104423193231790537646388","20983324883090437813978834586569998993029877545537746547909270291957987207448","86194649586129684866300716282733303837150753208085367290162841754177671999087","48991272263408071338681501363661183295203044493901355978894872253400745244152","34040019671194588582999821029155342307420960559454834428561361002474002958421","61931047024459225100902746460782474102404933098239339198107394146469522792334"},"89354693790902005217211716696456871131330694968310930688281318133597911523124","39292247584838163060315290335383851421177979919129080656373231643757097690872", libgDir, gFunctionName);

	SecureInt num("81258591728605589084731799224359647231882429983288672038546103568274252999488",cs);
	SecureInt f1("35400512996085685617912338119574751200353747648802629107675540650035542037463",cs);
	SecureInt f2("85512197927021513053015523289505785291122552958263984233489179687013088171950",cs);
	SecureInt fi("30508983358308688351466002844582085915855603302912233668948843935863193691168",cs);
	SecureInt i("71499583293628221508110982392312679067653518982756193702587674757037578680131",cs);
	SecureInt result("20762955793675615053158475411589137213582833934181985819914965917690414514530",cs);

	int counter = 1;
	do {
		result += (i == num) * fi;
		fi = f1 + f2;
		f1 = f2;
		f2 = fi;
		++i;
	} while (++counter != MAX_NUM);	
	cout << "fib( " << num.str() << " ) = " << result.str() << "\n";

	return 0;
}

