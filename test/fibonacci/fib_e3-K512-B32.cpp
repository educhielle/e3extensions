#include <iostream>
#include "../../src/e3extensions/secureint.h"

using namespace std;

string libgDir = "./libg.so";
string gFunctionName = "libg";

#define MAX_NUM 10
//#define NUM 7

int main()
{
	Cryptosystem cs("7453691692350369622314536546480681022466701147876246921137851686868518424150284458757403014945138427731497281295609546269537184974367099391906379842586381",32,"471745804145945394846083157128535773247675992881981524803131689377709039211896881404936335075938813989931818842270593045471693944773592120198756279985597705466749349626502598539638685898298955487469849600937392901986618475063193381388489950093879121756322873406179978848469672891224848283290078661986250825",{"22940267304449718199275037143978232591427962178998084048926569813126095210349998419763441607926040454457617753412074161976638315470840216331063634024231698622978743625380331375577273703659078432879841571809876751729416666619156218732890092415857960298441995747886108919260666039257125908668662463408270238561","48865564882264136079052568264154526835548667405622152247432401261713312727386632423451441804536890008490528356610740012077572720770760836078921767667363986837200699443390035519157069931170064504240172359096248343799315280508654185221717525317509756552083724407466906844853527755640754803216052235976291620334","19369002878760951497666992707849944572254331891815726737676193984895640405618282698434769001416926724577355868338959984455450339784477298434554084711513572468918627934351821308532330721305075296507596208313368915102939556367746458431998952268959090838694156152238779430618197786802090330292213688716078688325","9352547560475550203677547762921384358334295687432755386051560349405337816525573900154257732144106842575974440802714093437524731996670588084886949312741381647393725977930260872491742764152406855940371128370846086009827126965140816513382298558705312517641799632282620762845097265337288055074280445414669895833","24351459910304286499492565100265370542086525376932929141613513303689153738097116778561903360653169216775238254967996738805804036479736431009779505528866574961697899370405098372017978751598963471109416641219076284473113656683203440323225984787514442648776841510323323495470934808029849620239402738413357888126","3304735089431414486665805556549592358811926806620971364668257560423801890571527168803898445585756347176135722666616327102301196815140363635261329641347574567412032004698641442770830238156988082904947274607520178941922396994457136591793033158796455344053613687627701941584400578788336513050109460043042033595","1474752612716132440340907386752862067350011417089777046889397158787372608323570180541486260962135098890304688383427740296518064310779192293188365680174959575307066413324962642215238206038210011135586152004162866140477994000700388117587002094040858985387937100382143436958298126628409913279566448180764964574","12894999402726259425382207293262799076248695596556594684238675221860453801206509116448800930584158977360607195947821598166991787297554624579545962921266586226944118730667037250817047842582729852807988261289337009094739152538421891258676188722758873686595707291120657864002992384515926679228319482524760313750","433853771107180073476063705503652976308332389546102991515360331722646180178881587780925637765829634447550126918644900585089349041596807084746080668776357312830000523233526338388796246092626824796820550715733344070041489664982293417402522498054023778178332953977642266785972897022899992493581216366959883371","51733156552827944521118829263586818018505343323830372595774575546846613713286806998555259723113239364251798551313475877452820506194180812334424290089829269547200764327617210390907531247493478493299180107142621511957131004087494103945632382721685670137176806745577004264721775898855590674843048799379843784387","38024572183117404449610640769831535039338652605173559510689925747081845669935186814909957072281218373022503821072090535252353585647559912678406389471499370109115222282759316974537488808242387383091176683904201194083749888005277622062824732582937322819286031214312223001458984296731934383149339408533554900361","36777222559039482090395870142700174394708829484889969706346806277313967365464283249114765467002255378813864753192045507015360477196644965098210430216820435213937247677265074749123031341864420846071024140366886691565550017809979452722960506327451261194064147299882960542660997929068678106627116402465754788061","19247730931197605798655648344596068106169063617473134512769706261285341799003128836932841214604622579250760565180175829869515016835177452377207416712635192279513516070134967708999408960688019760624552987586403010976451328349897153582857413477258371563870942781324126839520860270147911193846482856461839760094","37851973740446107746832802923685637133661337192571651950992217127689335920482310263821985009773235925317417479033693662678551580317737093706488298741153740121558568501954127489642905383038396556135976853445509261554549202319718792155653579891832312708038615446805315114414935400752165252728667763067867096802","1701403892461831427697469395429667949083248643257695896364683484477324227742418089637197973973747106120903726835820980086749828884522156930074792855616749734475745629423231832030139863812878113662586664911064444366904296064784154972308425225833479254486499001106687042254268134520278973209590087289576419283","985725370756227795491224789991021568848133557046937795437565738231036310601329158502642505402130892318810689491112980973551052294050491875423752871035067698754178119342530291248919911501031220197146115910032580718468249246626484417493970750276667298637541440414872484008654518289772066741654774255930959462","21431664165723008025510616683223831392966166760337332715104935792719082822408393396139004836907160188565182808703809613017125347226837418308926118583896893114629208401018370346473300197320621800025988564127181202973376357328165368168637338060920124725086278693739159667463751665645318305131486271456034446726","43059769751134750580837884404537395374947139342271949925318500283477700446978079979976477237367120190843996623610155466332438706364015477967597929990780374750433013187782238555143364185928215500391875859193327874358052796535227468743999692625649659661383065174130267543053820197159167799802387292201243870084","22326419393724119859862447936839668092684157010013805075325302611433475606885039007671825242746772409861573423769638346312984367428974750564265133110786093861737180157298191336647960559332229042153707799381110049439186080376016820983973417022861150629014323751517568218004672485916636540845085698614310147890","7218468562830209552802550878032458395572620214146739865146719164014289813434352737565429068111307008374583167454456240999861583747801151297508190649154312239004753446483005245663852915543402925990674791362540881323478034816182744853825111386345720052893170140161541183482944262765502891530880173800730442799","46607322901130386392107101300005897879725645222239399750346670149527974540716372067697278226084270009768333601909182662208443090262336043386290968997642019717611384482562885727928927603378507068051119013423081642144978374266014977680590868843654772305175257873037196481981439615745213770723020824563951433276","4693921669406693067178690776361834412646897069592768409439168786179632172214944042867662916330690487370337879075025088196258939045596890973860842790594933469161076805892741322014677533538105470157805334806480182791988535235953797657559449867238668266973352012224626720980953651548188332516152663676252377923","44353683636990807081850912287331595496384373707696731700803450301878085051431624637608208202653222316782028001215243241813012275707895697756339599519964011027202277610998681844188579965996295400261599818973859535651241772157557810991627363885422072165552501053900111876367439267498941307088642037363092898519","53984703021888168562724938065958234070975383668821218137344673694535078055952816190277321605252151863607590766652588222612839804242273101225820603163352266197135157387913595413509941170596190253515686205513189697930705734089304642824042568336970288601744182503704581420257750770694549436993634385620644443173","3347936755789439498262783292899192661706155310617351795503544621987714753996360486936011528809139935951241044195290679259405477088432415390385732557276858969802574210718284120360797266227511483859094531560969969637337462771493711865272093816513910023443390350163118083280235770495883213076903802079279206756","18031769188993420548651060885860001432264656438508262912775782061801325977827360201806979411195551442355796140253493818047713300101201675706697492116055165954349516188665730963250104742181077122235553738265255040767208504276426746098750008284352083585541276480982472841090865876734476149078708147156675217429","32756759309510109904829970602700215524750195877588072724668530851329423369857577197775629754120524026731152374418805164127017858957548977768411465451802466292417217466725273450879434819758448368299801862178354466651155925810339329473084066626684156713168324916615373204860980972936741158415071917672552682628","31246472430194269045215316530322615289406651896236053543388450278312335461561444331245212636349061787176552448046702309886465807190217840437580138212583482922674735124850954856093524400362573628855053647755650014064082265248461396343030571539972160119594650508742261566416801288672460415175976905366312764831","8946952012961645660523821644305448734933546401660938785613492517889339007186404748290535903912614304303812783376452536293934937815008677547858797773878123850177034319489930502412988946825333239092891984339404399873518288628374142567010826876155826743876362450346611643319492623590674743558117804932470187022","48497083277286819275624749555941334691438288956472003290445300288056134383261960290930753390910382111543704074468435860717796738598683705691030462904329999541761808450028283739579736898310201721374011449141803332867995357354650924473950506587023509663599725056211232073708795771133878836997055979203813829703","25966962991807286060463576630189077891762212899221672825805140793779688607481003924313149320353177875281628044375411018038851857811809856846341611918447474847974368699431808366724545928919193237357925834303839064806523861282373178836036236376306905598133472378279746382946684746372216566958256803559219639094","48444960468678948554230953451758937876893915526478682415013341325126151786891163702851907743271703201096148598080583791081138794996744513801742791387074493673935328983575989341604319471406512412949118557667469732713570044380106374395645600908264680029219241324577219968038969589068744156429409362593723096537","51537296600830327321792178805634324290959738816999368170539875243413334951332523698239968245591975905121194360145715660492219778070124880018500619046075525944871914414512565757064459457979031325964325696014100747251264427978488432098755387563488294143082873882164618540110239924623645417388154390264208242756"},"42033891737006957876382770557082840811416867222029421080319901835219363806942953275688902991364106164603243270739410927353013850143347072953747557719385969913400385265179613216499861423835796582835360920638541457952627429452794260405794952857734085262598753486618430281944150371437667079753232951195343407228","24764284964199693329019774074429753257314805445523049540635661259210691687815303031152074744387312807516801128505952690179651972311040185046661680721264411272551574657799176812730978019156051036733393244502727249200425661509049667336033166063311141773781292996134934583777035820742175144606614356808960091070", libgDir, gFunctionName);

	SecureInt num("22771173503756823280810524980195334931638310113993022102064301104316110796783807961006239049908249238250104470403935599578676961376257849403228177404557565094477096375741848174366608413696003205363489552879892364045403639771455190865596805355392700718136266689634535939016457232160837693270063969532517246371",cs);
	SecureInt f1("30131428653351378841829011872049914199959221725578151070366501790675575479722598843079126944698358689363673675312272513164039855129063056984444911887281854033503763189293828590211314586949035876344712766333461674015979202756861687370826266094418719646818243909255120538380211465414027511012167852513838302504",cs);
	SecureInt f2("53439757711083183578452452165163227201316542913369374936841021068147880006250613450837127195700076296110791547451610544519670443579753481464343224403792304456241108474355740956085050650866597260470328758459258913339739751526553516172118562571169460309625056198949662392590959951839515891875160117882943931130",cs);
	SecureInt fi("18057010278951178682309801644836600210088968762060577581081999140651938852855775992492493008465223657111981844679971226464996513017908444260677256323071791539205570428461003520665432650255242080847093135375247695621784711277652777647695161585951086615476158544990123532620869280804394007079374088814753236339",cs);
	SecureInt i("14568452051351534504466627769538772424464877124277900902035449184759194746733076205450341295274631200729176514845775298112052254983686341083818348544752480616860901492604690156572270456585154145765391025529499548132392071557234731342672149768291739610453930729260959367238439104696584415562500673668056918487",cs);
	SecureInt result("29879779532335114393283541837419505377919485671278027390320168386881978501584370645284378346352615604056026025365275922936760459079911349017556009425858777944490346465899051760228252286070234388101572099498664013812182601655091218697214826272699720254992642910085288046441161790635521280391094287805541946145",cs);

	int counter = 1;
	do {
		result += (i == num) * fi;
		fi = f1 + f2;
		f1 = f2;
		f2 = fi;
		++i;
	} while (++counter != MAX_NUM);	
	cout << "fib( " << num.str() << " ) = " << result.str() << "\n";

	return 0;
}

