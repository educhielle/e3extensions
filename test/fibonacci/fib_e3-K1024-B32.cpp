#include <iostream>
#include "../../src/e3extensions/secureint.h"

using namespace std;

string libgDir = "./libg.so";
string gFunctionName = "libg";

#define MAX_NUM 50
//#define NUM 12

int main()
{
	Cryptosystem cs("71983582975343384701373756534052997279265976960119157606650522594060698280159252529420965107079904131371167278297715295293102994831736552843149374225693984623793816530866949542715693669554275704086819843391730439102561837610156472966118591534436343989071126466161124449356190047285129435392495184134945243321",32,"1767540980203907103384054930423555328550560307624230474583261187279113025176917632264770668337476737297036570725872285452168557177050255637298112507787715978724772267503159535778149952926464123196011634066741456885808498595502700053481262378026121330120781126844271937789303065795579961563707502376573874570386659478844494200685509474245868268991921685786278802505532404108919824086809043463581227139678078050784595703426689362059696841493807869130444345689974008651351051838380508900011639734155088193356884082332541697776331674449250343908038060923585109643656018108300795747356690009580390406937414093280332239351",{"1472049663385821365534489260219305401033488557929294076853571975014723646010811243706606546065768579942468629869616817160659602490743122474276386221469892606156475160772354889437466860902051742444321754971567106134733453803956002300124994598242921346717075558717439714657119666554093001964849908950447929631764260097757938298686008394552258145986180437492726071347913695273604178153624821009159299471144541423173782968759928725063172668761413643113909941065234623013979600220798514698126064569570976724035470007707356204886170230917500341935019413958288694028356379189639660601499231921980362695090414669344287938782","4441201731080986327410545543460323789439975683316062320473848140473055499374278602806985435921613399927823041501851508429946683027582212963927445118792991504259308414359905954115172467489010206877179396889281800549604802283469939496873383008727681229405764354059689351679766137804582093466644708555227029477091704641121117124015808376177987640054943213910638393501265979428405797317256973815310337618517404968428941905866843962005569889266380713536292731830520394412320440470159003534659971242936531159989518359166668786704639511122160782949916996099313075232266160654984910251712386247833772313736879477286324435369","1602644762442860437678520295030618978150589098874141168517665189746963726483892289763442473901175710266107324245201666038687053528028157612270506628122183967569410543516208065514488421183066223243422481715414354722699500795781517522391247601138284653083684112313869707273496746602129404681039122448374235320780044097167916830808635057124979365986632558099004650460450751929207203410103208808592489433299889273712769562702571895703769238134197011707402679947496945644938139678774310019305925169092575071719337560427601533820253720823903301069556978267639452126058914168923629661744684671423292007748257948718871343874","1672011496668323534325714715239501942409688624953670204303406977293084147217042521613035255613043393192258710550463338975002650907809673160671055130904841970446371494909544001001870096120374821235822579931108792647875170883363991515428916812352278876473920369656450347578479643436964209578553653127955409085580003253364227514505504695207893561937566552487822547898580460426100517355608090894950694027564687636268207466228757808401735912745027190898919774582045386939495041700495960015274961849934675111363883411298112015597552480916713313487855956635883798597478489847479076702537694812323356446064967248821723951936","3707357185619884960238349919122923979417333702344279953646187328751530310360007675637081793447636451283474212810737333918573983897022098992627316917036163879343035218732486033762088059434968671722229113622974153052763263240027827976273099215478590602290047771230688464061854028647752111642569786437953894028905830506699670785396419969592121624296441224539297847022118156327458964797068687291226093861497370539453504946654741928346075174986838883932447884080295370314496661202316263801614957158694914297273510544868320890152680094013313419677366637652838048168329250898585827401952304659043288172249092384458459437409","4194262944150089547829149529228004343329322795882591403479818425780261313576322545400341931930654132635146426021950806429672832836110990898623180944359388985269707064562252727081657469724858239600196600921362011048496368383887107829717516104483118965944016963408366996629232274525014001624549790425156013880276092374223060346706869160700359309082529156039971608407990441983312813775106925539890624862924216181340873905077250774782581003550872580221486780195593974369150661318733222014797448644793792254700031698495243178176557011630244228605417278203786686738967887821042945866053080151826364594801121006189076440322","3828417991948690051830598489981429021070944730495110203052590947531942275913013405268162995173040006707574720614969427341801230826323440956872252530867727121739302747705520081156360621519280025572582427055951838324111701898786590708363739713741230640725845061730247161318386757001926812399031880733143984215444270668278382867509227716192464573907292086501398111033539860535930280854254359127977899970134770596904111848217632454468310761015535960046550175659289851295391505571882311056503576975825491415822331828513710248278951013046016978855668607384109692260407679961864111307919837135045039202785858645155855089234","1280905283098026154091892300216484686073303077661391577892604313731968842207047833213647984378630432534670838996571653822632684782272669504458178408768036629888422028257643583266473901467152882850039551020854091654440720860320798080166170098976791120968996890260802967940308906647761277780119417165255191535599079902853474867002647638424063544921212567395624215158027197706952847481107627125196220032278818802894650128598163452221769248103865999721570004215062011540467581678172772545844781715895023314215926895234666815208981770475644196621369699636592220812379744377544047023469357293523694297000427419178509197960","1627580218786030279205584841101965418183800695008016694135994334191879956014473745519014466974223190953227701813175469215521970762515126523678348246407590738630443323570745017875506159239850523017932051521328996784361562678944601589427086729250249638511804809969960228793756750806288867092310640814884959091538020800495640294959465165747558016063951923151609804279344642188168601121219539240650644645085128152011034172509852847804534968493288351730218306679807143481458928954170544538259729413242149207227821927942548198040505091544147206933912782422770472902394961159895122560140979988461430333687425454371022494204","1321135401871790781149555298856486309681312852704698984939678657776119831900812350405759632587217657475435706149826885472884683749435096190868802939420747049051707379350982367789290063165788839780587532400595736402307591030907021289444305702972135700021626100280349976872816268643315881545422562171097142332490871406390317377822128781317590624945376500400830158001076958999128150484561123034136571183804042276318393253412451037170848871455677183487058541462503676239800189004256179515808791092296705523989012626719989337903478596166755087347945187123902722519155556271265949992004048404038554965421468475463902611704","32156198258576831058167240106158640983881856120497916704244521538166148549790985933041255612608188312006612192708399821673107718515092807995778898524736361306205624972232220135983963392058518026854402879575951380268854191104272419627511606639226944799410634696370164740145939461005981062415964740636897766647556354252771289133245188886928706573282563898957468059601327626741173203024360540308856972777131009262738033415175335662462378213579251201506392936939202467580356707602166208634212915626184187110354392474591883724499885540670573656468264156756893999649079462921098755454620971256638199693131196125754674353","1605387722802385227155595353650911393344119700173015099373869100979859477220874320682813521262752426157028839658521941219008589663416405468117340207745222003490033601553115570810006213289393609803543490453080971848630425556405907346481279260385806288747807084762515886916706493818296169702561167085953659666652368053931612098398769896072899764796845250170067971422422995322331462006584639620700042226756664457179826066357264597019269362156611311060197892138679464467746794211035143853061451548592103254696242076757303686029205099042223161969714555643375918628365153994358634910815571194277007855872183980977650123174","1260203976735561190420193367003447577561053545033036192154287739865320970714238825494652719053258012403573405935125413178703493170998572200351421160509782178704704854551089952983175673663556048569412180591166908531534115349262324781296834397910476612287821778099023352384099229940663669537849218904893187092228621661862483448945411623554312967464585346925349135600030629905438948814557989898086809213719119225319780129413457262711246845841864760654646083252632782309809822863511804047392187945783691871623875525468946183733027894246471504574631735081240648275772257366901519901380936059258372668470527408680866919726","1042306553477182964204093962643223072556513245272607100998040547473358657657028904755098444006217809004378461852673032426151813598382834557512733074793573253526024627144788896493363614267076826186146002996418562011308438952267566211726241856319090832826499106093237420378878036867480740802555458802360462275268574398498666023051977469976498829300678009817591146468388779614503642191504201988630950183469677766051031172255464687310208559846313325513123831844454660673586445498447074888386063138136807087594841680354486302997423317696598174744003147668873169367087666698669726874549220529033231833392162331011241349367","1551326879120392597506068170985176410808271262557795600489140487949827080422733413655494776193624849617984752205396375016619003277115101780333860360918632832280992247436519996115450583939420644301229945932947397803716044552545686156087174184763204852580119600516610871522025297037782695205929289824871909564617009219604346832231806739962415107297967857783105022688467923933734219424171250159313037019320711202463313439522807103390318080222772142539281680592922807126172414085990215221791104532168507271124370719910668673623152849233999812851501024516437126383229498437386457355805420066366815022414862976619783408032","3892238540489905306375657616451455493639383155240705219052268176546274310030290549148701911208515925724761365321449314560746812053081713859626741014910297644688706312610911537905402054519756832092525704494503143365138388433286471736983598514548033599389181881069213204114688183801936366365516404249260675907862175818458295903208874520529793996994415780712336021567080840312220352112762641009292568705348507266587735266983526761581163528653674793058690682487855108024263076259697553892213005975917466345224593145052965602288548168621131899054632336832583165800016576586624909099437825784900698925231216748648161042974","5121525330023969182855064505505465258472631030808979721818879196313398981411253253996739308723054611627253947040242695271183809282810129655712437380055032411378248272100348611478146703864418201382780905352087310918725219240334982465660671077858124658448753287621205365317111199507393778162395665479907067592535587487871062243736921808270074101215616932819020789643392740339909195501340945850852718709187566070387257875205297816345584784073049890378097213128251316649527680736560195543461731761673088974424941796262610469764970769315414150692821759409732624159552666866861480372956560164959006631158274727046871413908","2075754013052138596811917900061113386428294416720209297700926646919753021994162122005116016887925674911075282493045674806330048074921091645281749620998111490889232095780050459530103191453331808653457065179526255806206163771296661560380537679457214859549000217514942623779459877410034474757194296358486962358943492053507863456350161270950797761433540688432095932258835168324036011585006133622260738110631089141071313196568050579045827820057051966097802971848325953055455191530354193232802195334885611221500740702317696352946309360319439583314328582496906582183286361991304529429297822198530014766846763250864998037879","4668212717437047211641232127335277786676267910679120632065650619894645859503313751167596416134637679971057979934324639056298893940183860997164053775178125662646613193669187682607067676024038340685084092321223501366468450572187857915423344818447233670896473841510305954283927207209182426034035324930494134480157589156814148396099267968549767809227752478408688087789613857239424568323744883081216389616332930355236989653498014869172637129873257369781451809713853877341425204923422411630528917865198794514550005346844682570251324394480605136089273759091042462910248181291010183372923052472756808359311373477999792472034","4858028486590702527140309791839688747395640430106298668260480216483288914102866861139483925176013504086567475496413997882060550774135527209535635927170778973217690112780103529811572973635616455124285256199564103986613659148681663471976644483931111042518328253611848556198001766924662872760553792907641599837591427508994792210907006174609179816072209046454744182401374458610534457404923957471081220415520284357343943162650784441929886861093326383550593779647869770488995160224624279191200152533715705414968329113868069882210851116947513303099755517532609763470634097055156533671206860125137250176127935675509241774159","4689822392117145020177931044514990049500263392108215610710742031343244328651250387699344007007482756956530956542663044054202817221590924827151104515578718716279193181518741501353018946914936657279915060241738767499332863778909507834489387712401379870426300883011920757888699763659948853455264889111864277427696290783242773604410926410353794408270852028587511393344141525075758845313633603197342094174336806364062534800008750981248265873406425542479063038558519895954207548302035686445570468853571797462917766153336056217339622486161589197085381896349978041197842796910477295538862184017419074760540954149186791304547","3593654759964561944098923116177682816418604707748213481584050479574258446764786971046151662524209554064485977188704263755364604526630180103428355739626255444435016343862114792046385877737928247114964679875670602713048747264497977431366429293719319802539763058253105173146083973527187815818038248572726157109784656328897062630429210041550743273886335340564969304148835408108981543783885259642299114890445611759732871245904421046796972733654395421230979431399472314019952686954726019640141148318363388017184879739503490126290150592440549625944062682724728288974127304765116384679958410098233433728802393582560202554513","518019849714182413348675768627094535577896221897471711383851049383327218598206184213762423616138238350454348117534351396208130196600118583554585909188355275694651086544358336155571330699719406624137864725249901238513303864127461933457776057285034707531199391539038608484693953619382321632919015997313693925662200788075037412116825367174789581731242327513284292263371398058192817886819472575896298762586691777206288230691520660082881187918807416628074256369893129768706260582125898519289999932082127895776043333114247328703612952045397986039859440138399944686371619806118450423535631242042388399228375842580100875545","1630040418260551792187580094683331015152365445097865074934839842848495359798643927896098329114411073480776893527444804112058946560028941515392498476019845259981908318176224105771455289044531153681961369875688052742286628905506220326394007442158271743151187034332794091183760445590755025618449693724260706407322949593575217871992606084544630827589283726590338793072333005700093173871719532295927639458720023455696558807343109735399537774903411689354158230893553095001945149272658676826052265530419711158089957740316958073709656398784924324456429691702788739725243444135281385310567227092648736486325967747882999274670","3294251040872072982630309240124493746904823654634812336845357597933982718154615185343987730051065056855120143380720367267538993304863576969340371449744160675488953821755092338814584932562867395724916828113199230184950094151265428982222627275899414876274205159107703937875090215818384872487113596331525628757670048207810817475138262286434612519476079742728455063526731293417888227124482276912980452890477306716764152474690200621308437301658028002224124644820925819874083963654885954726962604949021989815148474832063352155152299312448332757835686274571740528002267217271826883430359013143115224054184162439709534220337","1122891378928762960480356206133246107847064128203004706476142701406475432957722300294140328380016393917178764249760252491479378717460230557601802098250977898265139476211912819505589563892707679018976467148837330552838349028209807482338309700567079427826339367503885916366917815989876691789043689094841856861726219295594820077340863237668627680250339525864581248831040510597769997589039963196622069271190943509227429832380498535224854722139105975622850186207067068219444730837655792309345080448421571575885375519350973064349896541401096418246019450259433907468285664782928290772763831990600393763761480394785311091975","292577540943612009451650780255738705575194094969868414964610912110235153699115729186423112946580262660377401468949993126229478712463526842369942637368862416876503791559368811214164708780150925914871893015265545995862002964036394633179664355203067685175310188781490697787082939256512451762509651004983676496806080924992747517829121493829645063188394411625946232333426543446757534354769926481304100078000236043405698425843065333555581851427008663350054657918524454644642421474540111355002714509101645068675312707862274741106041030035113133671391040966273994884832026661089714864962214532081818307847648782978310327963","4167166635693071944540600898702272495041396606867472935743615788252983828583208032378274377618354413150090993020359307125213061969695614959349787837077413065006308871771986217956615716894494746013329329225615845726495163677433362911132945986287462518389546779131933904203593411033900138075444210205292495438557942255487663522939530621775750449199109905648593694237169511727627334323740128509321503830817284826259306799990796872147274349663076905080947640804378792516443704986756488977083435611299896819882768732998165642156573825966343452622865713108015710553706068065636071692351502442855481380900147971442047177572","344641386374374080688775956393584690526744377329499105561797216886276248226834887418744246062949038949432669534679094108404160811788935496514945425918517378022851504363604907605896385204996001606145158051651212711046288913744826818745237737077640036267183615227104560875662305663794770769114999031353919065052123893836580714474898027493014786442493097511189994873578621014743875806007250173296885411801820190480532536513574679342629576195661979989940017783383447658106439205710615108121512469559393258124296475528325344927574140711789328498706543111870467763693594604599922192714876185037781617239803707605340910612","2208005607591820696606901627784637934459967210350501282196512390568796040827404969331417728162119474959039485802415467583746531713276194038011541904293527836609420010207747091754972287631678839959618477200823521809637989337213219868510356572142195929128997993967390487640559047376413296055075710870221155692260709070433446650243476234001141263519820640838167487489094429144845370866256115943132684011647875834145128679318909535314354158705601515595837416211313122108405369307511193930507307173456150954165784768744315518781481287918607303672529157608564021073963425950033083811036380870135758839715843980493918555787","1197438283525281044196510807890710277852550248357288315679888491839798222156807404215108258960999746120814820247126527629087156359952359913610251559400077462137866101499862513153147533364480796728032358676737827791658466303281750725277978353889974975553574944923463017379887424371656245224627580590400291501193341969379768152187979931764942769226561963602699858635940190445724364648578835196831131144131247233307023105930712378427137223809314583760673685837438562518023392895208430916735266944890826129675700842374190056407755197908899627971524544182386454159803430534595354742597334715063370570397960004879453591255","4099396964369085839060145255816674712638231853135865123285715506145313098503674927750879791402275544491256854993031316482829754444726069718388594934284147712611240534857562698730883720984445739593587837116137725682613372071031301552458595024460016509209709820895898534832251328306027335927913745496291729252306322181198478630951876611598867758722911452504282250221731748486004412214817826256500642254799762170331711305636288188145829403575195317878879583802976644215460805034953635084335241520458242844373375410578166732514307837115710005060091584849757940551765532911028737116925207352584008814247417799359100999302","1748791811958608517301624712595508668628095865199704484897097978816119672595795663853342273385963107412368369939337382887292523402901990441717105941481927768291939213247020523912224724531791183427677918366037306270882186228394543774246178097957112158411875937699960327898582709590131204963149225387349356999221366831654432657682300237168564097031827516366951061250638064260499264182078331533731255251042330840301356220874653792208384504609696851722331520378149370627873241369925349756529446886491397773238847345067659058988766752729003915107785879377624598676661460659586097070841544344146799865850738399049418535212"},"930435559717985129454106714112067103443948165116048065124513671369510414880270136998339836630978919866432419659250568402315828229959950049108087835620949174012955050751113142975792311972591923968403680568475415271281881160453895219487416718895722023884638249110348310824004652346096757780927284857340244280718239669222852907638397901364308732944595870047717067152349352988972737022930479650370409463042507156307553343421799421969442322038034409528672335192300268031364900963556573595489496288623087155209523187115610080640169204527789359664927991341495560188816802370131957530579097715251160268695753680125503647140","4559333990102252378905678200901384618492575964970039461560065145027932116059787736704102335530427304891802607508256431211411479541026201105038794356689891841823985168257502485204235260350518872646575042465407138154003326300679810106611726963829559221494678587056370531327634097334326527425332727795862739730810005234721103522058949039427697273006689058837455156155442516032684305051761643720141643076857836778646379880665314448218404089066094610789075501692105449387165859215460333481407929291739652491762319706542189963872007715771268942778602912124119818911949407167082574003173391601783472867721356980144169190328", libgDir, gFunctionName);

	SecureInt num("3786662956073334354378800657444339240877755127126839103638528495952987181216825636408967059142784523362772009373690617188190187222956322972446643671277932294388257408134020660380346371325925140274831923049294008655637363269424486590821330698456428761968349097800564268305991189306365064908571673493712087071366843494965174110335509023553519811913388827772733919024529859854761335767048580631778636590803382947639365786931191209537907132580734877413747518933742981087187404770616574276604145287659033810513366337663292835987394113217181931193589269507250823168222820674346856522645050203287028638158344678487756467953",cs);
	SecureInt f1("466620644832964808388111478822367031661380227000787046916877080101317136772381449261585395296315773167258597517194896967222686882573257318412500133496342034782733183102451825278650069225133207136059046230240022086323186053855549348938900182964458679053062785503549941526796769053196107073377701536561669066592394092659719567907549731500451557733924063865223954683480967772897377306620408494332596583880544937679495498585538515640667731426324081976965594377870453317303008715240521417622917026336250775541191300972969207998466903026577711596031936655989811286650921626246378230262289351150197666791941504504243256145",cs);
	SecureInt f2("3516898149451512445710250852617316828814536162758230740618709960791072775754463165832962108161951621927341037559365368246733351950887418481829585977187714624682549728469237994900372552237164604215308095424017039894759913725287543180281178552877770278611069098547656422430953400147368229319266627818838864011849971300290396239367172975178102109591004175350119167937369206512903967263387012069236034812109299112808355989893984122608349049565310273518502423568791057365338615287231049840830944442284160149558406530790100781512876630184334452024293487343095485029840003493577408780946378106032481459018894492552595316864",cs);
	SecureInt fi("5174861729535166140760832018393905969576730759556128523167123869833417380369720577177360866676659369646078811466328767025554014742996243621451099522457326369021717340822082980324523973058493175441842768182627992821944135866053138570160068330194433177751696140879615009520939867579246258218358709159280324681109691087164577174320489706055662498229634529276530390355839612975720813882113600733611097496117080549532802444852872682250340985910262242249903312014869205021239430174099963779049778798958799158039733047199148625240903480168628002970428997986207460513530438313614613794549940258837428783116493243703224576696",cs);
	SecureInt i("525332576783952577504326294191797608374860218319764022902653417998203995676902407540935623017525302205447134561989119400569631905495083824186498037948978339893968936348744683447109902809777356925712786005382148569561598493917760435312593164344851987303622903424849828356167822027609062528267638281565310593331563304346587831288835856649061932045807345633688974322568565910659892236952709895334805484016323147765929565755956371538016864817890902412038952181949719845549434835751372786693267910416418464435947261083523543322718580933385845731626404043319401634534514413523724113372419419597747089281089388299798535532",cs);
	SecureInt result("1291402970512598569361270023757818435336926159468881837011336495837777373140285664118048144969731285284294058954748059222565727029876337407570830229768518644577696471450691671567966629656140981903023826341344375242730937334329957893539832074872882255698059061082326612973787319668965824454374212917211086637737270450654716889591088931870119285527084875699760007877812188197277131483229067940612618989864869334580835250249720560351684805164205308024837837678844026775259025048315014746813276515069024113165336332405563492806663159033195230202950231028704104535796938997251394804819976178561327171558221809050447253422",cs);

	int counter = 1;
	do {
		result += (i == num) * fi;
		fi = f1 + f2;
		f1 = f2;
		f2 = fi;
		++i;
	} while (++counter != MAX_NUM);	
	cout << "fib( " << num.str() << " ) = " << result.str() << "\n";

	return 0;
}

