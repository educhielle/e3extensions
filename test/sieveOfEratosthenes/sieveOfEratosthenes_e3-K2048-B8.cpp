#include <iostream>
#include "../../src/e3extensions/secureint.h"

using namespace std;

string libgDir = "./libg.so";
string gFunctionName = "libg";

/********************************************************
** Create a boolean array "prime[0..n]" and initialize
** all entries it as true. A value in prime[i] will
** finally be false if i is Not a prime, else true.
********************************************************/

void sieveOfEratosthenes(int n) {
	Cryptosystem cs("13825043949266997394662021011643587749274468840587354014340652477920468378580643979805686751464754604354518473490006310432947976302864308017528637727248104152378789423047236896613638219292182576982490469395609844115006242503561390063645140457304532494944846510934400490770865839961518686333333315748341234249643286068897372030277306832082854158853429390709227929952239869140155220111548970053253230991481392624542928691816638662462313827704631839192430646151921019768646872780373025243413896815314264177603754427168340295963188921857535792705280924664131304580805614537745146830537584932577252078147496477137029875429",8,"64817973561916691500804449864711193189005025393616189904359597768456032194099376743254798382881555179635154380336970210542872764546068785678696290241371342636046958560939899892974318128088154837055027444236820216066067758631041276916759079886519621658756277594696135561051886516734846961942897954218469521965769688154750811585109925015763567686653469894054124329829789330616810395746993961909511356827517893622460834692183206885964981347976668820908212323772274120435308472571422896664719892159648113539313693535925796784219769025928937264935040325644694643118932748663085829800613003758684735183921319095141051066322717099052317951188340819633705483455948272905940426195759783875550126913892973190529932261142458274919649500184294825479207837133242315525036714155708322778000003375703414888307051047940609409215206654032352001148243382019047485613419519756865643067273568033197234032963658493163610450611097032479997373415970020839844973499793569066300983618165788302621722830714057646493286795307027977131759645975343019509456384850002097570179693818155517733869276991822484920625779171426250276443091650505034876081725653320389528453104539960229884318204337248004497050917473572434942764448491206700453376340223960394719297782746",{"95672313167211462730306100479358968903928971091535132881581376254619309539584006061772593993044224323973545093157478911294024096977090065396568317369810433187142623632775041305061487671457988071334336636635947623988599779627958746392258583722233488308784621927467690692981453213746995116598382582810648174081649604086873094634280263562241018128435047951823782195557833883697163390507429752621569176028851803916799167800183487025494451621593515223904863574080730105267555551243776636962306101866427880634207736749952087678505732126895676930811071784495002788514703919173760523477377177672578519076298027832958843687261819414736822626406500971293798999451945797993265650918412526364787763770447265737115956822852286941519020213485529511773731382591812279943361491168033063278500052591693089652624182326368004449390174106184484210231779554045971989612964695647387836767076631795107471926864266035179099219460611810789129808026544343723002332528864336766931421094848412917815141985791596022292355313344048092617941467870080456820750115444871382293227803043963797120746395444807146399895297050607414513329442841480442572289103667982834444524244576371835160532974559049966789799247002574668682361566767638499279297630662847335540919411717","119223114659793476066040849652908745707670042551687676044171536193375827503002856386274455555508494618703211518818374320569395906495292948672531664845611035795528033060530141517856727458640223966653066502480905383562244949517567461149387697889989239422198289337865926452014724674856367134623605138992912419449572495606632571869293348535950202379110964904442979228788570748974031860727325560578808786232471619902586614372346573424995235755024705144034622366658130703120115044181164623713215688447367102669854240133160356471642405166590775513843663720201749748525707431253375778425483685981832396973409955785810950780937457709108634135328601938119558387614258956816082119900471546084316937253169111327337337344509263849769277532338151010275480897559577847387818371336997770007559537919928208311181785972021201335489152060925639450268521837243940306992504693753757808937876428743691189135477938074452019771863392493490779243063953295410378089202877500711620719746165575143416028547705584934988728089842754653883609026347225001547618261970773129449699855877589942874444652079418243638078693368761476363107549934379204470597461264891165897604909397917981015670467915695479715950670029313904091887621996646540695842327831666816535716221395","99770510785299066496042815151843691963178210201197666464606859666924174873199207684706838809270112586231789240702469559819330424785487409706330278743073107157439145959495831800750862074188697162559122607292490695282973355010669649105354542304447301351164270696526045255699822150357850564327611552453533849495531562624550837365543716227829738597088643107093527933764317463797427960783157925657972238986284849501981441956026658453206498245412234078933625740403737690129318857466750025584284578108789234723764329177462105385737833671879263858414736684668001139432390779364068450252710457211837407624736609512221165305353321063456137063412445144783930024798422781126910675388245936196307291804580323684344555930313192766310848454763945849986590320986867211664182295128255159433201910542115256886131784441530396161704427306827353355562510645382050792257979256422398466372097769856927939110671418499305677994600569445681830368385288202992650891484880557428092010981850388466215156239788576929586308048239743155078503905837991060980021280895697721263865608140735832098739621143871832743938480104015824456448463479653374992434759698979384329315571588088957631948781915696794288962687223684588209498653708908062625282041574225324464064117993","41536233154033447111013097257604807169108922653966854558934452402473893298001409463931696118851750991129744304385816182812363638473685298167561106647468846827393773070215179818801500336185196406145075967888720393693964515523559607282664818293033603738576450004948388370458424531299010504362035994259955820541786788954152842423331788947858053946966004556307064901251559094108313129669337054636912181439514069685421171575785708138738614232121443118578908118350310328308704906573160912402350011291625844623470555284184321394833215997172226599158542678688829551347825138827883155751475590769097640825098337037859566774484552152091061891601229060942970915745231079755250268468702985616855317384320194276716938228238002517825857793653489675573908898463938155290771803157888564959771241113063415723001265721256930401414667329750190104611872530328851182278321106537703244926976464780829133435486485367345540337055151274101205862943394154575392948504202229910467310150788555116935436197936311818112582713542623515557727678807543482015355857711647340134018107853092538747285916036714536262180425358062682116581863997007606518608132615434003178924588953771906893103075171415825343477027821313008019771643224819610177138349683409990187829859785","157052117669845572784845375362561926829183535039156208523580316190484092652232493851805600244558452107723087001988093924535741253823582169803881617736672912882672664709494017486675160505056423511245050961454542630474217506784292751981626441672975259537091829264670197405032176092216699510274030161091390258438384464574978522290603064552858875883810063747922496005824702044955298098495637845664810355728791724483819205439356023937642206603296300085150144589230263337246042576671889688953953296316653902137520819446442008074541066613588471844233929860011651888821702807658206412600263347056582344954139635859646971683360451492667257405754552852846255926936837373770687171366325309342359872635652807958758851185692582862440065737611319481000971380925700808928181977533053656015668788469838501501130911787217935561446954939447994015136231327783215378336639052612915259457672134252597634705018803850094613569651646515458373066754861919662449097805115023256958973057075083041805333091102336181963844460689791679488703790812287987558585592583992562904814505784602888323485823073943110105754237779288967420636456042094376066502128842860503246688675460480093873672928128814180799913573109696275327944228895695055362976452028698039486483228665","23313592514301116628763865726199759987524811095368746517436972639195952596931590818792347989533290972995661039849502755657549550967711646874063304284066052433771395117527524342314783964646100728536899954320630720129754967262522376981604811860798213709280491191079096832991256320050652203312848933516601849560305520489047512068410698361974065977088844509430032228399834191943189334528495023188138086534694012755161637013363319009939918139234988491190212082815420445235631381295567566003298413179180975630997665807162939073854294360714100119324431053158236115042700882006316013084586859812324472041955268497229315535097174035336956080471822672451388114610765784637073246614204436653733713402219227688165713654638379255526406209275499787789082394061654229912443388449760659852331935526906084485406043844335979111620658201531497073994186320151590416011171821343776165426733757994995382801519183357358812629319156817227462199579743427752019986407156215707501250302423960703972501788064204928457593132036122821302896587001081892642045479849499217340989728748301611997434471630907167873589894662992223311238765211166799520215525091214600790983441835049313425003397180186420248533263822949231151223692764897958787331453086789634535905540174","87048218807799574447289069418116522787709114769516984523214516407972359261135220703239805554616782741572546771585900039360512285544024557427392277743576216505392335910456928810639300276375414930679727586620721210323431919822530640288518590557143364606328395409895464202821744758312787785273032353901429365769730305707762735739952878620326716786582367165551352763396278836899602233278556806763481735581076185568533211461542526780709384647504993665347950325228050972168782638253458267932051247678923905540637130327726459009284422022043455058490803269835637436304363786282900041809616965163527400794233667073234510330109895921017297283602675051672058643415978888393261574933186883909070224303314862816249968452954011400059963815105102420960732854486888462867012595342738045856411880148256224970362087304375000110199058979830785744250174876877080551405252269970574647429310484711984610274521986975527535166537080602448064131449693837756091377621888792975892458870850442630169337241705573394213129240240564576973701880836055096461838841635934085474183271066109679218722335632606649202609583899532941998609366443938123586779996693193402515545472651105178007926803011719792449510794476016306595635580414259851049564576263543919791674600942","2531095913964623455060066046513429246319345666791786320562471103857507387372711216794978387156452541614451733616173527111028541469636229876321155006077946690211492523399019233527173843288106110835834543751062339009091110318429408547188046221480737627895505858096480114152354247812520100222043059347555243848670078215426029360668794636330005870547883497638347135228926787400632312542512627603260633079418966411850665409976776424119763177438438255035484873965161414753453006562635226593939558663605840062664697581825837575321887819953760248028494851657209103019690068548839317161317871360508130048342630017310788570261196955624912671142423154520123089519030864741573409773644769529679438606308826195903684179264738228785726390345955286953000869879940912754625215107704991339872925681414233751471222662045263476401330972941292473518549478275420082642441400841927603861583192102731226173167617825059412028926894275320284343551972572050415925766565714935879278424220898509569077649839968119206574113381255867168425968110965769370919008296746266832141446987854977542498994761568041882513010533454322841794099662944683419179196448885202794351082812434936906849829033343040227606196805257236633060915614867463855812619191826650299940548363","143839365560547375531023378047906849290236485584290854645292746332346948078120004748990998995100566270161902694237627353193561420691487372543918026938848726402382935217535309369450249796668383220130696741130887536660931274990226538596539648026353431307364795180640012194807695647948572450669900804784561890891346783157696889227740698390137587468682158498445164238527543293154825313933979177011209411141647771439213541854373267066449465619771302939728669482344435742449155910112100413290274037082987220021523570319476373329663360879220497593805026514769888845184636088191788273729715313793840796269620359578867736878355481914642871870600590197887221724494975289267036752109640541668987594674926645653064241819418461238694321858461339776386118321791148805379738664451063439606517225912084013342260113854580418889997593194308991551987906809327839510159356625912449289525500700225502823479787443640364041882983338027008263905624457174658528970740046043490455140569517396206333763252290763789244072506197786385055445617629016239596656785664720999394862939235491913090740433674650088393330283335011023936463579732716672602765013006557769334877289053104481436966400836209864251595137105026851428904215163218987322112434551910650196480870066"},"83588821119009543077577463624029825160833977350080416493095718503748877076075635977894744735544329315526563350952368189842153459329775128089721089170784472201456432167683947241802692493164203633153956081219619487136306917466304757768882216030054535473628944233322546480816709957147590426274962721652684237820883028380706305692085435904936426650123557226154656011024979262705469136570195174612047531392471076770262460448492801331090286402626419141947455597810644535681319987619263758595532194330875938891937370263553557320323751611907792536576435539720577960254768455276855358319883004916969910321545783642566680627114745838213573191323637550956823859932352596700912024189838814629548631691329693369055326969607995722163330172924805311443703118512620206910538082813147468669488061279472536936587571008200450587244082785538281753483670304921597397778463477104465288022935415426801390045940050202861578604471881231576556633422775197967273314103445039425967527797513311078968081488555134651055271482510302339695306084821186798203226568288403952838171720707055888585287972917854992631897920452508672583545765196342830072958024270830909413467889925206827270646145441947433954090341919272691650018071787797195500359587434462539025767597240","187576273062285966777675742668072419530029384870822421053450914858369527428538918151290169105787598534789454522899137315308044199306565065014225097790750444102324563493859013066464758627871689357031207810633272031438067851790639057635871564431919224755299188281286626518866662190596322089960132592676385625964978640352450318569668118436981911008565043383823553434369141005191093917437464483633190713701819768598825557648736200862629291357213574066862058484751162264489628727841732667744176313576833233127823220756041036078482471571369583802899238344080759663986079017835156371631620478635209710382926555932942295792309574712339400938554269471423423082892027600296690907165261198141734318237915526502867429071406043981191171155279407601212188212858605300920971257942437115297526749153879823115138678174490624221135921275427197200595897301823352269097000179848754264626806899392792307660079427606029160382355089233991415653454278809302556489946750882007373927638871382306662090881757198830513460582150060103778260775960824738538997970775328389862119697968962811643601023308347604242429779923831183477749218703021091749406418190131123586913180305130674297931176306552055672047153158806466258122730940152551784468442847274843788883801706", libgDir, gFunctionName);

	SecureInt prime[n+1];
	for (int i = 0 ; i < n+1 ; i++) 
        	prime[i] = SecureInt("185040996604681628112362676389723103276448631632801933958936695422344185691664492221708348941954684700784278559201922288368737335526775619995684456867641252028637827213879707956788072180523949667859300006057909978349697587645964671957426693427057828237321824240136843102860167302616128466130199671008378552311888628094146428366370571909706435156670247613375456156374676989469230608712698912404945164676944446314893013922346659978320201020658497621206341780270777029374625389553757988419078825703188195481108728425121119188061197337893004495198553842049614640206495346628269469264511627756581470050394785796709132712986266212974593337908054746370454639990009177969652726744960787971938290754783471083132781015199738970693957184936813440348069272423510823678412995460930503807290313686063809680048161306765198343808214022237848434627928223924860779576901392241586821611387613956762372690378274798413515645704655609846269167510301600141782662102636526374794892043557545126328140038107061323509658341217505085949462173632570630031134963712644923768209874826075201183181213780849153869466448470869748319870323119107300386117314955356567209004955897610282704240402318681135422598673958360412045095905345857259612343699380020890700139256105",cs);

	for (int p = 2; p*p < n+1 ; p++)
	{
		for (int i = 2*p; i < n+1 ; i += p)	// Update all multiples of p
			prime[i] = SecureInt("160214428903496187190829515899964616579210513718791417868765109933205789306512010690292892324775460576523467933177254572566726812680706949881081830112706528504063091933658250417132111388363783116276719222466508483157375073570176729155478997619030659341084164003350902734346091351561937063701443206218178411710003550635925023636105819990362810451187079978946627445591673974276099703190720946293792330610625874462325854881082025959942269954051144477738985441118775904640530987067116027093991140991268646188329522230075497094316818628980387421684874321946746398629238278148140473485074675785688365393242566905665874864659985193739724994556931246684445730083559563618858544933102872134019521919267804269110136426189029531660679046722293989477166137769594981430598837112190737601317337630132894296400930702856487493889284475145984670933052106109231643242428290131400622562255012933557143893644903163472707599208806695160805012417734228332458243565061096503344631488632705065680109248739128205678075059893674163300376357735483212426452591468609660287272564220724937632447223455939368256123509504078048780425058229788001916564829335049297978699050891104060236441315530581407253049748780671043254234253131347011771279201837266193859734967040",cs);
	}

	SecureInt pe = SecureInt("76531859873986767970005568385628772857016224545332989020870980200099370282868204955925722490706882912253239409284542047767620827662968217580516101288490596082033075709113802671469423515145102261861354666582657107830285496500551067562536979167247763986078516607306430709543245133149505440016842207108945981264127031499458713727949858369699245406419087452169040599019968355203425993674668772620121380758938827733779140673367227328107661270072475288919864356623314365339062951119162670623742269441803941003988485160299381975950708716464995617267985779034754109388413496588762284515492468560244871643904602026148484195243494872495718579141156692314225097794914187101857986315158523959659207962729255671643413193481640749601892814497212262235613884997889945855202451520210162783246239339103972824914321133895013578561270021728741470341786555317944606484457568166762770200618924909485187588166359946524681364891707065585411215231993107974857257347524389615266505879142653852760931029908532484816981474489924247875107671957586378477012555727799286411757245944755607462425889914218194047077497190457585856107118448751065904255610205486445488461644060490464155344638897963495939691751077245093264882835859033039575770937577226661162957872163",cs);
	for (int p = 2; p < n+1; p++, ++pe) // Print all prime numbers
	{
		cout << (pe * prime[p]).str() << " ";
	}
	cout << "\n";
}

int main(void)
{
	int n = 30;
	sieveOfEratosthenes(n);

	return 0;
}
