#include <iostream>
#include "../../src/e3extensions/secureint.h"

using namespace std;

string libgDir = "./libg.so";
string gFunctionName = "libg";

/********************************************************
** Create a boolean array "prime[0..n]" and initialize
** all entries it as true. A value in prime[i] will
** finally be false if i is Not a prime, else true.
********************************************************/

void sieveOfEratosthenes(int n) {
	Cryptosystem cs("88799716013562609469431062597939663863908568239012044783114954144157214236289877834845245235848040146563415647987270666681557235997503338678013761266710923978236475649053161091642570703416785416603396919674450144421361254439023547518296951822223214342266454608011114467053392547417347361827405353487754071617",32,"6932513433565494694365145029143166378301977897339772884512498952278963341444236372836677473414043843548087877573532201785172858365577399267167224208264234174949118308336037413685441315803893898169110887486631308223027170582643061905042594481388656077978831115410915935393717714354744264538582624752175080850723132590014144226582293323591493564292478926070224913360357578077230987145012820930517219768799822425190854422156660373104707663322324390208192868461016703280395954756148648573094954374021766702528009008438267052159861743641642321400827765214061714576340289317554535815342518611733669891605224056426520979115",{"3359255386329630606736923138649155740855044031831936440689200290842890761503310994529038325380803567632334634440350656900300674708922153893579831516514547094949370697493954016208715476003889700622539121992492387351471474930132487854569200005211325291700636951418139719305348994681380706599312766951742832498502292853833513548976289154464474236268440065300733493335756992117476515868096402509096781516148199736139586616920466537047487524509384398232882615803719181655879045796755470628275965531392125346565972420681530228669726741326821087935075096963534863005716941955964271706909055753333697464195633376251917743154","7348203807501833588113091352050586618844417570239496510352021518982904188805690753695073549980935539120546870700099930228426484171709688139486163152070702700573623863656394331955393345416448755874115566621525722269545390343440517202227603788522452393938673371772912815973733514700556338753879679563828857441498658586664877325869417527844173258011977173283932443827974626140582280631570645553948431702805408658629370881929095086254943658375283982449789565070804449641779580452501356816384795442350571462563681409354879021324286043474507908283252992987392366395650290044283636151955688229372629764419366399811454803701","1846814788747501982918512924416518545830509162031357645219715749001530096491511496438026596628469530552503351136610948575397706138116573859198623031562770443001043870120749544214549482622482534357630892310551509246440784933918683256039569456829178716006199828453618318717686258159515384824593488339081290192540842115523249680314551363131524877015363222112068776055172506306272828934188913306211288284250266069241104259187224918244821002558215778373495771571726973029279673764902830301815097147657260690068938728028353135680944673137709213008413619441931394647932040830713125171789762100107305657073529879798851473849","6983617538968041314596501686613931182553958401271363766518597524766815971086422611837370611273706337272315100333919599343488787521848704412586043844463067558047662310975473099633313043305879466750887123948038875704501538296303349143543235219538722059595756854679177438133157044684598280259219889811802042271364265789968263405405639270632772563579303022398443366598113571604565609937331143298289164792323271765145861656578011865547044654639649567819990054342521997829697746108366685393674436557226693282700620917079365181002945350685182246903919828472036397607902043019432718533509700164310059174066313556788874450804","3285066150893915760929216459434430530568985462241142380386799214419939438329380699988824430121920108525027379634036248870031645136434327525231683515811479075496190944732026033170949565735511239955969139476199769290824732156232941119926760501180475533188889217667878013626570061417992096594743807014788686168523157422061148786764596576772929763503767357467956515574716257091290377336397745938684137609319977451815618521852510185039591180505095018418876540610800695863275315378584974352033128376468922094418007815205936257561769118422639422035366879965372539162891173231788654380003641762015277590688967348628803543382","6096152435784577537018043509293853129411669025867968292672467031055861028524866785267379966643824856674152642341193098922028946834246177754809737525144296434084310135519380430202408490640759158737447330217749950418905062115220574171476932535183764166473012921902782245911038856406012897375665720145353880255595851424067900782974529169329530104907954304084912866031188606336407683391125466879267099169089883297658272673287572285694715673293223536169142477183467441955033488346900971467907682523579418301931982317584161664865367645659316383408298945347997684419143876612416614273116558279033736689362229061909997301404","2966765837208977924458764734189703601360026176079091148083663852218567105621743116779030946553648649065038262058319019160571333526528416422780055254871910076693706339247412454473750064830246478820143737680916136849707580335076301341510835748999061973904262233347395409199125531319050567098922944504816083584189825829254423814608108587132925315419576650515699046622396792380146483519627173890336177832032775622608339091316380129551324296533541777471277757184923260940435681278426019306747838347327979778660247638617980783845060310805714345774840696506123075277350459999927492862070948838655853968165174264805012851314","6213182654741199779781325225790213429010217869976928799671937320703188631916961319374146060887132420126460571668990120787895318361195487929795865605478879609478108060820755113990746050177894527114538917966798265965369695294319325408413595815844991836998835427773334465260245696645630648289392711990234904167965736776291492737449882650281075212314889350341083519541268397151086241801357574669343091376098296116178839755374749875106704695931185493556645150227326603871929248111203275503600428059774015432219059446269983986552447316193839147243882131044484634932268651235520822345284100278531213645419125097651130270861","4546545469312879346369467720863991800324517914245321555499184088700800577783717408747407754082239374071751923830651052390105968480617669223010530413360535152886165099256754543453960162682223807493656680252770207446301128307255980314839601974706913141719548886566242803065551592620347670306612253640009893235431770006527257798137280299289539302551947047735634233666105348971023685327789122595178565257842554200699283751713108388129014097853108051739673748753843236227759504213456293306829631402862424982632922189890221878000240087914959796772742802993584686624107466174942981557119630176326688609740836138552168946066","4382753514445374645262106364488337359169811370804154694446645784834773886742260715573260878306054135541286210749481975820777264773570730368113741866847168288210637822882574157765580999096218714960283057006035350244314336481892791934376986739196334879760896481152285671187413405750358985647421481171459439940618920946728630340346103291045177640721188153535283461305778816977599141123273127711625379425666795828252034048576866741000091573492143574557142071560713603829196099970152165615204390145049154235490561656807688081263041696962353263253813741184836485303336367789848809372173208684710437789433374034769102398990","7447146536155281791147650055859997887391935973113083876857540492573414314580921821826417789625426604883357485411916219010014850281698276715444975279961837953398342840458362365048901035622142138439990225776611717309042996911515240684865703160101533863390339920728232596969628077415280763678095035701068516964172873696146503207872212056835153026428896273579751647287911055322544493970210660449460267493377633159674666284837335763976587919720744232082637572260640012109246359442821379947152931922191159558091803805762827448936963063626566996100821705656604085431754133544732692025147062965020010280125918665847813459645","403662245259124950194557292575613574205743556215789570255195183281295752092951566700938905108621983884345707605644646989720592020756116395111967224797166740261877178792182696532578289001053907200446253217649320115869404225429556800352295948206167603097559367124851091859610220786244022289212040091159478596383439612594539326798901306625206767831094263992944094490929596132255813605417916564047877874158454712460584838096098205271523354375146497043772151126743081437139026765491974356206612689619392338435361305791170827806488742167135041378295333443756034457031148141088117407331628966908037860858945307719019625663","7817580249792044721616465231660706532294902064053489153392974543759032708931695136405559969393548620368521708944568289933185205317503044565270737748668454994204989656378909371699257708550616694874686897420966565411864188246769088153377458974573178073277165705273190676594337307120754627980458548418696509437516884859621188442066170130931914097767289327045892745045346855843690796417790673944782912482964256353627116837411255273416037042806647359043074224804510226261348387617230525865579542323799819343533718046859408872099438611703943780319989054801142291605327227690249684942220080954464916373018251824104139605177","218357084605447342857429979720875649405576646004661196742482742503960875539320547390260832778998858433697397406978495862828932875725307176506997760960863398095078439756334719578536956017470117561975458800136603902361409049536505040092165070945692786462318194292857840927211960069951021435267872597630126062483959886740903249047786646581404802059169733285011017187628455235109738294486105335579128568815267047979305309652756049685127741522565235023967568062138369131615606951756013437621817773627473717492756789415601129395473738054622736755178104778038696027090526931074681631996064392360561284374912560682949475404","971180265947479558199150905851796059153859969868832599785861491238133829021670520321458554996572120264281724633231366877360085250112980634013286932213404017545409445733767885904493774707065242274181972660719372965180873883586550734152111297966585347793413624873228891942641781966613301848052200723511050328604855432311338872751458784531734922965419625058410885639673207664903522738147241244095847536000209896695945075111192854945121957746248952528631640759604104107601389346131602897157035742672551169778216483605624575885250322168008848241250651097380227226227819190110397086783611319533043550475113851145591512813","4717087539030124373927098815653635157214948368909799708130296491733700448361467412746539722934817918072625626572464661401965569441673112744943309194284025172589614690263085953043587866228676974105295516268205344613820283951967783922187568929799617672574579256143483546418363683044519005516132681356679094476308571207912689267275309749980193570947302731547424307829838244339474565331610245154957590669817269703775750923554098583862662695167520556525194201864877933773890860318122894057166941641626739710481041836040190985340505729269895031363517388272111065557206145567122237984631509842518190998518659369006418913321","7031953649381925882478973885895049704896649828811647998545027116575792167915172918690049637928498539754736335037382806660279045587686034185660687484466605905268200756229357062300642537479530479192888848613899038657353299303309677677654279447509190989821363910317079714056467579223605829579604811273052717993645144743121300005686113700647616824279366948605990030619823599405802691539987370606870178113219195998978739225668294396957221381321637802120238495027955840745154244241084684643543694894275089502980964725262875587975619021746044634509836458182298362131083824996566658075003825609515236637557863343116979240341","5686179854629437504274985798984982122844100980514775704013529166212424245147331756011096323055451153972935017961472564808859782728168311912451840054432173273754421686539428336576177042792264553584470840591310405125455893417046981243997211929365771023018403611177910010569128815688976886094938907357635136241583944140597784809136491434039080222051029040326525452712905057879047089389062940112460917347144226840970041122172219721575116933070947035043707280850541887717344794529916446042591690557582144848779578339770755542518549911744552880745683211070340697380771109509665514288719744806853985759071570680363375639344","4885663971221728164645954041679768583738677821181484241843926891412258703071669584822954576581676473089160828591114514183784886670672980451687935261098910946187551861645428858742029032391316222087867788416788190050477886856618340052613321160951660728079719356084881371779364550207282115236208743637612327255288319243242537966419347652432463180192758834518326329274193194377464965804559717265565138509412926804472439710455653839696303390072830922646646796239772611264462895512156442570129343325037910399985053248226707607291104944844919550675861441426827234071424721419884553545485816272761156804715646950034728316658","1667377898823040833201668823203512729460355170884325808643945109357087352431327488523034048665408541653369843986712855831438852372139495496451214695250360183969763753400077140191656492214630765941881512957292272538921782689941620199006268207864116078538453581157598439985120709894887449412015009406489996438451428260055183488174514017767079914608152416941101734289194421397148016725342258346409512166759057575969100415743092429187143052197085304749840075647139101278996503187605967574100303898256261711355831025202742043017819375966555127872345631505255201481187024002660139351591664043572635052021906025027020692370","3834259295136352968771767721263340485034164130539679259630966976365382748597964539353154222530508072461364989323848636597619707882804720417549088615718594438308673325177380273651352468919197663361668740785158787592047679092145054782203006712869282672408826185820867684689368756994148551811978394699323095373782614864201203611114969585573227509923260593587021176081914616061719603397228368585436318914423617705140604511001099517230248173474432693665016365671056383271052925775335685214003501789134471345470968577031134908793604370017483039879049616635358871823898190511248872701649663271517514421662001346500661583927","5947257290172711049904388833719883496386760340185767429034447326907781898712624031120740783264118502343107682659854987124781245160225546253442182943889403826263105049475704009922917784502171342763068997093692689431172602585640772851665197812110220611144657917767831135468888013312959234324307280322066366439096480634176902658277607774606868648884588150846859119689559206438008145068425007144887633379253582162921539259048687482971746309788771802115995958642725960686016560741768447468252578765809411730185720582300969963156870568964823301006939222547891557496109447645494865675563930856897946404912197544320521254884","4892146425728593246760398453955389229893834187635808609473074551549384977262225143574253275227013430284181915283369424114336533989396423001115840893178874671248681903508095072485218242480250815679587997532403559786074545790023924522427097222888455364288679573322937004449743083230162936215336998515735250518670354841568520537049300620885490737466759538010710041164642224507845912741359145092859028868589530747745280492571624045086464593776867283182931953514838386497001434701516212631767096996621337698044731262524765509307745125057947510873954919454450257643705115775106766503194711294888066113008981315535039708601","6636456429715056930193279192028968819333541175233149160207141837057579719599994784529374502513200393347495396067171374734620282677283534743401545828508751222441490294686515725590757582739949143652300638693307295106231801478364131077003687436902823803158275033318091135930756021859743979471604703229063692488125888846311295763556372326811488301767669618366254257433481809844486948075668149440600663382353078105026121372668939684092796519627497246623227436593302222038841168941680374817349561366280478237725376132516111022158812857773567042745514558752379601211893039838933611878539528192407404650048429392168101135202","4988942880540883726664871880164904442266920376775127707821933280447996856176771544309558486260525961294440524182887165311618930892940598111978480703362919988586440008912198031318021285441397353473832727397218978225465488123824890034807540790357524752393244113572873355842446861211167134263198863281353023704461176711691598034498990962608927843546195966397739044524547732783530548385378062009789711309088299152850114043688125897225312167195998386417844829088474303244492144554754283984451131162293891559063771766153903427312599036555094491873689084372009163789640772336222107288198630575317883450748385511941406340672","928094207361764921807974438444329857777046138046941325563238079645842259426961613384923919971310054503812307103482296985102362722161709737168720684219410691290719815639042560150965277735169926351487850955896904897508652058294989514659749794769719154982076707719452643555064223053425059359987889496246150645500393753752412873968169363322279693561758514917124353626071016131478897843253383212848852853645877402354296688188950617022286724803003651781481201050832315244517124386337248018055227892737046133532589349863939372801590537234830705920347881692723495834278856761870440577422369710838349009062744794783385779050","5073891138401043430819160263019021846786196652207260553930363987081569675108999121170700544064917239731284008221764092048069620644279262695241705035828529602604707979140556916800544248060056842657189980183866086101282105700728192667218061328762121580342810324324354687543741781402640540886206444993702555371171779582715495803980495348273518979178305280514142366707096268495304483111831537845456363023441735048062635762341190483799447527478980998969264725205206895296236929487703721474134970557632415326848813321963604928848933266568238421842291752175830330471235539251500631813865977277285032695095499952420341125227","3652897161209178614496983008167535311916110368764604441157145994752960375659536726691855822467396783234667500133035443154806564816251411266005680263921788317206090488022393668784456054281559691287510399619743087967296976424553398125844105644196975990581716611788073127424980317215236367690144726449000443726079693200003645205283974666840861454535889010103950430041734821652301891586302853349548163836587077840583661395431414410706676294698265738620984713074202336257440471588033672191348193372829941513681119347112204475960208898746596651082786331397803164736158589052673973147212860395288920275582052238072137939240","7468352012120699298424520998975170854408890439743850088689960160377757222864051881268939149468763022135052358650063430631153194945781656986173292669208577502057574198163747177582144768798840568264038040283094381120930638076362968188065497457497343075058128960753174920833342805725570565212224332286474812337835195374120658186838461935086517117295681753353320159972177129706957285317973055109080485174867725096696054802852722662189108984051579593630859785351363035605277472576397630412010283294610417555874605184614540359064657789460282008999719884077314705536384608659581160937766463883613455840806182879124109117963","6220559438264768999385915944460102868757771692120650215158762739874350016053108434060799230656121775697443636342813995007600378570102689825629488548575606261472658400186734652813225711864123919690940809708219686833880980571108124028574915958548557734380028482571089279693096759758297879719385519117386665382185227472841479539827288392627592954594520863947788548621867686862066895484609729501373683612017181587410809247121110720345518961791520239139815842082144319132482073655741376479735429896118282577021655239688825623784972165740523216979307630315799991025623239896131001510805420605785587858057679533049058056980","6450566870622800208767049633879271051581224616944429953032325328636037106413260742133817467375033624734147944568280689271298560552994171139603170050470171858609433851480730567277148746799520804832792008175202187574091986116862470330490901437521769519461422436935932461755998652789457547488985353974945931250938506302419473930261516202328726930072701546626883817719738470947552744663476020892473609238602625372723553679578986349900468017531935511720739869687793891109901474101057044767504603133087669655439569674715979234070605086449393419553435077712741050294056172859736146179991613046363017076079629028731520423894","6935841004544372711065914931563982422455898061084946946607786477338485760401505888142444936581313594168959372157254855237396105284386536086418109357351355922156641602181906388574779540765730628793819833341342433600823956048636166596043258572487608008972581264533504926374822320486735733711022637368953412159769749031992859982722876378119790129519282209729327876119773362378001393596020060471003830046537950745725917049017374028963887042439518186622170178698387945220080691006779090763988338146086420211005596713384382477795046804913339725295010033794507179362753918548360167320394825628931652207672835548163803503798","3535098006134383873550122763124854324689424525039102870510028012278265133935344056589594470694224022402640276487594788268788139078927196250122739615449217542281218811458501581394017371851908416170747241149344219766146137534563052485284395931190480000117262692802579100971021025490515737964644531478106049890891435591432876668008392770631015076065996791463964810532372291742921178226486374033086952799856947950556592802899516204069391675579105889810281200340636643779576206601430883334629320776639267461025910674040551810029126243642535335777169372542535006940847084829628336768177106681338627139981254585881741965395"},"6271593013923883341241544975952922647106928300015714424487845422829023066342558421815663890819020132893757629151334724289229869012236590672237279985302421588506168636115912878726304573876691733072780107820012147407818928962705308536803209100602730537873533540045768923458796186526085186007117916291172902538400124532671985758951000935585192610086309911501137579562260334012321452710047873897207473535520173081190185149580027360862867712224774715383222372243319676253145947481800312321242011332052615738832850954518625164338820298093169302411553986606621635531197365735789325335898944590946143127956101360190306382846","4789313079649696579569505589273194598346363308153369922697123213699816383235188716941049236898834841323332814913245533471414282619111549870932426476385057035782706018097829414558185346791478713088582255356782770316985363163280739483593208990677742597985058550443010566343430977520302471238005392963836482948791761568197782086162389028274308838816896383596208965689827612418239592168274305522824036446123340479028839077462681721178516029902630227908030665156668333207954561394592767971185217865421236007206462221520028533312372628163955352491685637257153498333496984442560004062361496705809174089683569027161653362459", libgDir, gFunctionName);

	SecureInt prime[n+1];
	for (int i = 0 ; i < n+1 ; i++) 
        	prime[i] = SecureInt("7370762528527888934213201518236823283500027310679592544350130382613199709758037404324489920530185814534559070911551932102340604264313992415732601097802104010883729156737807408773818746483863523240904227866964424950629307402606360693867530001094138242697804964114926681300250669056791679562546020967329651557572037004952956700635555383274075531369741840267045381336035709696703190821612965813545238969176707803691249908455456308429874919241519709985493860958518355373891741987187594096509103811162361285510735821920360501754035753356203188706609803184086074372988432967837630575902881966226946453988217850879356666150",cs);

	for (int p = 2; p*p < n+1 ; p++)
	{
		for (int i = 2*p; i < n+1 ; i += p)	// Update all multiples of p
			prime[i] = SecureInt("4153357809338758420042805135185021208244432495538949682405885825172513956675016457637358249898897377894061228369740036543976835618771711173409139052050950771118588478507926579643816343758196304509458201755169159878505728593373898063524743684506709380004252934802808951297274764237447293734903331173113748107039384842837256503758175930712327474426837672255831617169576712825704065096274068484598969620562502127816280965564911143370171618471345100266430611064073209434835365238247001738582507716800878130683252417162411459778507522644322895258455175043499937557346207111505012123724490160254322848904640452845364169713",cs);
	}

	SecureInt pe = SecureInt("4284712850348752014104677705326705375866969224995214209775584089477255635751812682057440910211031772532263673918518174905354581321972008639584045979384526614851655555632656890172680135049669917699919437235333356550372868330758252294594036180298568500021177080184224963021025483782777559772570622968036057194331430601863717537001668226256580383104272565416422602989839805714979656302974862547519554930076905716772545186028117959161653897184672447466495421295793260786452356359657308243356258950627720763788704161857221312614697529479127727605787973989274960564043853038853487821434003914137625350249210248258238136510",cs);
	for (int p = 2; p < n+1; p++, ++pe) // Print all prime numbers
	{
		cout << (pe * prime[p]).str() << " ";
	}
	cout << "\n";
}

int main(void)
{
	int n = 30;
	sieveOfEratosthenes(n);

	return 0;
}
