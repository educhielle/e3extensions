#include <iostream>
#include "../../src/e3extensions/secureint.h"

using namespace std;

string libgDir = "./libg.so";
string gFunctionName = "libg";

/********************************************************
** Create a boolean array "prime[0..n]" and initialize
** all entries it as true. A value in prime[i] will
** finally be false if i is Not a prime, else true.
********************************************************/

void sieveOfEratosthenes(int n) {
	Cryptosystem cs("19137170644005198837599327260910417534567761387827544759051010191280528368030976977666889770135428529458412266254640495815836766071671889838799685492263351184720949300615617635931392759666770659302756112821034332943587224950113051725626979348058399293218288718703583290236568295157281817777756886027042612113023838429551283887011389267597938811935099346638549228923853565263618150604614086321403078642111224360031126536567092718224469603695283395626794816534567515392556897141432054647195547704197569928954462567018087909530917609497198848842967809173426108620550516787864764398460688339889239973119576336815337717957",16,"54158827042820468862520867375152123262564353412421971031753833097808939898391360116546794942053113476966959935074845162468435400985513241922295747052716978031504893203558022346829299872434946299912520457234844672266438633644745097363578882202884410558715762499484910250370031796593353156376500322837097507922458304196705793832819448864077802078365444557670716632488374603577164246541659826536598340459700438901613938015575113940297374729674049982004024649699347526933011733855655455409632869669509923532873890516965142396951944064986751808571562077324077478081293646615320613976534947118890841470292060414911913307154062842766377436588139252461164670184719072012258457489396523320878680395923083022170258005644770889433078230600553058613480048323146703103908439384745862820596826542311229692349504751757592504204705025475363776882325550253701277774926994486281723485389059484707555550395643098191992712806904173753127902728635007076493394476071024103744267779249368271598077426180016259557601003609820993286741985046266067095203306016747213285690136716156835493276649052911068677662238082566224903802392796704509211018239138558141247860020904639076162688448871096966490474779920695394427658996743011485554231211825738023620703075937",{"254070826235951831469046473656862687600092677242687836046227357668792532243111886716565492770104214193049308259211995658351564825010421895680079325393165737541903574223190959795757501152869176104252956590829364900904067517654966204351228717989220865356434257074071205568740665264089332753179177652548919414587747171746116915390844647610283112559651142381198406904803747430490448337407170492611007895538398268922637755514432932850979930689493762058924534175726780809756957441605833279681511899757419719011306067626388197893719979338866320179987975076818934485718256857843248500793797611668479329857317294523732237574169632463129975625100401625078972973461976520273635903197116035762226015755480893192485770987457301542267511576671312551631784934079915352494925045086946099957704503359707019603291409883325970193832737694404853066720427725205904240712600818819725866569540212150356457813045668652480592534483579681422101771661088428821102237323915727130888127814399559619326253432199645125245222498409535675803787217044392783862598157144214152135807205957038527937379092648732671053119251001110975221299536528062947230051631366023972002826858583649074785969755483235951792425128831117728998036885222348658532957510458894335970881038771","335019985003140367681413116866313315008388849711994648469838606842330499542373955689699006817819251966227629077198275069628806483625490503119677823039594107657331010383035741650032958204476542466900499542355147412573770704661453871743236251109392174377443478202067437074711066651415961560802948247921939276873264658951630631859581465776833862922566212342332377859973427786987774212597877658780432007262283363446127377817671711076674203090806614639037118830830266291789630261617040632357284109313136487966025894519176694247182434594416090992537894970364131733825908495423670181730638370682111628021615725229430821667270771524869300363916700690441252194852877551817894375148121372146449034554835755781647711606607017295896100388132357618200254415558592267059226930584041415056730181301652900163605815786386901186729236889176346461801269279661241231337632700023214346773315581900859651553898752985000493927758619527309213997779496807114494233331653252909717795239701717422973052181845471047372112180533260774257909718839105784791711260474983176656716192867527200745561882663643318732683111992480433743626842690946259989128100335030257318783280411374905184666292798371838578420473915424422451678052034455764615943878336578126960079141990","87725414931487478926064539987230388351051566414436036116354493066071583981820510812517726892880441262559611023253548477721589472579698063024526316416804900571383519654880864241358638327365772202300884561651153082036645947002263580241096488822322746926046302139064099403172450087793631207169866329252063177450754875091565424130548298952120689410383175389752626416891068570051714487603697079276560191613080031258832602294229895364900115169763979607459293602669398190395700487262701567772486197014701472084162200316763189607999565890268022449697384080068670031172625139106209687203892840597190437455726919853105905867087638710814388393615644252525387495171741505546603455474044613564456120935258409922013305989729527576312645536182255819788604257436735051115385470231436902702747521227685221721315433216148153541612454259076766557683948125083570794080486016685010861374309145234576573758682642332153331709844298215328902666961872803511886276620299356544681236910228318710555050816689108857760469994832242061054740439104514806372836494747900518638970265792209746928814584499336853813294444985023690824007766799318602866671161466071107338101716731495119387196016838241624146247952955762482127181846308030486550492109446744786566408150619","333696607620440902190654359138977664550975435247207655944651855602777812681590659546802859462480873537829644071880789912466020643790237560750517185810399194843573200025009691956794670875820537893440290474318861318864937858599512777751345117913802167586791131008447641073727560203923532468432014028868653034782626168212036015462935925113805194442244317814268225822813444631636574331647155342589357459005064119703686191362863864485602093652270578483308748292378635305105407029212864777375916579319602818876824406381978573983609241330463153504877336696480667637225451316165985330723407267495384360596816109891556428247501862260910130679338063676193232832485994930898198791692232347748922027736150498123154368424557303551187383942061457009789875186724873112682764483037930872706817091249685565644592487476257730701404678810538154373690807119820863851486091175603475891655470641975563543339550333902062979950393930584560141038549446528303079156459466828551486331601632157773227114553765580906893644718930576215419320039677451727928918238773392572477014407036950714399684029054697133374659178667768845394631930997630460037632235744973107868471316891326383539426888276930082625972284059155478843850368596444408670344445218887591575039198931","304878420364043162415701445856130576878968697350111561937593615557994400113175720376534951669138620318482832576244264869573332172756437676473480889800760751027269413446537080235998115014107294747296911658139677692830616620387876199104213184952464226078838565298703005758504507769088295708007592245968111117479526164831614136687100297807141916422909632180690974733782796021146624125134040809860044809101999108733701285803873651745241630164770388063340315485725330945385055966711662380727856324908175346012266224110262798129295437879521389542381415442938862223272407971689248685208859202894917582354626873897681284430308125500616609868085575110195464280303115683609730704667627230109366004013194614965339024827896751884487363448157137955094201335184101353567862847536859453317843470892450900482445116135397545408485288979520311474630574086057039858352262728655946517306539879349176957605044691266770902792694428539801602440582797697316969174446155962585659583452022133667053524771520929621704219336788737596983574040700046972127268088438750343266352791897469859982148224506400249111006408454176044236601884572092704072520443316451367246388668381940125677655121253992861825426508933419832256106987928296918197219361139711628680762869284","128555820540048180997807308524201522004664123182401286118389087447157097055763120498637053866316481288724060902942693440242769930523582806124093472152874587636262499158212868861140471476899831174803872389680391222428981075563833537070704294492071334968107729259426057749844952489203750611818153644623018748846226332698196998627826954727086695601499614016639343851387987160824754012647205886550433999145255777645382630902219535904799650998486265389221775734342521991738179432326697253020459825663505625950734994595991651045049353045288532112801842857057900909200468240564345045527602088159571249919276565595832640417360434820346687319834619812385022349317108863923508009865443912988867709071028488115984105217880534028028937705327548556964275282161825729968484754752123568564207742905397757603281195072280846728449943541756710355407861457017104365171483177088456282463725100476310908162688631980498529665268861047359928684105149776241843924722771506707282025243134030003640927870625760159032279406763479706175189657996898634787799049547926944104135214379714410986469623465927433687151192052154907103073022073370406407561703567793759340747249357998533517099865604087723405280968145312316930852387081174772682473279917046002276367183076","181185359001945519502386689558710819406341687049231057919202913541692201534968649692994301389514983509593107418084943790426095690445901762687335995296718068463249279244726195756778790910061485539533841250776116682153954980795093030956448754485960779822150510444117425588209075098485177560778168059702604060823290419337918503189967399744929939749838686316658511942382531939222728511161814931347584916991495168314585449451374789992321865351213611109111458181349736765585728009978471411959141686879691213815171898373773273146177306553512123155347412301838417436681407450461327443111955208745243751738557172965171670910506430928398847397367502644559014550872514485564084951514776774610158279536974508320822437550824560273183246780427244518887533888021459489901168686192689986126548510361575289896114850164652083000792973608261174408558709641907212050624639789274848720746886767831578760662326760998043854402747698393136590203008168128963057580149321006370651646952473505274143677933045846211708836758963216139820668618098133468413630182126976769263912158069239816059942466337787631384204913960649797371377412435938706823963721024357895339905570219978867705058711552235897167793555372538570649851179869676792371173812739289225705813448719","5903556783613052594952818568761729320711756842324713734716412855636603187187924293907743433932328171347164550496239400602929426592767122879545536241186685511460624427709956514539278726214745168861267514631438185721316794612405917150701795211821370885784124984269455505391669307934000155542059566668029513294893203028238945735673348046625668762125762162522976734643891307359945351716970863367494596861007961378215574850148769606673191470890188944993041293648437810826884797969159639513693991307263462872411043438821631624573820512569165644695902340229133425450172675270661637063752326406280708759111897208662686741282712897569195336735372172079454568594841972371588661483790908782698267362819782150324499049968531792759501043615783222758773342111721020356766938080386991106686155097784305946802137163817689355136973373383956240418100147350382983036205178776241198242107071073539274404901419021072668684642477896165260696025618426837953195546312279030111241589970267061933688167774412227499808475106685325673760615835943091495316179336388895053514326682120314386135059622533199971497765898045943071446337106061782203758242374257010190989483882541941967729911086895539165276731217526423813199345938129001923724600189329508938807424678","259401114983156724341897884442602415284424768323518607621718519987072799781036982551479586450664696980314465493206861464278097273623860556877081967944180117165755876411199127639875698220619275250397451003559041417728602350926172948110932977053537105029014306131751300358364834580916100743214034504113958014473102203829812725769764582813112999342607126114712210263070228347162814990987404539823414216945440968040245987439838083812213856348441864860051317536058207347553593460045187912909819200809655304070368874069756000392100776704047986394527670296787325232220209074174313790637340228045723007057825938315472459006370872976687619052483654140790965732207311360062898660333160189558517639366793428151933233261404885671099494318938179063015966470465934408043239396933170631092506650873785557810211745892120946886722011402911244063655899108868227882229711616256087478581131142810316154927508992689548102738993707806231990965212096355547815078265646974302306211602835756993059439570242528943964185683648125050918979473900722269523070793248904784187450173921829587475115077394001793194301933242022682974492601162605677517448666198935342948418195582288844169187885470761359517906034138178020326967845626878763815098672172729172384493460498","14002649330610001873312322676484459192409193663700526860953943589465644317243915554846137744200167368176814004303818045119434780785296728292475773527776563140482171836257450011116629710066911570809039586052867819649981334084892985256320488000929132523158948997936267228960171460780456636743182240282582417600676496850064180332582443202766352302028885175495481246488118041359495640000347938318597055405060270675701892066373593171083108304758395956723461067594612696717098540078942920992051260405777142361604519922484248979217280303284403762388763776238911300952243990510226936998703764198774940401758129206975593784685380572045516026923151148389735335450055557116980839897800008317319152227087452127601244144250079170131336816188797950342257398088801081001030675598725340559035163859657326605739581400819240966589045882805565142087929098309725085722063996222897825168140170591558779494822082671355336685380910681297590898328012967891118051367385715107173169866217097869430800611042961120829449113939309641969791256580726282042323482843803160248258885401193975837938671553193634843209117841951352922796716094351988559828605115273666620874253218401497884756288927032809149773102385667924379523307272077073259039127366641828309415056680","128143484396437305964766991269816311499982849280383446282547501558045491965597568546817349052960331068243361793223330982861549639873128743115221747955271237147101759450625364166820267249462479392465151077842034088099718786265421313606774534977367735380115394177228724330223615875981264211169530861087637897756572442128655136154836808825984030689088744991426810877379983605382496172921473592312930366949465321219528071223813498322109029323974228162233668582240976875765880628890000234127587531256797567358485589000852093024342483636082552400200440348429507792465260411789520864245525712104373225245759494536688109052041398277738559892868202096792477918748041550730233175539432171963973942646364848128034566204582795663018588250516517689418260630970933250252927058457542382518755458202039884268353928370422708145648713299302872324278516185213666984734322879428902520207570230081081330309207245518775838647220899033428502256213877309761024426917098610693515526275586291049981683592885535070567517745911528352767998846700585314736317841583718312239375088073668375839663436176413246670111856517495037058490281854996808767471647278324965427811463116965560645395929541715340832208703094028023941690794724902798228518232190110253587825747957","264812173761010700572497220178834694404042693773311512275986429899571262111496120552414632791922381111095841256096462000674998558402265785663907082001616130957717264428247332982372839789914079890805320180088668405200760602390444110467336734463974346508011702905645296646184482741220945196902962579276798354190030034452483117772381395712094381860025801543412972973685339678471311764651722418841554337839604843302574267043342839094854976566971336945156477165086585485441112175329643325390258557123265423485501914881785086260289451725980980998727826411731569454324119386263129782557472057434845064461649892780519911063515315669814716959325895700773520826658504484901547954664292574986213169415810569271520578544823581345529135134156031737778972265224678152125840401132763992403149363023341980169465107141383623847409847083140421856637425343676768189571850042442530956845521619048898676550826920352237981157727509008777631888218262491731747099477083045698167525205707254148514642221488363405464182708799636988230538360368143409142102975220300791013047986190820064486876890517010705837863694001754704387693208399212122247041934719258141217720808509123808002149259239164987632091080851316823175807502761256803424461383192940500475586922125","234393994396028631764209230654299230528654492616348146100860292669129753677581465933103034375877509198309258971609965372416039240393646965432734507665226996956087942814020364984906440928295333276108212555611803322173145142478402600903485543809650154551650252941150777962230949617351609140751785930470445723370548172518301602710503762965440071078049923553953220009094243349210057754562038514733332857605556964543135263578818249101728138306775451110961447345011062601338477821719848711162267572408888683247292625980024725988571462194375971322848525289655873331675900854228434859012928272230440552599937898986992246895322992894659850224064213251681306336910464516656936106252084812109926226168018225063423040386164786477882948096008551800869372007401967037436303653675682367385450444339468170312400050006117922076363074086249092128352277070708353628624709567339879051398494542414893767846605403682754914822176861439648458546491629770835404268912445601761912147212116420211740758289493242130291644387231899976570520464229877311397139949427008395966466036410572866813298928888722787641849644237660481500774993031197195076593201146135033274203279440142060804081450684150880031562223569361439169944106815768190948861496105923901530680469509","213175731128666457177563350222325203305170384592768333784336069935511938173683011539328351135350445037110178116733102888925908315021562985877153795502223739021484418675421200271529400444910816259098527066636049079498125425957279303452464722227576461888856749256432469713577144615417910833789122934525463743778521117576293895464287520685801624889741395348101171234635415889183601103507077363566339711267744107615503914291142591922008954965432922652185564569778685479492036543717313419778823698210916348633781335112714700261556473103859521317981769260461739144161067673873746356857556134790147347374301476716703473206373970353381027041899412102433095201799857350444084044261878774257947891876248444803428309884453837660329833270095407428964486755818624860184866382279782391718722614948368652709919254483033815957678322218672563938614995647172670626088692297030153643760496408394867471663353077476519752029989455300287242631911124075662086292982978505235887693759895780149266132449473271679613875987486838163162035512921213271367394892377376395387133080238114630129744677051713266779738267662342479114073481500430635949877764032865560056329510573472398207380832699045532606479563614867569336416149970202034477971594170291157224137173412","182836722556741994560013191646739778572338677181206345724740980908190028215389841786496870897252589365951931755145539387551192364155376000393024264222401359134862700757934814581720710502188608394539409648747883489379835321963815641022069232330518964635695390315899716497460008848378083329888418320893738649874160505008823438693799966485952838919510877105463350170483276786353454214012396133996241522316343993286838045426461479067811064818812983935366217376975182338582165863135932150610425988277705208985484738520664937206004242292638320053358591283292071937244339201466624786537266099129361439716826159417102721516154954024401721673601946263083751875194782791859313412239550012511610304642441849411702111066610236965578549112315082816719566261732308648897040886082584743272148460115449953364795851543860718941221066222187198932065777569565376154331382064291646987367877201638810509054585419774082336750472932444468207661257679745840465643344597391905035832856064268240443604489554431642683570460095614669413337562649283705363135300942431072647119745754227494379958774365271112073687285719443124262885055588034079251261091543287694674918877819923722215830785168642978084432236353817309556608738168893574280889931965619801584123055426","240500203640080539056478589051491027267219895770058470914829686580975476956345089313228620449195347266491124660300307717926409731106067576043015862540509428653737877698684277234873383591460285993186279072564256316521870610053693875559096339584104864178125269479693643215706975804738846143132077184079036787650019175209220340904664519828261929409383159416764738186481202486038511368985900061250875596288640798964081395567672448986795773150803647876675261792515180281716941702755738178233648479901654574582862509684170215332871531861862859960858619016930556799327053435445469937653808784829616163673285105833307071766782395547345637253514224634081046011971350739313898541859059979631587305455089751739771266506952177793513231093864626311082596669957328889501371604105408645926383381911585798666482491145574719623760560889019421459959066207485641575430702724466883441275992999470372742336754327058416490612518421793960409360508531698429492208695658625444901810834710293001824944751788482699698925609518257426820160548238749946674033626872342396814688651381700533595122958935088535659951431796608294447484213482142266618651075767922566115915751197215275642067132291301668601306965722275160822126626207977775799543872889379399273314790138","277501484665178568900599314927022672862000007329057565264595646469596977723897753880752261853490851777940164050946896086405598172304459748682421546697393320566761794890568954110226200411548187198523423880202966872590879569189479519403785003107520826670772362205592384810684856756095036749228280769895433841547534283960118752977092631506193869254270579223088083888378998247610678229319322148052277492265193577451235915594907673494432496205813543100413534110618821010890456812598887361357121753952440196196748898992933148489315181862832944478995025712254970267612560351884180726835541106770943303524175253386502555979011776617434829299220526144189345626289711751285920521975511080580537265380339468497881486813142707940628122810538531197642187502557986718305536553368212276619031519746884886019112817084306454092040756325620971297069962105321690321556415564578606903154637926227668795661199894514056384125522733650288160922583802426185921392456068779133200331084348702096541958758108839879644194691475641676001613254072429801163201932900485286224176663922452559951638639396868849337121112524154665457899064977505649254021769875208408485075223218123607030567337913466866371183612816973536616230520042643345117357545993796644469985336707"},"154170997304910833269257546312998791369309706979240490548570174800261526900166871837597982139631265070528400207346496741362904228972140864745476702184497294187083610328778160004522279066397166973750986707804739136973299548082737187770364112308239539142422803742977837951450352011438898089714371624531152182741746612300279340716824616296599584707949448069868240472975318428344207788772080728953412932659405403794005264915071898265378854530317998877380282965981220260117233287579895377685062266957340332077478341885840035750312387487232913994186117938479268228023388996903024818307664855174311324189770470272794155073601147701222765710578101015676820718379550678647149540375575838529947357122341314552041482175663686543246984481901306190851346215855061478247433375868691045099172628229889807147605888422837074321430384882504964547943978336746489857942986666530143441655683868600821654857880308756918553771472961043042468382495739198135373968338663995158482759189100203488010435836201490298881116526684583590771466063262907777349806490309272815048167489933726494586286655071257946078306957649366127862323764493369478743416465388723195096010368747650464886041987660879525337481704701033045214054494007147759845351579653325120517628132639","358710577251125113878350876541116373640458845565364165446053794480976138762151417325515767386640570517126817518812673978937255785117325778654648221670804453593633619390649353409694262051397112760504015887552442270064029156867717955066900022703776895106406337354223963127150674205639985654978268914635289269704150718515545204224850636751918578590627756382623979821447338523204047208264656439816117783745673548181448174479535841305232733455874316520152986787943469545370791090391025312456484753950220912179788601443656870512867541109929061626811542720848534906422469945203892938843756796581265784427914809010639667895776189857482046702745141718176055848949204608964283960609512111609198079747067098934087903100386547272232085785544770008389760315303747436664956017644447687292485710421084476096335251403042838238773892914057693283620449398794131406985374232218205010979505639281084648756888204644087848817019356882635181182194142320223757895732016639872855233626878606655443035868173772497953470945761505473999485258741728080335212258922769570062960378793261453892640783821906727356451582988000836783673179279087496878711453436355805523705351674589756654082756717015067989535930645775903092063231164671845757436314579591894222838815361", libgDir, gFunctionName);

	SecureInt prime[n+1];
	for (int i = 0 ; i < n+1 ; i++) 
        	prime[i] = SecureInt("55540018302785221564788469459002231807614907025332506634792231669632995183918496705492868636084794331822847648527695855988672732988825214764756355396531179341531697582784795080088922771369690821866277358804176616399898873344599599917850366440539867983159388917258259156090129093886990372819062883856931710068619713810664512643483355569604192156707613720949553733525050644261991115625310430544203845822240949701312651453842641753100218885107203323857212267182243268316272920254489834701666861986668991953480187322584857249977613108329140745366633291636104694988027328514845585552231786792419525134299525517314913419743301070688824226960423441419241411274180292903119747521843880279812456910974807657391843946135922525467289858084051534144349574011347956098309611957361197959245429309258321679287144687102810145203823009722633061831635207003159288762763967626663517026704566513099366911973048668041438730897395810556263793326443032426399611286995749524348908318567082549767489735575778469641632681380415829632991661865079814397760041805650055626284086029402547496110240289358027777965514009645751085321016066106659600580743547736833970909618439280458810659804567217903968701754297329084308831061658674885386642051614925375236756218457",cs);

	for (int p = 2; p*p < n+1 ; p++)
	{
		for (int i = 2*p; i < n+1 ; i += p)	// Update all multiples of p
			prime[i] = SecureInt("44633952367314652051285616609147136573404437777247173123755829250134645279003944436804561174869359390639155813890892790610671132473819777649601241615504193852742021540621841376238923811701000336384274407459690034076118192916003699148920924462970165387977761407198085345815759976937503451019096592001593559340705323137218770440534659385796656608763064620736060791837146566348864411599651757608785719678829232887429335062203593782890197786684968393993526034082588069879799988695024866913831569296400873346307009880305392849696281802465310506329306147496952107755037645844070005717544238651045676472644887104905721029608851327313416521526212941182837684877046316412762401001286950778747037110641142747183200907532802902618387005653029750331858735290135466950055879774851045615239212118533838690688066257711625770703179599847498564083003885865992714971313426718756129456052829357161610797124981529942524041601302202563193317353294769475891812222344403583510760166965721985368055674096540242612982848204218373364025094151973435549157981069933492914098208104442019586855744451515526048830731655813444335318925557378119156234294930016458954473733275182161826244790321598368396401434423511705166952990675781443210592031748871272881507520102",cs);
	}

	SecureInt pe = SecureInt("47105279127176656456910773709129929518883751799799213175293925848553738958521934687189008914212453058758567709661263030977431657423167168444105888917558734352205310429123745852071597976270196907013138791592300325212315723689835609366591555260203466989103627879992312469670987905803686837554269477813424390573048245604730558107711458349367964154202524527673999729179842336885147657618691546045513316354120640390319524883556418514216386906245313299531835672942822090059839190643585239811915763658120601620112690502346969256789387770057386739848847189425740662850724193490032282354925488040472245827943889653799764057158452313716773018999818543324578821071859926186303503647014048076161057424069475151874966509037015204225708391604580828776915482791851672469113787558445512163464018352386955604000526780885665712205714441142607665192366625222685190443174208443155898988718775856465043759867513591884128067944834759241858145181948969294067014754129259799453299332883284884152338035194847216380762966223148097625097439342080850158547147473856741167679783582700154464304149387395999823299591533614252156821163704545030191610552073908421546910491713549036562880111398537128445862046141124810515792741353127179137010875815001591325211733160",cs);
	for (int p = 2; p < n+1; p++, ++pe) // Print all prime numbers
	{
		cout << (pe * prime[p]).str() << " ";
	}
	cout << "\n";
}

int main(void)
{
	int n = 30;
	sieveOfEratosthenes(n);

	return 0;
}
