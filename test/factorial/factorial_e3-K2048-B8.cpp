#include <iostream>
#include "../../src/e3extensions/secureint.h"

using namespace std;

#define MAX_NUM 10
//#define NUM 5

string libgDir = "./libg.so";
string gFunctionName = "libg";

int main()
{
	Cryptosystem cs("13289224416729578366577858454748555737217437608887082509731706491670819143194228044392253523499891662256856114385031850463471889196349662679768259209816002270041354760699838621832019060211432063900357546803583339493827636015146709126721948567846199849445604839127547450847080550604178448686462784113479756445109441092755059322571784414812661524920464723746880401383141853252795740823613892689528499901488096745622376914788735796594828333057355615077556619709233460153153854727722024220478317641591832108209469811835248253467419662793317697201712847967080799118423770324014098407860414217552647632031076061223781730417",8,"96578646374039964975224967000425094031311185554664602567980757002320556401275033487160004525989234686458724436769631294316476299917538505057000537984661689634659494723901364146090532933997888810985381835658358776799343971855265397090030980168625908402130304034350006903900434319585775329274119125350608705830071056277736724198695756484368065925787354105324133543476435428742848055056257270242992723592210834980660246135581847042195506032751933784016039406386081183481525016670307798325700814819447919647959552205194093874563839754638801219937358152912466872299787193268507357860779781623730899587593088985818705494551552558111530884113425751772996548429331050401848145751877331279234805385434953384878899810754116165173074550220012076145976384729793520975769524526245219908501889247423132713277026030916403813657977599262961662530745498015691814821408190274870620387639808925260939165251386130737709418668725194032747858787421530130243502552797223248429343380003736796962775665040016933217919334762703387395453588631057493224325749973701800683093404351362224012938446908617214728434557017414812075464343804416447756629138347482820469529665767849939892842167840684053516173854537179797149770831827426267586199337162706441078652680085",{"1433171615077980732657566871818817714083463942537252760042666703354500019382599948417893855443646438134144227921219729615467839021501973974565940334865890766770138071126452046564946839279719964525934357139966386992977295367274370423462589606871185930652858432288705465038188383084088994369647641505169540840810222428096430423227690142931292334803841879971323260591809534427471495952138621962431711419702538721032981860277676344817647090790410146888244162946665010017374618255130689659444000137429384960049213485620909084702118760877090410146179077166018270320742353212504519452855063029328463448686271652207622094567290183314146596152057070160565492369781218749035436380457510956751075867929451814523888492391680183517131681387155360840324159039511831713277803023229346302186895200824776567679126166457547890369925819912531068029659926400002058024074346464599239900764239349500984015552439892830894971686370190225077318879307481254558033026577126194140992858657578258721645721585640127803065811478940301961114821284830341497335292040665522680128986235567016416343508447084386670270253920228441291158034693833553334534322387954949712550555217674919825071688082791507671101344605943607404383391386480894514313883423774408074839890166","105189663040065629046024979255866027046883785462395507029184227183888030130011323884277111999200833693643108212155961716820868913295160712260081815940740407870390666767987711061768680806668318773156089203175509299874457927889793678197933565537663485927044147344862934858531904881535618510122114034060943849672251101797688122752270251932764924720433722506993857168044795666190692071723253468913612169935978260156489519679790361028357815996260679839577841548168392427916305088296179166137491463464089131632502949350420626154902485970209277905128295323212042642313794596905780293819023039178696108613933900353254503217789246450515932028313321549358950510940076835040367064983417171046767847939044155020781872332126253199986754649377699878054168772694290401923129867262922361646349904612118337935485546209142147779080982153623264372536209986226467263357983289012067826594703603062813228335335510404328747065064602027343657957858450353539092877709862555486717678336252054485462384044282665855427652743827088698149327680999983499260249262794443906225909076691511685453160264177689667777300958089407373898347878305163783560099424357292717762461674446879020062218729200668700555526486426108973838355626468714918444300866616442626931379287496","149044719512534930572607849401149539590151068301237201687841221425162268203878951841516610756258623317754635856567423318586301617050659440363363929720136610105263120701050474167578939564597737141982952356627874213571967933169942908796341407730130963740182521972938717884566442181153093623257282010323288571587950631539290600882696880177250978414627280748776748557425324298768835397215325265051666210364012780944212288999340639800946214922637736435534033113579191488180257554161363427397676744570101764700556721553299061186937599497755728147608889800468347480327514658044932595866402808416760998206012092506066733334211417615602577178222164273647375284930983344761766762050074827896461747403914453601063592600811905563206897525020585955628766624023664457282360968302903904703304710988096849260142319298605521426844097149345120879839449482406225385054057652079117846616251788070689666089688030236839233208579402413481224191493525549196336345481382310154176208945564553012161720802352819636597196298733611386855137765925468627723732311086485693143609745251507887390098075606295573736704848713374738979897508287689326437355348723708189224760016796955858926533598619753060618251016787666045533849298030159620210195184321539895140127616134","45316903081070149418638818622867456579078634480621850221977464880440163085199013131417493662958845844126338465078543233218746371312418519903791694335910785059933516253174873820373921031937213124722343171051307828490933902603727987699188534841808940375311354519887371854689143381031406755235417531179657421119145735454662347522638216109540992784400112259731192938674559385587456701800748299699726198526015608191849293157655419264429739289717302077830717841543581288792084841411353548531366387260862303893180730235166484098204392026805295769156918876580280811430228892381163716113631414642806634766237929490011614453786167721333577959495514684126819238608513244309951415460714135458986046210400696851657732443993619163148668981852357354353872920654000947366733264606257627075551595280773464693068419344851194978893988871720744271541533347326461907294361597362783389884818823061606759061304256823216291541213131664260563451655104360518621565949759843217362838007215323341953886292595224742935383641927763304015687455332865307033438113630531383021427134921971294640124796674052143341949699553294423131802852166972605456411537724017330285479262625274380036836227859745059323870096940601059695122498168870597163372778849341221541505104714","115887225045308115403797296372580680251933537521293706916275331844137567532379578872227211697292184571726015373480127340275272690778560030201435964179855170871850817089550538096757177040824300342040681097380674908369922593602523711377448682534929914219380125657263737605277806709205567213123634913672987925759895559042566705102991326325920782713536689009371882816321593826060621501438737520445323816120188954986497802926678099157395036462154575603264687836832652215472173444069959598236671690759117558119855060393443660878027654047187568396103594268454767960768051031406259956491773102452244980970601707007879709823183247098306015045390065680687354691973205706452824751731143891426144640417809531505221025092467586058704825594908818839060618064614340562764931352130431396315762482462877865991370715802140729140704231289307983642941929665597168960782980606045240143282981576684278914111025071890726628787353890194280456451934865372251408425511585674281680511687279295413971746568543722784336031197183190092158525314101755103407044210634660871778923407850594555333759586309852973462633456920773124308638563384694750517640762729275376131951573179663803807879237285241555202417827737931270890766453371503074634344136803327437407625579463","100320101005027413042870143873890718864432836714456269569968924019099979608339882662054543856973041821637183418384831871067558083117080942192102333912971218566458792447542121163837295648430835584799868505279681291890090964059261999243201925649134874707689473701212775942937269631536379519085241427424493878863841624393011232711225687675073427112178031070240595337326975206460854999526753010278553817822501630673444145646309407301775284221358635555487401055304689997049709780245512336666810932452253892508946640931540423381459723418643048403917899429112155139761347597925125469181775409496602412842856165193455355883551494208847592688003714581582508778276235546138383344288884725851369620089253538685576104516162995613548889709363804694741547038299903561120487935207717697398171191380907280198313667420937776642958531580351914445125070782038297638769668109167086553859015080537505915801349974626736040303186047155568349111705776858551507203058941331190460386102583535802729023733112124591423081580065172525091994255695199343504320312568588466793186283833783356959210289275449060623517510036063693016252008071983474632756311877440234910051963829725137272146500774568860108715291107847847137881177763345449708371414364651444183073984484","30953883647289380836291747070964724604257722804269840556322498898043957511474675737470730085486252060168450857225439346186928764086454419932033787611155630573851439733039327639213420825589367632142093969228990337380416889807068055981484836714890017253075668851775160733657512177516927877363363412841515390061175135118161191716727357711868456814534776734550890671847845117405172529798645334151011700049316365813997810723962230541073306174256179864978167120481551986876249166783815201049462519972083226805454078122538644507089620453304803825018496330330009143244700966898983763719995360249096774912225223970042569750302659499582869614215012239878126486282931277615517548033661009025505100068448920569098580790248262547394302771378221679419587928939759182002227946730706932965126666206623800515401120978145454709096642637301780049915727768337862137543321968469647445660691581425935254720792147708019803709807171002260242775681870428287731943692371122470967105690247490095363081306923538055929378497274686931014029282402121645115054981482953953950289630665923662132969149542897557524288737498611912890560628694829681342697146469395047373998460379030821445818398384755302811636785696451064645500766623435562846284033582400309002002144039","30422405765978321507836006794564600328959317028667124848938872777841335721546094110781653466801515290041377562407551073230694808718992988370485978793877968802141666180995949709619301232446525146622952558107932672828355291818520439374726524368859997035758549115120353313160828147387009034546102623518345600081626700003891584071631961251901206798695704811109748708172354514143720864010138753737032747651212187260379713286736844419153975407662507449978593833077300596168591686030834921587649207122398480915134634609801834120897749282500425554074717336796239009626861124687166125806899474488969113312890185189825095639400926596763887265744151654997194970932923825743401329261484377289773182069716501224724426634292277108548879075274927617506718485431546577746665481610521696292038564100682628851390634545837199351859301651672868671792817583769791245649633663474637148575891820755379536630182615464856670244243149429234300861097921211439629696019475306581572267416814561518673112319792997007698703511231930403293072000779418424421382071841609322406178923596243449525418699135835357707824391520346210016464170832754996323208625364457946100168582068175419374388870583514021459108257990235723045182582531154633753917281437683261356892224073","127140443160306986108398380778987599127145576096069218326289493041861583076516624360612595169532268238594935885869563630404286810502930534777321967749481069833423983772263035320786103561325352533356780026044000070689088124949469810603329230170117157107056686630253863173350703587565138407603773403121344830844268397377683748420676401239043224995169012436738520116994632587158536155521638291450471648469434192777772962614956907543811229467606405817081197459680546871940125383939911269403477040400026005534413135160093037250640095910158423891518749760133538199015124369093820644725620841243818598859205542577439761102118785166355983515692634863913387411763016196348207587315658412651909107752300019143066761121142843044244874281147970594222269346200207228641914832510044976214613931523766477278571324051511765064957668952526014635939064673138897274793501914550326267932294284308910929012871725990903547590655472590352970986413314907263229421077151236317204175818046671395844055831277545322946654060767239207383367632205681634705975578932527883959509333038015797449543762103275044217278702277631298875539918988106843709589568537355345643341873407205802433868397648879323286202528871785981023508504685194779291948175832677927909740017017"},"62477404693507102875617979837457388147618396204782443860963609620674374370449289180065205816490212422698703899023476821640591640976423532884142421906394580423390565585710543366264242413763492780564465046397010733004491886908232683125404007711380603993987505077100425159777537983579416366933256962190841442864106258664775793429557852861492535296989568243288098878281605436604569782443387846853248539502894492828991524223960413908556361367460599917065793074042727751749059954786112267105738067804798971703196765887064056783374103287127245662725603874157622387564536976520257109697713697726600245735945270708643652246184052738964367177906122266825555712349287238163447941305312887275473541474904677992038263205730320171013225514788543625224820843986258778624979484153091741627084946021661633284145974969338255004866643747609983060192437288237335427388479722321451103964125161171063187235044030773847684987711976459196517517694596928288178015989752602283126886376839906463814572446378316304857527384156666528406706996611730482905818470734769403918872189116061383918390255521990259144929141336598605137459415133269847331145876454623418076698133138546378872065717770944910648987200078790887498095450226973078791397529863520205258912977987","89520911821480727641975325658077648552902565517308529233623710476653643119944140824263592070960651627976172179884934428753427578101048895655946751968468393061846332271094427261857242919365823430597126705861472967103719586301353333896556975216916813681171904409950939227088673403467706806781367618807170402471440886688679278622741563104716172937217983518109289253839929596726073931558546658100962498314097000897912599517703558093673673430045095932732987801411152844461518720332802716731791302689665481654779444649795373908219850870323326447002696654996036369635491886530267263712459797512970708264503018593431250739630202041904662930965762860125022745702757307968405396760721881220580851889051263802236386255843574626836659411327028667356011864377010042520395957708029355943921692153101399542861626575675237658472605892101058953569128917029458186680499118565805139421824781248332907092431593164588578542385488676384874391301916556392398505514288260350021635864117527198639509592381881882206566165123513545482428213715945653957906560729957033528023942129852429325918724473933731147378053335908524763575562000080900088012666834841220727927481306755906181418118165154474960600351111289829332147671397155637762563156450753959143642536096", libgDir, gFunctionName);

	SecureInt num("49668488621732795450668378459538731750346373050294262263530701089908256644477202819096747722272555155145357129900670228299596740435036724873081855088251287859975258063790226378871923442561330377566684141619194999170246878056638358811780624724652021359488554345962417559736631100001858089798702389696619308749497057876530745078243437365820049618086571433661629457093608393782808847040577237893967229593575975033436240190453374106113266405903270465888339520516747322208994210147549241749965082917620746342965770890033194954150025191536076910880778604793024716653655160636980979359992281452818482854915269228904931675460643249995496501799090067195634520826332687111727590988285055721958693896789178907849073351001773431979442447262930564024868503663544348489205969928895766423211430645783748010922441868372520300803442754313822116198309032943446226468985218115165220415474020903237363166462252797947095991571315743658245987567894967183696086411506044782335126289586761133077297164082130547099430684692429573670154540340839810622591720088498905865531207708955300184234474152561075475587024965201431695595310639192268434969548329427909339306846516186221702519911691187809132470793718083518689437334852612972442812700946154180644578867129",cs);
	SecureInt fact("39209717128217720981825736918034434252694861208366834971671546837553322966530321386080052440699784410914819119534635989998463703314737683830392986027626322727799799077940129589304874804052262360915988054941740797922660713910641852096525198117338015131468712853066585923710047236283982671155865444389101849064182315189108504820446277589539670383583265124228071161765670022173393385755407222541558246947171572003367182876765560820016246853772301225090874251815711223097847632127903877475156256169318923354510800052858858477175398675267135612884862426041302614828037181880902853729386038310133098035075014507542696446188035254942758785824839053859954639159649831114100047623274360271240112996514547047564590782101133329242490851780007634300240928193753428413164342610440654298192955681875923346663867542931250681799985854568254754593832533490037949983548540289163495441149615907223949905208868569389041778224308902883807878153135297517912547873457869027052979518880044719701538145765512108063474061849912410328743417822566761491057316290736339788736924032224238636469590900036288638563072332560213731080702803888235012095565891053053513610652945465640853681028419826770635771291577821774748787452945551684990526218405487529643760287437",cs);
	SecureInt i("97496373556883839070702584880338139702566821322042240652604945872735355546926293519242315512790331948561569567655680186804775048706959945542998381886880121156686997149044640126530327702812087384805617842696448621021062302170412903047415211267916538474394540495139928598707698601257559269744864395911128339702705511254584341323552769852010697274840451948610404474021822364942811293638600231844722802048394599089367954033617814586932404670453784998886611170557287615333732350489003715567714167957860783841924067871279353208585217491575015859398675867501106526195037277196130950088721248774216088520131587919915099083874290132008407444650521962186567683196456089275037689308616528279210456484082228077932240079660111783899448617444440828563839181673344448689295116071676023132477701626443252646698080827355342339657915357001244548302043153986391437355097643902332886348956254662962845716598336290518269917832642412170245404824396849484453246881116572778871469734653898104149901061447533176771840956649065156888635197789928558079666702653129158244325340289156422257712051570772928558271788450848782251603189894734236988663841328184353467121099278548222629162277709217122753836161570167173262163027826659273837453599540009517334876342332",cs);
	SecureInt result("76397666151689290214321398027081132902688687538886796500300151077038770701867091437614464843694365099975122602600421295796566819712909119440954724600939346436156798748840800237276179281408480870380286335981900268492979520634116858670906647307349211474538497224943658765649119554538589304539988744221534950674979368040687964145546192987433933226421693274085841739755497940832484227116661667777570648834510015714802160036281130256176297907713749555126580818555044026333325574348270170898020493218241308083620637107779098607413445622468052110479273031024437750655862696038081665086229572724659861010738878304799101870082851394431346613697435099947457621355705072160678279746349213023624190745744693901889487916577949574524293983465315726785368755972700464199851188689889825647304948518130793208295994138352699952582691497384651269176854382004353418471207992319818315379827442861212284430614950304920007964495013518199506942863801517138568542851606266873959519265858481981181309579163476429600073598938381104564990842563750053447677407384903196809747804560094161432401508265190628344814272840950637305379767685059995016951637279279256460875708321261172372716694288230166330447599770540054627582687350729675391544748914220190866406768296",cs);
	
	int counter = 1;

	do {
		//cout << counter << "...\n";
		fact *= i;
		result += (i == num) * fact;
		++i;
	} while (++counter != MAX_NUM);

	cout << "fact( " << num.str() << " ) = " << result.str() << "\n";

	return 0;
}

