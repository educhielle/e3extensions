#include <iostream>
#include "../../src/e3extensions/secureint.h"

using namespace std;

#define MAX_NUM 10
//#define NUM 5

string libgDir = "./libg.so";
string gFunctionName = "libg";

int main()
{
	Cryptosystem cs("72850363320335151273639640662189476361313713156536952109674379528226462326937",16,"543333796615483737523060372363449514784035741353285806583808072006089421741195593416992819941765670229011564921237096450685737874367141140410955361868445",{"1802966906767214115647810626974612622343379854047108814153087476880739354456196099676276749757932611171370725022932891813548511174038614828032945416464237","4625608087912304568674168084274152444260721194310370545163848502856327890553356830495947745722991502092388664662753890673368074370154840359903539992000999","2677025063716005538493568347887733852481515284585134310806578901655509942095888442813992282433658935241948149407590882435772519828381594760680938109681592","5118967893948601638079322854075779150305510755869916785677173228768657664783221664715260092523947993971103780353052956603716661768121017092994626503274880","5175047767106916575083417795511799090911564373914876790667829512362913843771926527494250087818994617374664414742414992248584605747905947035565041908007186","508017726069595210427391874325288967604868688549743863940567169765467928912790606632974717559362613863169697755262800268772868401725436224642358973667435","2093083106724009440334067126189217839088793616508636875247331911553676792047979873621118889714325515512832608091380597242688668735722904476921071926879895","2708749723217711711875106921135415623596329956746434238872137459038184468715130774119685176593550985042269437789076664232957791683735383563400083553690838","3674873448009166992360607156859640408049276747097401997395458482754612210744016695416690137195740315261088425449494438923503138485243202353735628933055339","1194619614510045206038795075917428458441769091738628611525852385319921867535358978179813878857610461221887427066003433760071424361922064308915643944562921","528813757891046229220317574704015270845556652540382904644648028527019805033823956145244645772807416859209286219428125955830491516327196146521832315030052","1140233661027599896671295017481815507952056555027634429701767014640680822698462178598975004591497944811500050986527083058778189619423698639872955590118872","746856534006312996366321919121760269892608471585454607167903449883322924162803261358090942066647753518964242732079874876567740100884920331271480413919649","291110455651047166678651309329504316605649184987471338957506522911281433844016347237969882708725676946280246414450198988572266830422973886686215030850243","1454005946152837635798075160247596140843419818521475735698429841269326494415776059471171257122336619094344807100260986354474096559591059746535252169804251","2274809418093868399706359008481183649760583032063706294594930278461766541456419433906672882500618765836667248864426567735895628860032296031781166194463044","2596643817260509010468873372923892982199339797047380892926294156385902402082627453063829600973196812909785050196974053219160805656217144323845204503905520"},"303306439554773797859762713744579447428229029370452467922102079880367411080021554570131553822913245106797796501459639332665519455898131925602465315291789","1580893212773231470858050178770631863194290518047234705757097257337725528096416550483143596791342473328742070576660247383810277242425216691008704081785421", libgDir, gFunctionName);

	SecureInt num("2121560737604615197177645319540041122437678678625033672839635775750953886005815773607750252451359920562083202628924350547577572327671668726960111309231375",cs);
	SecureInt fact("3084138310143686381751092447009683771363226004631011047638638469801029114985901604319154679093998588308454803292854192936411487149853385176655713734023402",cs);
	SecureInt i("1114204503218136765437913745570603784200875554220078508320610974442667269374128543214323676120881400786921187062438440835709029992787346075704645673038984",cs);
	SecureInt result("4810603605239163670870649638774310122550928757663847357871223612816955509615280419263090838497464359910768118732455679013370818476261504151194571256085335",cs);
	
	int counter = 1;

	do {
		//cout << counter << "...\n";
		fact *= i;
		result += (i == num) * fact;
		++i;
	} while (++counter != MAX_NUM);

	cout << "fact( " << num.str() << " ) = " << result.str() << "\n";

	return 0;
}

