#include <iostream>
#include "../../src/e3extensions/secureint.h"

using namespace std;

#define MAX_NUM 10
//#define NUM 5

string libgDir = "./libg.so";
string gFunctionName = "libg";

int main()
{
	Cryptosystem cs("104222458545192909901437965426021469750622324147551836512047348956255841096805145736294764770868963926448033783979407159808830618482102812869343608165148786390826863867990479170813502051478651719116055277377177103006147393120296072248738631642922324690699833726681802786601555635954694553828205861412296816917",16,"418803039992614917047057161830845053448504092421440236578128334303385654996938817097336240396457964130470567680267210469138974980057441117231526354963083877000152174638497718772492406771520551756072023887802538066490761645557956099009564716892424030665267619680806826332874485566995871571389893654208739530979846193502325643585074933730167015236226775778326148655386181209554141936068010395754202799209294394015522469279055119166739640065844900110906593297837032163119698107116829399338863348122711268685151386115371666803976459604944517184824948096164404425203984612266846588067163460452699666849919171517722534161",{"6058961363248451961931007475841799570976266707771438007837925642623502662406128141459587207350475187077122429375808076327188619377353471129468705847032165284760089559544000488747488949594793982767726865313135273728060069620690391628956958265733168627746745180235638021428798620161569898863335290661578522501960218753303408512033710772278362644953409760664711604279490383022537109786177736106741548508775353968211512981323751558082461450572530707206596047023879456312988214192450440578410999536353489301629076601379526155338077706990047214553944399905854592927214670405612150646304631291422498774395638192140720483704","9257692235129441303945435687746565262786736928672269474197940466727633698728181515567286965538412181641242399698963124750290581594779210359244397664644968398255165778746671055950392847570923428440902762424626856660048184569784976732049647254411758127643388141051704467697705951455103422019750596066812072388517760024059414473517747265835456158148873691043074947176302058922963162244561989709935687500290807797663003046195282435139153921365987959884209034487175187313800685114235359007374882764177843795809202702803471938683194438671197235735532462509600569036557040185983556228678372408591182185022607892244381763028","7987411708254246616368144278188720611128809441850512690667303614639887555187489980009715231995576283142384045668450042235103076445420259830372759524271368724357613393041730906454841653857088718932471649357471631855366166977874825826148399441473474935817882920363596449529723415821081066369108115205128265596960613752113964061583852068100491948668257565619340223486717168162019098519765402964545621711990169198933369402433239496431997518436474789284590418460189276960183151093560567103253438664764083760059182802959264001588029531675864776643410671349878193217062516799794147248014721050863292546828260887315635626704","9920250679748918409059085553023684427354012149391492455416771815609460235399838391480826977507813352782627863892802930474647199557115220756455603766060464715378505392749126294466360205144705390898785324450113310939742773820253814913701915427600763181771658457548266877077861600380107814713276236513455255326028835672729985398880653919381117521079788227609003185990764593034703949029571875450692461972274008621716148196350591216354235115980974820704939802264646226490828885277240358234200461647108825897871027692398226883332183068177711258432454836976239124035450111106511740307208531602641678718292214851778428636372","2051913518010742237998462374076552893775497294555003715348996325220784348504414467407339823647857563978305534579852882493878039183854609426602013035143067331656544713626155075697868010679467708850963994489648068302307859006254140173420791853122859198442300764999875145159414778273070290692156078633017021275485660684926221406241808452910335543675619286780671217749739607687548289681855752315495443384834049043570085682088282728324816992371067176633562049766968284477022447080460849488070225920000634479991249843026971426054116444292174098511723609321429284503033846991104516776653459295209800936233499124428636880249","6056203443928654298956221723958099340098449489814712933649759560890201072097959806071712116637222274251768649540631176904134289864882244329534070348461906803016189598082659035171657749508640920027708722196402663325156241109670944651344395328908402306222249374454284400141685539256917406080760785472390056735923043319569483341451006382998365994215812558276088587943483154839015142776917082793172188749511884682068265102212671674671727284354961460440283316317761808881720698368671043277204652916485187566161240727855637581973920088124908554851899119757975544333255620059146985423424140115624963114696806462528824061629","2851287362473904764491435659808794525832677060593203757714341636535136366891477083541434829326094848296115623296069452556738871408691072617259163623559618683627990976831437934503480396947581877931256858747951424019150581687158531810310948080184377541258982673958314247151385926015494329789605973515264514320435381330313875524325948382353172175835916708588626853596361956426679113305494252332595281825671646829480964128418560596810660592493390392034042712173235523297367046210740484851472951046277963211023946490740099909352392462262240376057981927300186126469371785946680937695298400626797184283029611379454251055372","6404328781556293999331884415302311950257848831839125759476874012188373237456279232707186096876382960502953363929599333670803321817718863736781285281278371119542856428154907600590089685057906666099606930684026101236649621571086673304889046325011632933956862491807740039171620962620527107267377779152590123831868695984651580063891490296951785393047185399301420798930475351003055871013998469559929066935694003035959031468644146099404523695138092961976178897575499961362526441908246424117650612194202458353600291364654938858777392681812287692660222994301589580768403877366731061850595659056417911431296818218473727481958","10521518503980364364865240031628058561295376196242881361926591800793198063226640749129086805251027114228163805552308055084086048004259678515554447920127960110122591811015603522132079873645905028189507723973862501102596645890150573110628311283977163879716678910911324593032416794561764229601145990372812881166906004127409440114783373626989687532178479141919563225845351787575336805367940724042817902332387083399632076797763368346415787588085894250325110070515838617164086550349349959892882014535461672257986379450399647034234225991643315232807722059766461551998972508846338570772884199771979739048441208051725501888139","5892739247634518830312085574428842443442948125152980851186491812597391202016594395913575315838772120324709866909952912328417207895904057965660631602308285758224559866349842503761625129098502684406675528228129874486782479369544510010350081921804090548248795772508237214156324744972454022878748397238396017791791331812517139687827803277808991255672835685960717102895662841675014668850669710436995910041736444146524299733093906300526664240470975179454593970123185651079078939430358198611717362577515963663115138119179648996913892537724752390653934211063298135008773210713861236976748274464064519072154651901033862612488","9678392531327438728322813294089774003366851660859019120157236217404590909716087144846066010575550016236089582696320305407929628364993255788865415190002527395176315386326536228547807604808702575389611689599324078352675197276439560114095818964066334550247540642578527725015377038077187503808338325369637045707801245789758466332998580323139350388351241243977863097614330329525963879506713056266282626705083610631228786121030390878942713689395060138984211484073131875850042475793366260312191991825874556422865095926250002731341512377886128166174667662155908209309865446573186641532184297661461797336445564338702598605500","3638103684977007084240809197929881265440771523311338424238221132035284565328360433086455071279643371328475824451079396671542942574199941326440596029002573927995524380191006631368277280603112319982744545034062259296003856678260530774028819163137392395709984201952974595395380775688728161712527354283857083059547635915148812510633856312038314129404907485879140084557758401619155455103562484475716488258260042353834862659191976973847669127917643793175938820193302549571915904535185476825378252235719170897167023431212706653478254736495298396631621867215740015132489791879321255058888112891435005520284346232791012216368","3064036286892913954216846171671315083768092192969281374828111633809448008721413940068911304969409784844310780550126494231420744311033406146582307521385968428593437310797163302904927826255996484259660951282487818907521440541991581489059812347024487519452653505593831821546838187615429683572036825097789811800870423754993108983583149774157104043753072561156134732950694268698045334494340377695217197838903087043767555503594571611560068131360740733189230532804427553478595909202668261498238931353465801746491651532712926431675384307555845692640248457426424136244767461098497779093782309283261864906143903174469929933023","4691748910528425721218406085353743111220418603509808283720224178442415169399414019798020699775741451783014559788408098606924499226919326035401935811846074115810736347705739519670062510131358842470394115976658692501079621134671701910361377479936288114148157732149212236024630131275505394574446767181896024222605131497125288360073355701217935572018041303769244688290752158026239441860016195622966197118152530223508057297108783218664082563299506142846511511551964079263367342953035809279366433931684316381904168160630012088745340495294121635501005514875800865268775375883678088531419096297577757098465278419571483913452","5722222896086854298243134694673360778560740424336382038214619599479001421060674645200042255742706400489792195980284275522757875720251280270138679726071306723243113387990467422020655126174304425134347777359104127904020076034301209290559872324097898529358630833247770879586853280142259588925208014535713167055548402674949760563842819445501210668331508312382322775128736274964650113062891594962334804480188243112831676955405483765674667010711223845737920371525480173300094389296646147114007999526822952136920375925530127012437621236715515731329015983372965612256434183470699048714417390994272149372296039134751720524193","7745936286635547106776030232883171050117941505134759455185201080005867519630357666022986652669883968080052674457038728279025339254863086343565538306659205019880046231522510596465209849732873057175079064392657241507100437826595034311115214658014927835533432676674555340630492399612488670079474535936406427265513240205700765230136924589928243087611520371082545421703987687095286072493478486326777714452665513924627610161293100572665266903427998752270508924039766071220157062565859542234581973227850777899611337396897546197092570744748363554413750837482544886742617039102125708014296834002490470393341367650440890272629","2488415503761989782826072821910289467223354590497946927842453095417000299900231047300002555244171074029963012494724812875515821400775319719627196237214837645964570345237694914329002040990269803137362663766385638319945802119084370415955750537186708565743749465358278048521478135305902279991100474953630952285481921499098482211112532642597716015813690548745106156452321472481294623421544947384893919330799785785101632274435361345392863107133624047663235402824251179979885059031233900014270418080656074813248574522997322509800530857753832780169864170784485068982036788270447654191902567278795147869773552118756697203374"},"10814658511456511243007968679328171194984939580247394317411947761398440358643822101953742747485304925771621533785417963935867139276023447767065906641096711796130237994607944615638986844919195225158150709479140464203169187258911354083415768312151918625626059575995154075244539909154530633374041498623039571644697873427720345706059479922401565421867117831139621965481030592437679638782627851132981978407375845161945778480503663901756364628396142930358642822551296318368231720361703512039555921969820602628438030364205209549639481992801171247003939472170664382718160688497775495527793597665564249052277992055061970266043","7732766415021924339885055572017903809822368389287393819832658127231409743274061041941406889917933537010524270809389672752425383630497939121314183416874933517499289318227557971009834720118496917805981596961894267103222586959059922276580508238145245223140312440874300004930458893043862146328299184035779337130468751564771509291897988010941640282113243785733975668550402719514720008183085193249155586405514111107373367591409174734204616294455745239697954996218736012002014502051170359324611189175575388627859371510280846087508466717456602450789575747247043912827884612321224019502987075038938298570625300123697202174814", libgDir, gFunctionName);

	SecureInt num("8468746053715436972755938760927535079145889097084839592975570843541847895315993210611736380835547129110731356964133356627249972529020517742562137277599070773927800291298952787274717535695771690080087815656646307187012712235411051667435846792161734720059833597878740300371859436971267804588340577485880954492699757501636034548166713000647547606298153165642525483825169243458972039360241724985774049279618191470589753060643631344155153023916780561676601465354368044250186088389688672773592463110763754035788987205292241273534836265293231815912260433587018417752311680601003933141027584922026039355271980127467556088774",cs);
	SecureInt fact("10571077721904260923037248490103914343701624262053208044004127927668748026809055880342695727746835798739792461845736235710919182030351303476538586341251415842143912228141870580272362089166779195868784135472728991990682583022142012624209287228066832421920987189256721494357060263644329186989481929082355367258065107051448599011867630312633118597406157466833097718423996080151268819792038374378743629533174253102909920994139320922045704131188039546044258804159913214260254982866054437000944223298062383974864271326038869398329735748914417074115612791262018333097549374469512861048358581710213616323315552378355953054941",cs);
	SecureInt i("9295987784071886033873568772441548043128956448489166568707597725255839179571044273168297323862646306030050851095675840452495126711511863132211554483526709547355429223926780180954693790776879844373799222170498682475336816894978426179590633202519237415358378363653023791377002318961825222439779236280640375104397880751623199701541989024066634772452135254744010326114020766759756619969810273645653265361361009336110595732353556124570549656259623765861874953170704161376879102105648743445742480534977253958363294058954709637655911205156804155388728595472918890733404460714521620740430680563522334004528003667915482187776",cs);
	SecureInt result("280952114254663709198759897377395891226274993065106010113023945802222202692568425165663558205780380492190723236132968550033873548283168673137506603592639708472722371291863186590169766734697134386732085119679122650079959299889629483501066747846012654894290097017303000329165127190256292631031220893268299212487158755617407741933158773246445498822407173620327652810405678587969926730268506525965656799425121945517455953937316500545532972303657132334671976819184477676734225230437596807713521288877560994751021851290379459353519212855260898421520225930709980511087960287549442377140214039797280626196936969260259663475",cs);
	
	int counter = 1;

	do {
		//cout << counter << "...\n";
		fact *= i;
		result += (i == num) * fact;
		++i;
	} while (++counter != MAX_NUM);

	cout << "fact( " << num.str() << " ) = " << result.str() << "\n";

	return 0;
}

