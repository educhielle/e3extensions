#include <iostream>
#include "../../src/e3extensions/secureint.h"

using namespace std;

string libgDir = "./libg.so";
string gFunctionName = "libg";

int main()
{
	Cryptosystem cs("13534490579960316037",16,"175023689548609678558239103845688719074",{"125403701546372222234650432936915234470","12145575838151463963140375925873004880","99872083436793626241050878757225173411","153470914897443112813068578382368540134","114409172400296521367635508795640788684","84189722950662035077199010621360751073","83254834020356739314872878170355098733","170514965231004205890362319165894061304","25992176490821729836003786041848747709","135407641550575453420452861425826388873","42071647960704418018788054183624352990","47354934108222157298983668824093317953","135803436522151263688804782965067101877","146147837401131454078539657066402753395","58348550234023765150567498344619246146","2074589102277708960147125211072173651","106109660159317082720480686137324929737"},"56345199431638683605476203997048760067","9131313164228966720666286934081881419", libgDir, gFunctionName);
	SecureInt a[3][3], b[3][3], c[3][3];

	a[0][0] = SecureInt("85289671641039991298038625300163125412",cs);
	a[0][1] = SecureInt("4080094445502291583649075556534443775",cs);
	a[0][2] = SecureInt("120928810983320560778417866469340763564",cs);
	a[1][0] = SecureInt("130158094683540860829351338010610577983",cs);
	a[1][1] = SecureInt("146279022496801678103651087494353311222",cs);
	a[1][2] = SecureInt("127534783355267136702892189089106027158",cs);
	a[2][0] = SecureInt("151366991160451865761234209493820428579",cs);
	a[2][1] = SecureInt("57723307226807901091856950639250488098",cs);
	a[2][2] = SecureInt("101187742305647314100182895882319185176",cs);

	b[0][0] = SecureInt("168891828514005821427305230928681684562",cs);
	b[0][1] = SecureInt("90544358451437463837007422049875314843",cs);
	b[0][2] = SecureInt("166665591115349792562225893464008898168",cs);
	b[1][0] = SecureInt("137490208239480540493090631523869208694",cs);
	b[1][1] = SecureInt("47510383214618372064840675650887793757",cs);
	b[1][2] = SecureInt("132464184103916204798017982346243828533",cs);
	b[2][0] = SecureInt("136720122895697854278744390807290771987",cs);
	b[2][1] = SecureInt("126037572658441303773946250582096420323",cs);
	b[2][2] = SecureInt("84576443018455987767445783708096548168",cs);

	for (int i = 0; i < 3; i++)
	{
		for (int j = 0; j < 3; j++)
		{
			c[i][j] = SecureInt("108841118504961453750395499834065072435",cs);
			for (int k = 0; k < 3; k++) c[i][j] += a[i][k] * b[k][j];
		}
	}

	for (int i = 0; i < 3; i++)
	{
		for (int j = 0; j < 3; j++) cout << c[i][j].str() << " ";
		cout << "\n";
	}

	return 0;
}

