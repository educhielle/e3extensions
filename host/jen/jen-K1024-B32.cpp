#include <iostream>
#include "../../src/e3extensions/secureint.h"

using namespace std;

string libgDir = "./libg.so";
string gFunctionName = "libg";

SecureInt *pE0, *pE3, *pE6, *pE10, *pE11, *pE15;

SecureInt jenkins_one_at_a_time_hash(const SecureInt* key, size_t length)
{
	size_t i = 0;
	SecureInt hash = *pE0;
	while (i != length)
	{
		cout << ' '<< i<< std::flush;
		hash += key[i++];
		hash += hash << *pE10;
		hash ^= hash >> *pE6;
	}
	cout << std::endl;
	hash += hash << *pE3;
	hash ^= hash >> *pE11;
	hash += hash << *pE15;
	return hash;
}

int main(void)
{
	Cryptosystem cs("88249194500947855642825609638990957539552355715517056401826186721881966404706436358520715568015807145602032799069015348584436389419830150342660470912395034347356291154264335407860558545482966249948033112804065844325934033935680633360657651747606215155578320918449638755860716269730490939336391080478832679253",32,{"6244161823282329080126620349518919804923519522115791191899739143837092470887795498874813900948996775626176198846338785109695457862431473003074436428764303831259869687849410247573839541705294883137923235412288010829888753594003002989433403388662775725025672849979612434713541270241737718585147230750348396656042792185323175967054534465063681593665038878196653632456207403959607808674317506173082970056282699586324809248875460237374886489747463447287431400657486144589973811348452740167194334969150992268334174003108053474653830549661455233204056028750006450445250984415031179372498508216903998639503882912865704549372","4548072358383976482548332299345954723735699997110785133776145411531539530485299222056926446836380423219494803366897103565126831112825614783163265829758423844181287411832690414422927689636803759748295518727789712392211550650572577870484178384662722485841745181640971230384119683510119002999235174004016842331371245735310042846866645587494151309911133567589702642028665548025743762387754901979356494039142506232078502950605770719898047843250480321590988401597541308340190885288540604604811526194676096409910682027598586961891180593519692462576452792985112257547245831937444908868562555268571211793978195281685925992156","2296390347555579764252883755426900136476508949931565706905661820303573107912099680218139706836821797486162497375895077004734453531281697434603147519207047149170170018877196488676154365936595408757622746992512066658777171650865032338351770659705269427140256976870008382841958105045786953381039556763538486541191229005190999965040132753160887156282307321315970424507060770025431409268303721961754892605764882000996776583560737125560141753631874107127185258161956401620574179537650007231947848709845228329109796270865652418372597734759879747884723375261417115341654162752866296835823987049208753673052864663355062004766","7689424389550351615720303231054941609280405013425713804548676501853345877220865687507779515915766099109622292688326370978713295096043167381457504310535467170106793985102280443410010124415277341288907881945613551555804744966164052217439589885269749390942972403911581922436092032487557005200686976352006293856550547122986986454491790368020822550385254709298576427825208276125120901267935691343807650071778214856619690562974320701721226938753517356189265675784237190807290890955266926014927805204233766701063535445814601315998361784545725163530195724678316573134691935570672236717834692950935101566153763083924555467246","666901418056364532883359416301603232728062987848703108152399633622182245095323975479479260057601978843771151992265885733348831571304927900637045634624667656926696983587319450204304699184573024289170758910127878114909675400609946779475475869228647865955998739093118054026142894959518445604426471678476785067034901055926638150738187400389743556722165375477142011352913167810429903030796120198552984565140113452346816864570093125301247075204651891066354682906166813909308145962012356579084232395991789667854861921327149751226558859714699152578050061598543124611028503066966706372505149437019207938992855119213247728805","3107850079575201775214632205133426047676200671076213224505547089339656015999793480806875844606694995415491376714239360907475112253088867591653566978756733145137276655182453100153580799858635952480390797034608779580864211762609137435459399829713231416136987530221693246371692828841093550339969422076135311558192764625250101250770733029863007870761401072391293175444586194331418381606206141299794138666059695150510659500317940643592280746119328798379531991957325302378056801224807682559432770384872928836180364592560546628442029766719262110482768309421055496664076416769149002989195918872733496247538033357778700280823","1653885197472545256178019425946582548569042390542738577839695790701252404753449819749863096142776788523761232712379855371102323978581785919629327011998192737631870138154540896084590707675997202620003897364640462120775078187806203051127405686060394109078682813417043874437826876850027137040186887049565017763042795155100276040623761103708884165457877778181950565419871799265370602373746203071859903354215265611325869614934454198650894266826700759467642613429985491813331546438246846532571289789806774617788527258897819183355989761817576874194804961792024699370052495688998427386609227826555076703001785589931466825266","2543789870929512942817769875427212840096039356134140112939922847754284283177036129083628739286676528461651886588664311754812417767832602164465656236516010165106605308250764223455524573059719412254023551441478913420659481551277839592050636520359955851345932055995829905732847211214913032540412489386181610723149708215224284715024650321838052881209414967916464443564064913232337088328311924684109389522247039166874240125939859870076944496235842924600359696801378814529153177379032885259181575206100761271849242336687834144598203190238300982878460365708658941519082678894314385646943842574833637270758803726448607743834","3237788431283650793706413152897964238032171698066414124408782530476074649325702253257644710838541371772298904161533525151152683155657461780977261877190354897774454826171486357407433446745020646608753907861687135378921747836570748862294455382673889020742190034161955981709177547825514702539315416660723546238476577466067627873479325202421068902139587633068231759070152465974059086485574202296865325866351333332143060466809782928700479354392088976513561666349590333889679292269633292120237075029714065064444164571406123849672709638934054616504707528026581999185465854377099077265414688118772016118048366090999957157288","2686687957312405403381275930318500265724131552084727238672041636970758516044207325537187040106632265777615820590327545890112713209996821476944896518793325308758914094638178172743024909808920519906026941628041874951678688631242256076705021022735617776492917768666768269614131447110115260029003822369410302818398175175868724144574430990538830211765610225266655980411459102707952920582015197046123959316550264540679663532497650838266461446873591774235427088236527121260011030193029717276282038059974888501056920842314114891619056912119417750163717658752986829678481802202175335093644079329235462282733939965559673767284","5531784715575783117269368148128026356673554730912972805127607503970800223516918524492520817934582997440712804160615379984775477644702512845631770825753356388024276587200211662176528070344933973951354725318507755076475707889907612259524558211475025462502154391386101341345830245161071636840273031783257659151597979391737171655618935488960717848250412943458184191937007512720281400160836908690386070661612220847681122269525102825501686894660806340069514184917567675911194275965061197449800112969571401856806397351183592729607739389036680303566307496158089490775036697179852368801932264298831729443782236132206505068900","3767222556425558592173760401325250518664030839352131734914212793321503358948782758853750122730461870220094958444826935041149029785627513267060286920945867477384270710891380572010127825439936422986659641108809382752452444785252077267160177272346600595274464737125665097714905814818377274640389646608086233022395472316611001837483035670249792440556048591296301679542012141315169596138815156148352686503226666279226353430168045903713652254580797358526924638563256970281221551420129449264057918871953220766384405291950378742070206066676622798328125724062918410379435498801579456091680235458378342585517795937762748016361","7599221380849654389080106084621072990388908403160410939560111965767955749205955702765966780564882746832958482205855939195690069370217061331898454202808540546121659083845359972892617275776468794365973566069923125340925455359389622409933081421613836796549024609123520836847637658761758137089352626175950252359176064093470240127019805254873830420425430015009190669886376903200564534585325831646305385162129843650715579953841326009072386565630065436758660675839582551323285264328086748899089718698710630738116317251952093013818423472111836411521640662065039097014201120241504121380144382247459887852848938447880864928994","5430951899353734312447549825707919204386321970577096275844559859887139343420200123274364076184498055291886565854932632293274173271415624123431006903347681950009003692514481819025238074572059280403964666997267784115192624354732360191805983341915545551040145800187988120952749448236659241032651127214471844958282465752639054012540194794964707939607786735434774125752956748597439046451939861477411451686827813439222887533530813724057804860457843727703916519888438915730138120843711481568472536857765261722554183612636978286915356288680926866269028418235032433566578071760386831274441394084207590871085990587121127710570","2748674149749153744866456979516730939864826518446985251034008089277014397682611193857099127380525502678444880223415300928697178454893556003162087085966986165216735527517546435033545174630521431104899748537571724759425511040121073504458142922603265303816387788830071156491860777940757472638090682438352439527265805763842533174806838636147918897959035014352324936546091994474911785949142419005787138422092749694259608099895694722571412626489338812085577880701647240813689753643274755339213287198670936652754021651567353241384240039987961946413382248659040392345924205893641071562220603473321168243493289511379945851906","831683405013521945957271301298876603593399002271092296029332218928956378269354805139985455853240686659888650138195185082234695477389280383353175425656814733440376386879935299147806671249874225992882578667061785780412095726043626157314749633572806240050767089870643870385558982778859846013706136039608964676605177084503048123181292883049661445775871577097522866370381822704881161019419165597256815066357359126638655446245901031324800612629517655662005652205462090770229365845277626357399332037419436738912787271952488283352156965883379651664033727355123710392407685978264827542441110745435928304698715484304480612600","7195519568046807545277260172501114227691544197997114354315495973958950510201064021205832700742903830914086715561797985175500735767608864941880148865576780078032841141489892962593059455911055990229414370891818199699385319324066708764344506786776867467428470993326555629902491677150864659937209513158322115478261777521581943016943083693188060752102331410547591689118182576122147515183010406050051108204906192467987297711481695038636423414895521746104365036756074741653624278369632540231600688341359747576880042278521855350154978567220318634270324236225987825458213934280832006488691441416294023913767882806018262208538","5544926363879662438369112627064379358325457401896196371808726533641802476044303977676070966995794997713911814809520181043361649841743692752178722944653397949918469149198569948070146437581820484480339412771804665645259652640253333223082582617058203635054512169565933807519057735667473108855518471471316309278620697936452714578149752145719089014463482576013000734757491763004619076858370310958953002647912631545652879572110053060837199727259994851772997471098094371413682422001464477495329869051175144935705295344726402798058473222999135524322747122553586695084153470042786713172885156608549927221122196526854719023676","1284407777183245913560741054664939424400091825056436902723551781130433638584058143369116516105643394969667710329433711491236562720603478394982704630934923332018362399656807764475085958595712437323801479206947038522778601123089156515632402504305225927292336724491910747799301481698763044200670655687471715807059549518846531849794125675024510525287379803636113564798405086377958081256826084295429953955745149960063201595216161103735369958591977461813619182806838297593940376123485072515366109432348571230943408343137908635557895140614236174766871885943907982995289798211803604911245631754390745800472246198619839162297","1186972537314368691153551093100628105716215929493029218481925279974944268384405001524098798794084649936622434829362361243753621506469933415555838557541518135522720266265543420508224865676959149617198436942081599712861979607598850350656831278307919261267348935242256215709219761616601259616062442064664241870550064627782100429402335772343317419722065445198880314802293407722690474693257410872992357268518345587912317909326693682003655099332136069984169587360088990192573445858599657406395941356007104919764858392617929159243342572215668597861158168709783539271203070699478498676492150339666032801375395410986570743090","4399973522596634225171739088156694857868441367817839000048355014539755600677238407267921544645697124937543425796815878637210642065170832747520010508622328219014657369891811693041810038432915262652113395031325102375980877937809763451987718390509062717075143987210399618269290526839579923715714800242839521902000608703004123947259733163944070098534949829529107025917436033319937455465263813625393960131826887909174307582010022183373292670604742448482035546984628099703609823858004438440615575951186002959730340027502629252839404026404247026567619653650589746844883139805411530819023556262577049890251002458502357130749","1001707056727834622771854636066789291411048072735197472787880478314772437649476195271014440809676212899166520074604456213525486956353703917524307255294544088735613207860633339047178323570243551488872532240663157091136844349750806257560337465205190701133414162543943675028850050197079824466820314641339477024008418650265051693144986230698564376545457071857194863231630538329639118801620058316872119630513746044596916483100247958379665814730546305041252518502748463988241802746741622729444743163338794323023342641374436850646043922154656233399836001622387726876818056035589238177818280333419184171539592423236056087837","2885151955568000270658883942786880441362884388895959796908906895513464106490403118889461167454194463603175967035237761412417381994242261086350212037665386784026777416468815162886991713365891767741796968542309719768143823451044989899900209073903425689705849312006942670007734702716117930372219062223862611902719167206522632615076796497873825665177684062447266584110403253997681757873421221207689502576942500920654209464106548309715545087335619532370971368807400287248497016780242949053330968813765585615559732939523133675102724247711957002791489446915510118296559997509967319269001036719576848760498047505649261488312","3592291164282636482549955841637833247687880311306645522389060641108086392628378671392532059603376350903342745351329466530911057736291834650119326117070249856653970823698894428516124078072214545977347632129092545570955457279082938814112683292860397646296099414786950182394751667704957475351695121152388437286276605244299775152552738409060014446921739761189352646690207335017611234808241620633804076403953880560525636336675780851942118342350312728944055989968159897276469779141239862018901627150905994898999586663169072420572148405757449298083449885806241482151271943078119322251413336430682997934531775053724702669933","1551149268771287386559826674463367473379152709742006792202168562044610495556407548139076064307533308164735266573017947110904963777626826090415696294004845504094779841162057365989096285387414474844343524936492053421563375866782856132030536622326110734214378865031922624658569960224874934014610432849439147959703410133053210841693902989775939422064897709602328124529763867041984661174485250026372955287898195714993589704856962852836523665218440032075781677359792346385866062401756238457973871709135520882662083788077584311469249640991969265759267744643521808460787487217775460194306555756227824550115721607192194437453","6565041949544915469858170607052561362576271350822995134088146381750127114495635540805655101599007258134335185097232410666090309984023669251918578410808335680995670596160128623336995663514707734390676572303432439248877506240841070888913715965415428868909698774981890546771100058908550239968178365911733384132530042575031145719318651006166026731020223824976045864665187449710824933877390411392937593450068925130364259591186783639139064673983632341777187178075137207432402561688850715843339004771593408377984582175127623630044243794736279329339875589179246253699796562331898922349867691084847357549311325986865719000339","2575685035423542359513031806981086336753068198446721299329176342559989723672092523647034885813888670850994888317338934049647369461681427452168591294943606167368278034859131370156438459546668607462876941169756015477745047882685781379621954090766510501805217970020766453283392453169631964954807187961842628172244121002021641356974097276373226052844139719273494233247490443828566841767681515076752578108661919989353060336010669898126722809337560855084851070339701629073892382865869826285526734138769470874800005625793044242507896416981929286014978830143166358824519070540241329942010029814742529343932137121806432501782","1445659921871238278899962786617298699974885994619542294172177446268386248935290927327983001944005598044721560697841375178399518877868649218159178438115901590199560002105745205995000765846975395962079457834950475960358862350254342340601726968286156205887916830528020038155832461024992961896761185907984581552626308914895302972897475699749263724956946092464951972967132796681447153534204887091749687974029246051841621487869217227760866742788052015120105233037952040607511379730456433337273177360091367045065441471737324405639134715950101299637888165999536484550085292763631943434845244809239311157000148827174778786446","6984526194705333710723732782497362445655901921743387451755741342175216998154274363142144775619691514935975648862611987693328646564720110623785084892642939634202995619739108736398036618350195814615283897132524324526444023043132374496070098844555986676806561805078397700090738009641385587781083191591241812031593564702634990572326683720861569090492976035383940128181251382921500653532095878876031789233153988380511115474200248310046532003072783475959978866363763655172301111052242791547609429515994404401081989461242070791463658592915437948004417924947217963931448922393687032956255138694653279803593012556540418574079","7373961595109061289446822560734745724244329943225639057666547721091025385625788555293807006449347903485471575935478133258596804352452343307325306200076872325354647787505895875242241811150918601232533010893067852741444541797974610865753299995561438918454883140232872308176964788997178202937154656942816209245721157410021293525166074533963568929637899760597576539362709972340337003792724700926606959718096092489375636377238215212039981827273966218972395406579750412548468798462178918659303229177797246656470329371522302861475381602957444150892080300233599951262127002397949191317529525703753641207626732966388185939285","4325220955231160523376876810272768990945936880183339999899127520383766324813577381504934214346422149442293621387483938707372565777374285427765588186192370231348664244141886169383822101257248717861016199867280768455659210880171445718389619600780376647236944493318265442865580756355199945161815492836960290142944531505657167316262573852629824653562032108261399399158146121800938618100331498292526507419946853060246925969407552899664005437753170523100425201398128328189136470108804557613439270919498786380088853126197156536797302976310589148731617908282183641735845684686496256580921490535534949648972496892398543778337","7503202713805476435867323214313578468974772109426154970141508746815412436390169230671244337410482233545346304068377634954769674787763427040694864848088905504093165153762875623567367757261237906464550867155369524960241223162434946982491094697788696077312404990051533756723554108893998105963509150560504121097962451578466408116556805626430935276824956920651810122446631098551296283255724001298852361892372781021912884002219902199297858160787546616584358506022368830487335921822238766072408814576895521919773016141494196387376617596896548363572532469211218540703486296203691670892896121087206239950331223856481020380928","7074784801462428900463714173180223251971208997025615224633987327401217016833224357545957138514089589300053491083596345882908048025737186010588659179697532430090383964692506850505822820627889214585228410667896065616747554341705179379615693304404118535131415909597136068358991171436095829347602801928958544600088538433256644159371689235667669179024810189883883687075176379789001132785050622205319241292056650142345515128353656777413671958978615186807792716691109601235245553089661620090275693506707359588913645994287244012933711313743463006881285120838988876090032010049671537905269314662358769322956906842422071568137"}, libgDir, gFunctionName);
	SecureInt E0=SecureInt("4037070169469744250623236909603600833264373603064146095738530955679377067991234081133780801277727787482170081538949936920476192709019301938979101165613306015551306658556447796278047449506350500746854703937021640736512785950894383220335567682883415800645192882087176717982672778776262361023649052500807130345256186323557293207469913511436330464842678514951195418647622021709195082264440817905201680083140263590669151324463540636116327152437068892859132989164330336064134781697941603808055141104554476026970971338345725220692350000578228353354206980109106314567453252715879053419823853629314385479713496418997674733074",cs), E3=SecureInt("7465534900961718033972244713905272231502015386505647822646521561690969494259295571476886121086272791060809837429237891601117933832870424027870625148886430892563621820621225947559752209005930486982131495315035023317142314174909816849081333232606247689414545110393465559792627460821351859400166711861385319423899280872775794892607823121000373275415575124764000781574801184649111993955770601651759811438385220087103569335606556941486731204848381851217311287682272726163712792718434742201277027303894958325782091526077058744742789407431073631894534596406019441739101898205006396457941936931685048816462730683645931331193",cs), E6=SecureInt("7559011791443078246717812184837221333041754449558441126774062774050461383012168049187132675727468967042604252622477882475384042457690545598850974843790810794683546428350982440062256810533919597301286578375620883611562287575284075441275502064389003353761807465514212068792484761111001216829291701009471104365903608352382261393320353108977045561304059195661061885537592248697229418663230700832988738607244524659047905310081162396133063060462448734337568022562084612828570076345784686698245221292811385621327263885242658908560286298624097033771290899628563200095335540541894302780968789594729965853766563670865786913776",cs), E10=SecureInt("332174287615603279408534176796216653461984109811969608099496099396052075546722383672792359745864524671857101163972207001911746570980110412236599997066719395157416693761686136563660597983096325021405107655303122144406442218392790798805164616654882211482657820939156616386454477262897152937600939337966175331787607867467422097265066812729883726071850072218533315018316989236383820426088609635608573073209047231209984235944675630102178491875656369320318333557901006625891328472819488796339584166518567247373728379565892628423572399320503586317061292839391010926705130083130022031265693354413131676634117203821602841844",cs), E11=SecureInt("1288087385354441533788210292959117420912004138867857999417893117669849526365813577069056142205702783597172885452083150902024620217077695229224335356813736176052814049108810771341940000119583187827731204049122265738426236348799263625154221938109794929382567221473584252263346612601790647022351377662554839905848977639534159948384411028103872505088297808875357460676981330770567604215533259886390507005646271353495118803515028362101586744978933648531953599463352064207443512892557055644968028038705281897961563327178045024079715287212065512946134942486601169128498060896457754312397705616443879421116434595922085466544",cs), E15=SecureInt("1250079183224818165752983440665316865789880069816890326112801427678357907352681168326178491839401054308851110726480013223140273753721648377635589476145676225567603742372100276284643404213877238492190671819510430209813695753543036992635680471675712727149384223947831368677531238690338182717066423241767193218089062372707273613881933589032048368227267973549091841527540542542063911247542816375622146271911300239685811395564798945310200443524137940084532059752428898409980832667018415165890071414051753651341282874951362150075501649588335271192646479806001604665901691790496430186840937352357661830376088300209765701208",cs);
	pE0=&E0; pE3=&E3; pE6=&E6; pE10=&E10; pE11=&E11; pE15=&E15;

	size_t length = 2;
	SecureInt array[length];
    array[0] = SecureInt("6864766214354178573557692769270408038028367196921980747000079176040236447165435582073962790692711771092633089303185970837667231089486240208667614236494459410115149509589414434301560717845268453555911614096543488621311127322876439170861813056204828745014073097758142780731391866815025243034261324148622670255316947310486711801090713370510941982877742397573363278468826891563071980012479927234797858149007165644113503385104870229570451320742809135461428256830180790367759559340289085231615206537535235613125736133951187632445531493509583910651663000966045675114474787285785039812027842785855899085295466333164515882818",cs);
    array[1] = SecureInt("2939581136236368706332754143081724814215349004516994814288239099485515841495350370680971254065410098844455315404381355406630041702098886402973565366864669140621457741532385424768537845730047652338294560777502361209846144425571367192037785625778131520455478605533680699849557266445720815205873831318865892596224880750892609452397550326593129588805503424972918421707731082162072009531876884550592908903888489720128228749552900311003158333589070216996496523362964274245073018537760458106230683730298081139094185974172601170306605632010027768435320335787869784757176111439418878526119413932176130367299841342699665654314",cs);

	SecureInt res = jenkins_one_at_a_time_hash(array, length);

	cout << "hash : " << res.str() << '\n';
	return 0;
}
